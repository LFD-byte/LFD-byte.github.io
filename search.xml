<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å›¾ç¥ç»ç½‘ç»œå­¦ä¹ æ—¥è®°ï¼ˆå…­ï¼‰å›¾ç¥ç»ç½‘ç»œï¼ˆGNNï¼‰çš„å®ç°</title>
      <link href="/2023/06/20/tu-shen-jing-wang-luo-xue-xi-ri-ji-liu-tu-shen-jing-wang-luo-gnn-de-shi-xian/"/>
      <url>/2023/06/20/tu-shen-jing-wang-luo-xue-xi-ri-ji-liu-tu-shen-jing-wang-luo-gnn-de-shi-xian/</url>
      
        <content type="html"><![CDATA[<h2 id="æŸå¤±å‡½æ•°"><a href="#æŸå¤±å‡½æ•°" class="headerlink" title="æŸå¤±å‡½æ•°"></a>æŸå¤±å‡½æ•°</h2><p><strong>ç”¨äºèŠ‚ç‚¹åˆ†ç±»çš„ GNN</strong></p><p>ä»¥å®Œå…¨ç›‘ç£æ–¹å¼è®­ç»ƒ GNNï¼Œä½¿ç”¨ softmax åˆ†ç±»å‡½æ•°å’Œè´Ÿå¯¹æ•°ä¼¼ç„¶æŸå¤±æ¥å®šä¹‰æŸå¤±å‡½æ•°ï¼Œå¦‚ä¸‹å¼ï¼š</p><p>$$<br>\mathcal{L} = \sum_{u \in \mathcal{V}_{train}} = -log(softmax(z_u,y_u))<br>$$</p><p>å…¶ä¸­ï¼Œå‡è®¾ $y_u \in \mathbb{Z}^c$ æ˜¯ä¸€ä¸ªç‹¬çƒ­å‘é‡ï¼Œè¡¨ç¤ºç”¨äºè®­ç»ƒçš„èŠ‚ç‚¹ $u \in \mathcal{V}_{train}$ çš„ç±»ã€‚</p><p>åœ¨å¼•ç”¨ç½‘ç»œä¸­ï¼Œ$y_u$ è¡¨ç¤ºè®ºæ–‡çš„ä¸»é¢˜ï¼Œ$Softmax(z_u,y_u)$ è¡¨ç¤ºé€šè¿‡ softmax å‡½æ•°è®¡ç®—èŠ‚ç‚¹å±äºç±» $y_u$ çš„æ¦‚ç‡ï¼Œå¦‚ä¸‹å¼ï¼š</p><p>$$<br>softmax(z_u,y_u) = \sum_{i=1}^c y_u[i]\frac{e^{z_u^Tw_i}}{\sum_{j=1}^c e^{z_u^Tw_j}}<br>$$</p><p>å…¶ä¸­ï¼Œ$w_i \in \mathbb{R}^d,i=1,\cdots,c$ æ˜¯å¯è®­ç»ƒçš„å‚æ•°ã€‚</p><p><strong>ç”¨äºå›¾åˆ†ç±»çš„ GNN</strong></p><p>å›¾åˆ†ç±»çš„æŸå¤±å‡½æ•°å€¼æ˜¯é€šè¿‡ä¸€ç»„æœ‰æ ‡è®°çš„è®­ç»ƒå›¾ $\mathcal{T} = {\mathcal{G}_1,\cdots,\mathcal{G}<em>n}$ ä¸Šå­¦ä¹ çš„å›¾åµŒå…¥ $z</em>{\mathcal{G}_i}$ è®¡ç®—ï¼Œé€šå¸¸ä½¿ç”¨å¦‚ä¸‹å¼å®šä¹‰çš„å¹³æ–¹è¯¯å·®æŸå¤±å‡½æ•°ï¼š</p><p>$$<br>\mathcal{L} = \sum_{\mathcal{G} \in \mathcal{T}}| MLP(z_{\mathcal{G}<em>i}) - y</em>{\mathcal{G}_i} |_2^2<br>$$</p><p>å…¶ä¸­ï¼ŒMLP æ˜¯å…·æœ‰å•ä¸€å˜é‡è¾“å‡ºçš„å¯†é›†è¿æ¥çš„ç¥ç»ç½‘ç»œï¼Œ$y_{\mathcal{G}_i} \in \mathbb{R}$ æ˜¯è®­ç»ƒå›¾ $\mathcal{G}_i$ çš„æ ‡ç­¾å€¼ã€‚</p><p><strong>ç”¨äºå…³ç³»é¢„æµ‹çš„ GNN</strong></p><p>æ·±åº¦å›¾ä¿¡æ¯æœ€å¤§åŒ–ï¼ˆDGIï¼‰èŠ‚ç‚¹åµŒå…¥ $z_u$ å’Œå›¾åµŒå…¥ $z_{\mathcal{G}}$ ä¹‹é—´çš„äº’ä¿¡æ¯ï¼ŒæŸå¤±å‡½æ•°å¦‚ä¸‹å¼ï¼š</p><p>$$<br>\mathcal{L} = -\sum_{u \in \mathcal{V}<em>{train}} \mathbb{E}</em>{\mathcal{G}} log(D(z_u,z_{\mathcal{G}})) + \gamma\mathbb{E}log(1-D(\tilde{z}<em>u,z</em>{\mathcal{G}}))<br>$$</p><p>å…¶ä¸­ï¼Œ$z_u$ è¡¨ç¤º GNN æ ¹æ®å›¾ $\mathcal{G}$ ç”Ÿæˆçš„èŠ‚ç‚¹ $u$ çš„åµŒå…¥ï¼Œè€Œ $\tilde{z}<em>u$ è¡¨ç¤ºæ ¹æ® $\mathcal{G}$ çš„æŸåç‰ˆæœ¬ $\tilde{\mathcal{G}}$ ç”Ÿæˆçš„èŠ‚ç‚¹ $u$ çš„åµŒå…¥ã€‚è¿™é‡Œç”¨ $D$ è¡¨ç¤ºåˆ¤åˆ«å‡½æ•°ï¼Œå®ƒæ˜¯ä¸€ä¸ªè¢«è®­ç»ƒç”¨ä»¥é¢„æµ‹èŠ‚ç‚¹åµŒå…¥æ˜¯åŸºäºçœŸå®çš„å›¾ $\mathcal{G}$ è¿˜æ˜¯æŸåç‰ˆæœ¬çš„å›¾ $\tilde{\mathcal{G}}$ ç”Ÿæˆçš„ã€‚åœ¨é€šå¸¸æƒ…å†µä¸‹ï¼Œé€šè¿‡ä¸€ç§éšæœºçš„æ–¹å¼ï¼ˆå¦‚æ‰“ä¹±ç‰¹å¾çŸ©é˜µä¸­çš„å…ƒç´ ï¼‰ä¿®æ”¹èŠ‚ç‚¹ç‰¹å¾æˆ–é‚»æ¥çŸ©é˜µï¼ŒæŠ‘æˆ–æ˜¯åŒæ—¶ä¿®æ”¹ä¸¤è€…æ¥ç ´åå›¾ã€‚ä¸Šè¿°æŸå¤±å‡½æ•°èƒŒåçš„æ€æƒ³æ˜¯ï¼šGNN æ¨¡å‹å¿…é¡»å­¦ä¼šç”Ÿæˆå¯ä»¥åŒºåˆ†çœŸæ˜¯å›¾å’Œå…¶æŸåç‰ˆæœ¬çš„èŠ‚ç‚¹åµŒå…¥ã€‚è¿™ä¸€ä¼˜åŒ–ç›®æ ‡ä¸æœ€å¤§åŒ–èŠ‚ç‚¹åµŒå…¥ $z_u$ å’Œå›¾åµŒå…¥ $z</em>{\mathcal{G}}$ ä¹‹é—´çš„äº’ä¿¡æ¯å¯†åˆ‡ç›¸å…³ã€‚</p><h2 id="èŠ‚ç‚¹é‡‡æ ·"><a href="#èŠ‚ç‚¹é‡‡æ ·" class="headerlink" title="èŠ‚ç‚¹é‡‡æ ·"></a>èŠ‚ç‚¹é‡‡æ ·</h2><p>åŸºäºèŠ‚ç‚¹çº§åˆ«æ¶ˆæ¯ä¼ é€’çš„è§’åº¦ç›´æ¥å®ç° GNN å¯èƒ½å­˜åœ¨è®¡ç®—æ•ˆç‡ä½çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå½“å¤šä¸ªèŠ‚ç‚¹å…±äº«é‚»åŸŸæ—¶ï¼Œå¦‚æœå›¾ä¸­æ‰€æœ‰èŠ‚ç‚¹ç‹¬ç«‹æ‰§è¡Œæ¶ˆæ¯ä¼ é€’æ“ä½œï¼Œæœ€ç»ˆå¯èƒ½ä¼šæ‰§è¡Œå¤§é‡å†—ä½™è®¡ç®—ã€‚</p><p><strong>å›¾çº§åˆ«çš„å®ç°æ–¹æ³•</strong></p><p><strong>å­é‡‡æ ·å’Œå°æ‰¹é‡</strong></p><p>ä¸ºäº†é™åˆ¶ GNN çš„å†…å­˜å ç”¨å¹¶ä¿ƒè¿›å°æ‰¹é‡è®­ç»ƒæ–¹å¼ï¼Œå¯ä»¥åœ¨æ¶ˆæ¯ä¼ é€’è¿‡ç¨‹ä¸­ä½¿ç”¨èŠ‚ç‚¹é›†çš„å­é›†ã€‚ä»æ•°å­¦è§’åº¦ï¼Œå¯ä»¥è®¤ä¸ºè¿™æ˜¯åœ¨æ¯ä¸ªæ‰¹æ¬¡ä¸­ä¸ºå›¾ä¸­èŠ‚ç‚¹çš„å­é›†è¿è¡ŒèŠ‚ç‚¹çº§çš„ GNN å…¬å¼ã€‚</p><p>æŒ‘æˆ˜åœ¨äºä¸èƒ½åœ¨ä¸ä¸¢å¤±ä¿¡æ¯çš„æƒ…å†µä¸‹ç®€å•åœ°åœ¨å›¾ä¸Šçš„ä¸€éƒ¨åˆ†èŠ‚ç‚¹ä¸­æ‰§è¡Œæ¶ˆæ¯ä¼ é€’æ“ä½œï¼Œæ¯æ¬¡åˆ é™¤èŠ‚ç‚¹æ—¶ä¹Ÿä¼šåˆ é™¤å…¶å…³è”çš„è¾¹ï¼Œè¿™æ— æ³•ä¿è¯é€‰æ‹©çš„èŠ‚ç‚¹çš„éšæœºå­é›†ä¼šæ„æˆè¿æ¥å›¾ï¼Œå¹¶ä¸”ä¸ºæ¯ä¸ªå°æ‰¹æ¬¡é€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹çš„éšæœºè‡ªå·±ä¼šå¯¹æ¨¡å‹æ€§èƒ½äº§ç”Ÿä¸¥é‡çš„ä¸åˆ©å½±å“ã€‚</p><p>é€šè¿‡å¯¹èŠ‚ç‚¹é‚»åŸŸè¿›è¡Œå­é‡‡æ ·çš„ç­–ç•¥æ¥å…‹æœæ­¤é—®é¢˜ï¼šé¦–å…ˆä¸ºæ¯ä¸ªæ‰¹æ¬¡é€‰æ‹©ä¸€ç»„ç›®æ ‡èŠ‚ç‚¹ï¼Œç„¶åé€’å½’é‡‡æ ·è¿™äº›èŠ‚ç‚¹çš„é‚»åŸŸä»¥ç¡®ä¿èƒ½å¤Ÿä¿æŒå›¾çš„è¿é€šæ€§ã€‚ä¸ºäº†å°½å¯èƒ½é¿å…ä¸ºä¸€ä¸ªæ‰¹æ¬¡é‡‡æ ·è¿‡å¤šèŠ‚ç‚¹çš„æƒ…å†µï¼Œå»ºè®®ä½¿ç”¨å›ºå®šå®¹é‡å¯¹æ¯ä¸ªèŠ‚ç‚¹çš„é‚»åŸŸè¿›è¡Œå­é‡‡æ ·ä»¥æé«˜æ‰¹é‡å¼ é‡æ“ä½œçš„æ•ˆç‡ã€‚</p><h2 id="å‚æ•°å…±äº«å’Œæ­£åˆ™åŒ–"><a href="#å‚æ•°å…±äº«å’Œæ­£åˆ™åŒ–" class="headerlink" title="å‚æ•°å…±äº«å’Œæ­£åˆ™åŒ–"></a>å‚æ•°å…±äº«å’Œæ­£åˆ™åŒ–</h2><p><strong>å±‚é—´å‚æ•°å…±äº«</strong></p><p>åœ¨ GNN çš„æ‰€æœ‰èšåˆå’Œæ›´æ–°å‡½æ•°ä¸­ä½¿ç”¨ç›¸åŒçš„å‡½æ•°ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œåœ¨6å±‚ä»¥ä¸Šçš„ GNN ä¸­æœ€æœ‰æ•ˆï¼Œå¹¶ä¸”é€šå¸¸ä¸é—¨æ§æ›´æ–°å‡½æ•°ç»“åˆä½¿ç”¨ã€‚</p><p><strong>è¾¹ä¸¢å¼ƒ</strong></p><p>è®­ç»ƒè¿‡ç¨‹ä¸­éšæœºåˆ é™¤ï¼ˆæˆ–å±è”½ï¼‰é‚»æ¥çŸ©é˜µçš„è¾¹ã€‚ç›´è§‚æ¥çœ‹ï¼Œè¿™å°†ä½¿ GNN ä¸å¤ªå®¹æ˜“è¿‡æ‹Ÿåˆï¼Œå¹¶ä¸”å¯¹é‚»æ¥çŸ©é˜µä¸­çš„å™ªå£°æ›´å…·é²æ£’æ€§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å›¾ç¥ç»ç½‘ç»œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å›¾ç¥ç»ç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¦‚ç‡è®ºï¼ˆä¸€ï¼‰ è´å¶æ–¯å…¬å¼</title>
      <link href="/2023/06/16/gai-lu-lun-yi-bei-xie-si-ding-li/"/>
      <url>/2023/06/16/gai-lu-lun-yi-bei-xie-si-ding-li/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> æ¦‚ç‡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¦‚ç‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WandB å­¦ä¹ æ—¥è®°ï¼ˆä¸€ï¼‰Tutorials</title>
      <link href="/2023/06/12/wandb-xue-xi-ri-ji-yi-doc/"/>
      <url>/2023/06/12/wandb-xue-xi-ri-ji-yi-doc/</url>
      
        <content type="html"><![CDATA[<h2 id="Track-experiments"><a href="#Track-experiments" class="headerlink" title="Track experiments"></a>Track experiments</h2><p>å¿«é€Ÿå®éªŒæ˜¯æœºå™¨å­¦ä¹ çš„åŸºç¡€ã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ W&amp;B æ¥è·Ÿè¸ªå’Œå¯è§†åŒ–å®éªŒï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥å¿«é€Ÿè¿­ä»£å’Œç†è§£æˆ‘ä»¬çš„ç»“æœã€‚</p><h3 id="A-shared-dashboard-for-your-experiments"><a href="#A-shared-dashboard-for-your-experiments" class="headerlink" title="A shared dashboard for your experiments"></a>A shared dashboard for your experiments</h3><p>åªéœ€å‡ è¡Œä»£ç ï¼Œæ‚¨å°±å¯ä»¥è·å¾—ä¸°å¯Œçš„ã€äº¤äº’å¼çš„ã€å¯å…±äº«çš„ä»ªè¡¨æ¿ï¼Œæ‚¨å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°<a href="https://wandb.ai/wandb/wandb_example?_gl=1*1ycseye*_ga*MTUwMzMwNTA4NC4xNjg1MzI0NjI3*_ga_JH1SJHJQXJ*MTY4NjU0ODg1NC40LjEuMTY4NjU1MDE0OC41MC4wLjA.">è‡ªå·±çš„ dashboard </a>ã€‚</p><p><img src="https://blog-img-1304093596.cos.ap-shanghai.myqcloud.com/undefinedPell4Oo.png" alt="dashboard"></p><h3 id="Data-amp-Privacy"><a href="#Data-amp-Privacy" class="headerlink" title="Data &amp; Privacy"></a>Data &amp; Privacy</h3><p>æˆ‘ä»¬éå¸¸é‡è§†å®‰å…¨æ€§ï¼Œæˆ‘ä»¬çš„äº‘æ‰˜ç®¡ dashboard ä½¿ç”¨è¡Œä¸šæ ‡å‡†æœ€ä½³åŠ å¯†å®è·µã€‚å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨æ— æ³•ç¦»å¼€ä¼ä¸šé›†ç¾¤çš„æ•°æ®é›†ï¼Œæˆ‘ä»¬å¯ä»¥æä¾›<a href="https://docs.wandb.com/self-hosted">æœ¬åœ°å®‰è£…</a>ã€‚</p><p>ä¸‹è½½æ‰€æœ‰æ•°æ®å¹¶å°†å…¶å¯¼å‡ºåˆ°å…¶ä»–å·¥å…·ä¹Ÿå¾ˆå®¹æ˜“â€”â€”ä¾‹å¦‚åœ¨ Jupyter ç¬”è®°æœ¬ä¸­è¿›è¡Œè‡ªå®šä¹‰åˆ†æã€‚ä¸‹é¢æ˜¯å…³äºæˆ‘ä»¬ <a href="https://docs.wandb.com/library/api">API</a> çš„æ›´å¤šä¿¡æ¯ã€‚</p><h3 id="Install-wandb-library-and-login"><a href="#Install-wandb-library-and-login" class="headerlink" title="Install wandb library and login"></a>Install <code>wandb</code> library and login</h3><p>é¦–å…ˆå®‰è£…åº“å¹¶ç™»å½•åˆ°æ‚¨çš„å…è´¹å¸æˆ·ã€‚</p><pre class=" language-bash"><code class="language-bash"><span class="token operator">!</span>pip <span class="token function">install</span> wandb -qU</code></pre><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Log in to your W&amp;B account</span><span class="token keyword">import</span> wandbwandb<span class="token punctuation">.</span>login<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h3 id="Run-an-experiment"><a href="#Run-an-experiment" class="headerlink" title="Run an experiment"></a>Run an experiment</h3><p>1ï¸âƒ£. å¼€å§‹æ–°çš„è¿è¡Œå¹¶ä¼ å…¥è¶…å‚æ•°è¿›è¡Œè·Ÿè¸ª</p><p>2ï¸âƒ£. è®­ç»ƒæˆ–è¯„ä¼°çš„æ—¥å¿—æŒ‡æ ‡</p><p>3ï¸âƒ£. åœ¨ dashboard ä¸­å¯è§†åŒ–ç»“æœ</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> random<span class="token comment" spellcheck="true"># Launch 5 simulated experiments</span>total_runs <span class="token operator">=</span> <span class="token number">5</span><span class="token keyword">for</span> run <span class="token keyword">in</span> range<span class="token punctuation">(</span>total_runs<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># ğŸ 1ï¸âƒ£ Start a new run to track this script</span>  wandb<span class="token punctuation">.</span>init<span class="token punctuation">(</span>      <span class="token comment" spellcheck="true"># Set the project where this run will be logged</span>      project<span class="token operator">=</span><span class="token string">"basic-intro"</span><span class="token punctuation">,</span>       <span class="token comment" spellcheck="true"># We pass a run name (otherwise itâ€™ll be randomly assigned, like sunshine-lollypop-10)</span>      name<span class="token operator">=</span>f<span class="token string">"experiment_{run}"</span><span class="token punctuation">,</span>       <span class="token comment" spellcheck="true"># Track hyperparameters and run metadata</span>      config<span class="token operator">=</span><span class="token punctuation">{</span>      <span class="token string">"learning_rate"</span><span class="token punctuation">:</span> <span class="token number">0.02</span><span class="token punctuation">,</span>      <span class="token string">"architecture"</span><span class="token punctuation">:</span> <span class="token string">"CNN"</span><span class="token punctuation">,</span>      <span class="token string">"dataset"</span><span class="token punctuation">:</span> <span class="token string">"CIFAR-100"</span><span class="token punctuation">,</span>      <span class="token string">"epochs"</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># This simple block simulates a training loop logging metrics</span>  epochs <span class="token operator">=</span> <span class="token number">10</span>  offset <span class="token operator">=</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">5</span>  <span class="token keyword">for</span> epoch <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>      acc <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token operator">-</span>epoch <span class="token operator">-</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> epoch <span class="token operator">-</span> offset      loss <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token operator">-</span>epoch <span class="token operator">+</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> epoch <span class="token operator">+</span> offset            <span class="token comment" spellcheck="true"># ğŸ 2ï¸âƒ£ Log metrics from your script to W&amp;B</span>      wandb<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"acc"</span><span class="token punctuation">:</span> acc<span class="token punctuation">,</span> <span class="token string">"loss"</span><span class="token punctuation">:</span> loss<span class="token punctuation">}</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># Mark the run as finished</span>  wandb<span class="token punctuation">.</span>finish<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>3ï¸âƒ£ å½“æ‚¨è¿è¡Œæ­¤ä»£ç æ—¶ï¼Œæ‚¨å¯ä»¥é€šè¿‡å•å‡»ä¸Šé¢çš„ä»»ä½• ğŸ‘† wandb é“¾æ¥æ‰¾åˆ°æ‚¨çš„äº¤äº’å¼ dashboardã€‚</p><h3 id="Simple-Pytorch-Neural-Network"><a href="#Simple-Pytorch-Neural-Network" class="headerlink" title="Simple Pytorch Neural Network"></a>Simple Pytorch Neural Network</h3><p>è¿è¡Œæ­¤æ¨¡å‹ä»¥è®­ç»ƒä¸€ä¸ªç®€å•çš„ MNIST åˆ†ç±»å™¨ï¼Œç„¶åå•å‡»é¡¹ç›®é¡µé¢é“¾æ¥ä»¥å®æ—¶æŸ¥çœ‹æ‚¨çš„ç»“æœæµåˆ° W&amp;B é¡¹ç›®ã€‚</p><p>wandb ä¸­çš„ä»»ä½•è¿è¡Œéƒ½ä¼šè‡ªåŠ¨è®°å½• <a href="https://docs.wandb.ai/ref/app/pages/run-page#charts-tab">metrics</a>, <a href="https://docs.wandb.ai/ref/app/pages/run-page#system-tab">system information</a>, <a href="https://docs.wandb.ai/ref/app/pages/run-page#overview-tab">hyperparameters</a>, <a href="https://docs.wandb.ai/ref/app/pages/run-page#logs-tab">terminal output</a> ï¼Œæ‚¨å°†çœ‹åˆ°ä¸€ä¸ªåŒ…å«æ¨¡å‹è¾“å…¥å’Œè¾“å‡ºçš„äº¤äº’å¼è¡¨æ ¼ã€‚</p><h4 id="Set-up-Dataloader"><a href="#Set-up-Dataloader" class="headerlink" title="Set up Dataloader"></a>Set up Dataloader</h4><p>è¦è¿è¡Œæ­¤ç¤ºä¾‹ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£… PyTorchã€‚å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ Google Colabï¼Œåˆ™å®ƒå·²ç»é¢„è£…ã€‚</p><pre class=" language-bash"><code class="language-bash"><span class="token operator">!</span>pip <span class="token function">install</span> torch torchvision</code></pre><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> wandb<span class="token keyword">import</span> math<span class="token keyword">import</span> random<span class="token keyword">import</span> torch<span class="token punctuation">,</span> torchvision<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn<span class="token keyword">import</span> torchvision<span class="token punctuation">.</span>transforms <span class="token keyword">as</span> Tdevice <span class="token operator">=</span> <span class="token string">"cuda:0"</span> <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">"cpu"</span><span class="token keyword">def</span> <span class="token function">get_dataloader</span><span class="token punctuation">(</span>is_train<span class="token punctuation">,</span> batch_size<span class="token punctuation">,</span> slice<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token string">"Get a training dataloader"</span>    full_dataset <span class="token operator">=</span> torchvision<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>MNIST<span class="token punctuation">(</span>root<span class="token operator">=</span><span class="token string">"."</span><span class="token punctuation">,</span> train<span class="token operator">=</span>is_train<span class="token punctuation">,</span> transform<span class="token operator">=</span>T<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> download<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    sub_dataset <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>Subset<span class="token punctuation">(</span>full_dataset<span class="token punctuation">,</span> indices<span class="token operator">=</span>range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>full_dataset<span class="token punctuation">)</span><span class="token punctuation">,</span> slice<span class="token punctuation">)</span><span class="token punctuation">)</span>    loader <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>dataset<span class="token operator">=</span>sub_dataset<span class="token punctuation">,</span>                                          batch_size<span class="token operator">=</span>batch_size<span class="token punctuation">,</span>                                          shuffle<span class="token operator">=</span><span class="token boolean">True</span> <span class="token keyword">if</span> is_train <span class="token keyword">else</span> <span class="token boolean">False</span><span class="token punctuation">,</span>                                          pin_memory<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> num_workers<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> loader<span class="token keyword">def</span> <span class="token function">get_model</span><span class="token punctuation">(</span>dropout<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token string">"A simple model"</span>    model <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                         nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">28</span><span class="token operator">*</span><span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                         nn<span class="token punctuation">.</span>BatchNorm1d<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                         nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                         nn<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span>dropout<span class="token punctuation">)</span><span class="token punctuation">,</span>                         nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>    <span class="token keyword">return</span> model<span class="token keyword">def</span> <span class="token function">validate_model</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> valid_dl<span class="token punctuation">,</span> loss_func<span class="token punctuation">,</span> log_images<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> batch_idx<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token string">"Compute performance of the model on the validation dataset and log a wandb.Table"</span>    model<span class="token punctuation">.</span>eval<span class="token punctuation">(</span><span class="token punctuation">)</span>    val_loss <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">.</span>    <span class="token keyword">with</span> torch<span class="token punctuation">.</span>inference_mode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        correct <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">for</span> i<span class="token punctuation">,</span> <span class="token punctuation">(</span>images<span class="token punctuation">,</span> labels<span class="token punctuation">)</span> <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>valid_dl<span class="token punctuation">)</span><span class="token punctuation">:</span>            images<span class="token punctuation">,</span> labels <span class="token operator">=</span> images<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">,</span> labels<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># Forward pass â¡</span>            outputs <span class="token operator">=</span> model<span class="token punctuation">(</span>images<span class="token punctuation">)</span>            val_loss <span class="token operator">+=</span> loss_func<span class="token punctuation">(</span>outputs<span class="token punctuation">,</span> labels<span class="token punctuation">)</span><span class="token operator">*</span>labels<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># Compute accuracy and accumulate</span>            _<span class="token punctuation">,</span> predicted <span class="token operator">=</span> torch<span class="token punctuation">.</span>max<span class="token punctuation">(</span>outputs<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            correct <span class="token operator">+=</span> <span class="token punctuation">(</span>predicted <span class="token operator">==</span> labels<span class="token punctuation">)</span><span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># Log one batch of images to the dashboard, always same batch_idx.</span>            <span class="token keyword">if</span> i<span class="token operator">==</span>batch_idx <span class="token operator">and</span> log_images<span class="token punctuation">:</span>                log_image_table<span class="token punctuation">(</span>images<span class="token punctuation">,</span> predicted<span class="token punctuation">,</span> labels<span class="token punctuation">,</span> outputs<span class="token punctuation">.</span>softmax<span class="token punctuation">(</span>dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> val_loss <span class="token operator">/</span> len<span class="token punctuation">(</span>valid_dl<span class="token punctuation">.</span>dataset<span class="token punctuation">)</span><span class="token punctuation">,</span> correct <span class="token operator">/</span> len<span class="token punctuation">(</span>valid_dl<span class="token punctuation">.</span>dataset<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">log_image_table</span><span class="token punctuation">(</span>images<span class="token punctuation">,</span> predicted<span class="token punctuation">,</span> labels<span class="token punctuation">,</span> probs<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token string">"Log a wandb.Table with (img, pred, target, scores)"</span>    <span class="token comment" spellcheck="true"># ğŸ Create a wandb Table to log images, labels and predictions to</span>    table <span class="token operator">=</span> wandb<span class="token punctuation">.</span>Table<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"image"</span><span class="token punctuation">,</span> <span class="token string">"pred"</span><span class="token punctuation">,</span> <span class="token string">"target"</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">[</span>f<span class="token string">"score_{i}"</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> img<span class="token punctuation">,</span> pred<span class="token punctuation">,</span> targ<span class="token punctuation">,</span> prob <span class="token keyword">in</span> zip<span class="token punctuation">(</span>images<span class="token punctuation">.</span>to<span class="token punctuation">(</span><span class="token string">"cpu"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> predicted<span class="token punctuation">.</span>to<span class="token punctuation">(</span><span class="token string">"cpu"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> labels<span class="token punctuation">.</span>to<span class="token punctuation">(</span><span class="token string">"cpu"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> probs<span class="token punctuation">.</span>to<span class="token punctuation">(</span><span class="token string">"cpu"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        table<span class="token punctuation">.</span>add_data<span class="token punctuation">(</span>wandb<span class="token punctuation">.</span>Image<span class="token punctuation">(</span>img<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pred<span class="token punctuation">,</span> targ<span class="token punctuation">,</span> <span class="token operator">*</span>prob<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    wandb<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"predictions_table"</span><span class="token punctuation">:</span>table<span class="token punctuation">}</span><span class="token punctuation">,</span> commit<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></code></pre><h4 id="Train-Your-Model"><a href="#Train-Your-Model" class="headerlink" title="Train Your Model"></a>Train Your Model</h4><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Launch 5 experiments, trying different dropout rates</span><span class="token keyword">for</span> _ <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># ğŸ initialise a wandb run</span>    wandb<span class="token punctuation">.</span>init<span class="token punctuation">(</span>        project<span class="token operator">=</span><span class="token string">"pytorch-intro"</span><span class="token punctuation">,</span>        config<span class="token operator">=</span><span class="token punctuation">{</span>            <span class="token string">"epochs"</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>            <span class="token string">"batch_size"</span><span class="token punctuation">:</span> <span class="token number">128</span><span class="token punctuation">,</span>            <span class="token string">"lr"</span><span class="token punctuation">:</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span>            <span class="token string">"dropout"</span><span class="token punctuation">:</span> random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">0.80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># Copy your config </span>    config <span class="token operator">=</span> wandb<span class="token punctuation">.</span>config    <span class="token comment" spellcheck="true"># Get the data</span>    train_dl <span class="token operator">=</span> get_dataloader<span class="token punctuation">(</span>is_train<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> batch_size<span class="token operator">=</span>config<span class="token punctuation">.</span>batch_size<span class="token punctuation">)</span>    valid_dl <span class="token operator">=</span> get_dataloader<span class="token punctuation">(</span>is_train<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>config<span class="token punctuation">.</span>batch_size<span class="token punctuation">)</span>    n_steps_per_epoch <span class="token operator">=</span> math<span class="token punctuation">.</span>ceil<span class="token punctuation">(</span>len<span class="token punctuation">(</span>train_dl<span class="token punctuation">.</span>dataset<span class="token punctuation">)</span> <span class="token operator">/</span> config<span class="token punctuation">.</span>batch_size<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># A simple MLP model</span>    model <span class="token operator">=</span> get_model<span class="token punctuation">(</span>config<span class="token punctuation">.</span>dropout<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Make the loss and optimizer</span>    loss_func <span class="token operator">=</span> nn<span class="token punctuation">.</span>CrossEntropyLoss<span class="token punctuation">(</span><span class="token punctuation">)</span>    optimizer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span>config<span class="token punctuation">.</span>lr<span class="token punctuation">)</span>   <span class="token comment" spellcheck="true"># Training</span>    example_ct <span class="token operator">=</span> <span class="token number">0</span>    step_ct <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> epoch <span class="token keyword">in</span> range<span class="token punctuation">(</span>config<span class="token punctuation">.</span>epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>        model<span class="token punctuation">.</span>train<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> step<span class="token punctuation">,</span> <span class="token punctuation">(</span>images<span class="token punctuation">,</span> labels<span class="token punctuation">)</span> <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>train_dl<span class="token punctuation">)</span><span class="token punctuation">:</span>            images<span class="token punctuation">,</span> labels <span class="token operator">=</span> images<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">,</span> labels<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>            outputs <span class="token operator">=</span> model<span class="token punctuation">(</span>images<span class="token punctuation">)</span>            train_loss <span class="token operator">=</span> loss_func<span class="token punctuation">(</span>outputs<span class="token punctuation">,</span> labels<span class="token punctuation">)</span>            optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>            train_loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>            optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>                        example_ct <span class="token operator">+=</span> len<span class="token punctuation">(</span>images<span class="token punctuation">)</span>            metrics <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"train/train_loss"</span><span class="token punctuation">:</span> train_loss<span class="token punctuation">,</span>                        <span class="token string">"train/epoch"</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>step <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token punctuation">(</span>n_steps_per_epoch <span class="token operator">*</span> epoch<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> n_steps_per_epoch<span class="token punctuation">,</span>                        <span class="token string">"train/example_ct"</span><span class="token punctuation">:</span> example_ct<span class="token punctuation">}</span>                        <span class="token keyword">if</span> step <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;</span> n_steps_per_epoch<span class="token punctuation">:</span>                <span class="token comment" spellcheck="true"># ğŸ Log train metrics to wandb </span>                wandb<span class="token punctuation">.</span>log<span class="token punctuation">(</span>metrics<span class="token punctuation">)</span>                            step_ct <span class="token operator">+=</span> <span class="token number">1</span>        val_loss<span class="token punctuation">,</span> accuracy <span class="token operator">=</span> validate_model<span class="token punctuation">(</span>model<span class="token punctuation">,</span> valid_dl<span class="token punctuation">,</span> loss_func<span class="token punctuation">,</span> log_images<span class="token operator">=</span><span class="token punctuation">(</span>epoch<span class="token operator">==</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>epochs<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># ğŸ Log train and validation metrics to wandb</span>        val_metrics <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"val/val_loss"</span><span class="token punctuation">:</span> val_loss<span class="token punctuation">,</span>                        <span class="token string">"val/val_accuracy"</span><span class="token punctuation">:</span> accuracy<span class="token punctuation">}</span>        wandb<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token operator">**</span>metrics<span class="token punctuation">,</span> <span class="token operator">**</span>val_metrics<span class="token punctuation">}</span><span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token string">"Train Loss: {train_loss:.3f}, Valid Loss: {val_loss:3f}, Accuracy: {accuracy:.2f}"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># If you had a test set, this is how you could log it as a Summary metric</span>    wandb<span class="token punctuation">.</span>summary<span class="token punctuation">[</span><span class="token string">'test_accuracy'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.8</span>    <span class="token comment" spellcheck="true"># ğŸ Close your wandb run </span>    wandb<span class="token punctuation">.</span>finish<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>æ‚¨ç°åœ¨å·²ç»ä½¿ç”¨ wandb è®­ç»ƒäº†æ‚¨çš„ç¬¬ä¸€ä¸ªæ¨¡å‹ï¼ ğŸ‘† å•å‡»ä¸Šé¢çš„ wandb é“¾æ¥æŸ¥çœ‹æ‚¨çš„æŒ‡æ ‡</p><h3 id="Try-W-amp-B-Alerts"><a href="#Try-W-amp-B-Alerts" class="headerlink" title="Try W&amp;B Alerts"></a>Try W&amp;B Alerts</h3><p><strong><a href="https://docs.wandb.ai/guides/track/alert">W&amp;B Alerts</a></strong>  å…è®¸æ‚¨å°†ä» Python ä»£ç è§¦å‘çš„è­¦æŠ¥å‘é€åˆ°æ‚¨çš„ Slack æˆ–ç”µå­é‚®ä»¶ã€‚ç¬¬ä¸€æ¬¡å‘é€ Slack æˆ–ç”µå­é‚®ä»¶è­¦æŠ¥æ—¶ï¼Œéœ€è¦æ‰§è¡Œ 2 ä¸ªæ­¥éª¤ï¼Œè¿™äº›è­¦æŠ¥ç”±æ‚¨çš„ä»£ç è§¦å‘ï¼š</p><p>1) åœ¨ä½ çš„ W&amp;B <a href="https://wandb.ai/settings">User Settings</a> å¼€å¯è­¦æŠ¥</p><p>2) æ·»åŠ  <code>wandb.alert()</code> åˆ°ä½ çš„ä»£ç :</p><pre class=" language-python"><code class="language-python">wandb<span class="token punctuation">.</span>alert<span class="token punctuation">(</span>    title<span class="token operator">=</span><span class="token string">"Low accuracy"</span><span class="token punctuation">,</span>     text<span class="token operator">=</span>f<span class="token string">"Accuracy is below the acceptable threshold"</span><span class="token punctuation">)</span></code></pre><p>è¯·å‚é˜…ä¸‹é¢çš„æœ€å°ç¤ºä¾‹ä»¥äº†è§£å¦‚ä½•ä½¿ç”¨ wandb.alertï¼Œæ‚¨å¯ä»¥åœ¨æ­¤å¤„æ‰¾åˆ° <a href="https://docs.wandb.ai/guides/track/alert">W&amp;B Alerts</a>çš„å®Œæ•´æ–‡æ¡£</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Start a wandb run</span>wandb<span class="token punctuation">.</span>init<span class="token punctuation">(</span>project<span class="token operator">=</span><span class="token string">"pytorch-intro"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># Simulating a model training loop</span>acc_threshold <span class="token operator">=</span> <span class="token number">0.3</span><span class="token keyword">for</span> training_step <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># Generate a random number for accuracy</span>    accuracy <span class="token operator">=</span> round<span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token string">'Accuracy is: {accuracy}, {acc_threshold}'</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># ğŸ Log accuracy to wandb</span>    wandb<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"Accuracy"</span><span class="token punctuation">:</span> accuracy<span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># ğŸ”” If the accuracy is below the threshold, fire a W&amp;B Alert and stop the run</span>    <span class="token keyword">if</span> accuracy <span class="token operator">&lt;=</span> acc_threshold<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># ğŸ Send the wandb Alert</span>        wandb<span class="token punctuation">.</span>alert<span class="token punctuation">(</span>            title<span class="token operator">=</span><span class="token string">'Low Accuracy'</span><span class="token punctuation">,</span>            text<span class="token operator">=</span>f<span class="token string">'Accuracy {accuracy} at step {training_step} is below the acceptable theshold, {acc_threshold}'</span><span class="token punctuation">,</span>        <span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Alert triggered'</span><span class="token punctuation">)</span>        <span class="token keyword">break</span><span class="token comment" spellcheck="true"># Mark the run as finished (useful in Jupyter notebooks)</span>wandb<span class="token punctuation">.</span>finish<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="Visualize-predictions"><a href="#Visualize-predictions" class="headerlink" title="Visualize predictions"></a>Visualize predictions</h2><p>è¿™åŒ…æ‹¬å¦‚ä½•åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä½¿ç”¨ PyTorch å¯¹ MNIST æ•°æ®è¿›è¡Œè·Ÿè¸ªã€å¯è§†åŒ–å’Œæ¯”è¾ƒæ¨¡å‹é¢„æµ‹ã€‚</p><p>ä½ å°†å­¦åˆ°å¦‚ä½•ï¼š</p><ol><li>åœ¨æ¨¡å‹è®­ç»ƒæˆ–è¯„ä¼°æœŸé—´å°†æŒ‡æ ‡ã€å›¾åƒã€æ–‡æœ¬ç­‰è®°å½•åˆ° <code>wandb.Table()</code></li><li>æŸ¥çœ‹ã€æ’åºã€ç­›é€‰ã€åˆ†ç»„ã€åŠ å…¥ã€äº¤äº’å¼æŸ¥è¯¢å’Œæ¢ç´¢è¿™äº›è¡¨</li><li>æ¯”è¾ƒæ¨¡å‹é¢„æµ‹æˆ–ç»“æœï¼šåŠ¨æ€åœ°è·¨è¶Šç‰¹å®šå›¾åƒã€è¶…å‚æ•°/æ¨¡å‹ç‰ˆæœ¬æˆ–æ—¶é—´æ­¥é•¿ã€‚</li></ol><h3 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h3><h4 id="Compare-predicted-scores-for-specific-images"><a href="#Compare-predicted-scores-for-specific-images" class="headerlink" title="Compare predicted scores for specific images"></a>Compare predicted scores for specific images</h4><p><a href="https://wandb.ai/stacey/table-quickstart/reports/CNN-2-Progress-over-Training-Time--Vmlldzo3NDY5ODU?_gl=1*6z1980*_ga*MTUwMzMwNTA4NC4xNjg1MzI0NjI3*_ga_JH1SJHJQXJ*MTY4NjU0ODg1NC40LjEuMTY4NjU1MTg0Ni4zOC4wLjA.#compare-predictions-after-1-vs-5-epochs">å®ä¾‹ï¼šæ¯”è¾ƒ 1 å’Œ 5 ä¸ªè®­ç»ƒå‘¨æœŸåçš„é¢„æµ‹</a></p><p><img src="https://blog-img-1304093596.cos.ap-shanghai.myqcloud.com/undefinedNMme6Qj.png" alt="1 epoch vs 5 epochs of training"></p><p>ç›´æ–¹å›¾æ¯”è¾ƒäº†ä¸¤ä¸ªæ¨¡å‹ä¹‹é—´çš„æ¯ç±»åˆ†æ•°ã€‚æ¯ä¸ªç›´æ–¹å›¾ä¸­é¡¶éƒ¨çš„ç»¿è‰²æ¡ä»£è¡¨æ¨¡å‹â€œCNN-2, 1 epochâ€ï¼ˆid 0ï¼‰ï¼Œå®ƒåªè®­ç»ƒäº† 1 ä¸ª epochã€‚åº•éƒ¨çš„ç´«è‰²æ¡ä»£è¡¨æ¨¡å‹â€œCNN-2, 5 epochsâ€ (id 1)ï¼Œå®ƒè®­ç»ƒäº† 5 ä¸ª epochsã€‚å›¾åƒè¢«è¿‡æ»¤åˆ°æ¨¡å‹ä¸ä¸€è‡´çš„æƒ…å†µã€‚ä¾‹å¦‚ï¼Œåœ¨ç¬¬ä¸€è¡Œä¸­ï¼Œâ€œ4â€åœ¨ 1 ä¸ªæ—¶æœŸååœ¨æ‰€æœ‰å¯èƒ½çš„æ•°å­—ä¸­è·å¾—é«˜åˆ†ï¼Œä½†åœ¨ 5 ä¸ªæ—¶æœŸåï¼Œå®ƒåœ¨æ­£ç¡®æ ‡ç­¾ä¸Šå¾—åˆ†æœ€é«˜ï¼Œè€Œåœ¨å…¶ä½™éƒ¨åˆ†å¾—åˆ†éå¸¸ä½ã€‚</p><h4 id="Focus-on-top-errors-over-time"><a href="#Focus-on-top-errors-over-time" class="headerlink" title="Focus on top errors over time"></a>Focus on top errors over time</h4><p><a href="https://wandb.ai/stacey/table-quickstart/reports/CNN-2-Progress-over-Training-Time--Vmlldzo3NDY5ODU?_gl=1*1nxbzl7*_ga*MTUwMzMwNTA4NC4xNjg1MzI0NjI3*_ga_JH1SJHJQXJ*MTY4NjU0ODg1NC40LjEuMTY4NjU1MTg0Ni4zOC4wLjA.#top-errors-over-time">å®ä¾‹ â†’</a></p><p>æŸ¥çœ‹å®Œæ•´æµ‹è¯•æ•°æ®çš„ä¸æ­£ç¡®é¢„æµ‹ï¼ˆè¿‡æ»¤ â€œguessâ€ != â€œtruthâ€ çš„è¡Œï¼‰ã€‚è¯·æ³¨æ„ï¼Œåœ¨ 1 ä¸ªè®­ç»ƒæ—¶æœŸåæœ‰ 229 ä¸ªé”™è¯¯çŒœæµ‹ï¼Œä½†åœ¨ 5 ä¸ªæ—¶æœŸååªæœ‰ 98 ä¸ªã€‚</p><p><img src="https://blog-img-1304093596.cos.ap-shanghai.myqcloud.com/undefined7g8nodn.png" alt="side by side, 1 vs 5 epochs of training"></p><h4 id="Compare-model-performance-and-find-patterns"><a href="#Compare-model-performance-and-find-patterns" class="headerlink" title="Compare model performance and find patterns"></a>Compare model performance and find patterns</h4><p><a href="https://wandb.ai/stacey/table-quickstart/reports/CNN-2-Progress-over-Training-Time--Vmlldzo3NDY5ODU?_gl=1*8r828v*_ga*MTUwMzMwNTA4NC4xNjg1MzI0NjI3*_ga_JH1SJHJQXJ*MTY4NjU0ODg1NC40LjEuMTY4NjU1MTg0Ni4zOC4wLjA.#false-positives-grouped-by-guess">æŸ¥çœ‹å®ä¾‹ä¸­çš„å®Œæ•´è¯¦ç»†ä¿¡æ¯ â†’</a></p><p>è¿‡æ»¤å‡ºæ­£ç¡®ç­”æ¡ˆï¼Œç„¶åæŒ‰çŒœæµ‹åˆ†ç»„ï¼Œä»¥æŸ¥çœ‹é”™è¯¯åˆ†ç±»å›¾åƒçš„ç¤ºä¾‹å’ŒçœŸå®æ ‡ç­¾çš„åŸºæœ¬åˆ†å¸ƒâ€”â€”å¹¶æ’æ˜¾ç¤ºä¸¤ä¸ªæ¨¡å‹ã€‚å…·æœ‰ 2X layer sizes å’Œå­¦ä¹ ç‡çš„æ¨¡å‹å˜ä½“åœ¨å·¦ä¾§ï¼ŒåŸºçº¿åœ¨å³ä¾§ã€‚è¯·æ³¨æ„ï¼Œå¯¹äºæ¯ä¸ªçŒœæµ‹çš„ç±»ï¼ŒåŸºçº¿éƒ½ä¼šçŠ¯æ›´å¤šçš„é”™è¯¯ã€‚</p><p><img src="https://blog-img-1304093596.cos.ap-shanghai.myqcloud.com/undefinedi5PP9AE.png" alt="grouped errors for baseline vs double variant"></p><h3 id="Sign-up-or-login"><a href="#Sign-up-or-login" class="headerlink" title="Sign up or login"></a>Sign up or login</h3><p><a href="https://wandb.ai/login">Sign up or login</a> W&amp;B ä»¥åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹æ‚¨çš„å®éªŒå¹¶ä¸ä¹‹äº’åŠ¨ã€‚</p><p>åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ Google Colab ä½œä¸ºæ–¹ä¾¿çš„æ‰˜ç®¡ç¯å¢ƒï¼Œä½†æ‚¨å¯ä»¥ä»ä»»ä½•åœ°æ–¹è¿è¡Œè‡ªå·±çš„è®­ç»ƒè„šæœ¬ï¼Œå¹¶ä½¿ç”¨ W&amp;B çš„å®éªŒè·Ÿè¸ªå·¥å…·å¯è§†åŒ–æŒ‡æ ‡ã€‚</p><pre class=" language-bash"><code class="language-bash"><span class="token operator">!</span>pip <span class="token function">install</span> wandb -qqq</code></pre><p>ç™»å½•æ‚¨çš„å¸æˆ·</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> wandbwandb<span class="token punctuation">.</span>login<span class="token punctuation">(</span><span class="token punctuation">)</span>WANDB_PROJECT <span class="token operator">=</span> <span class="token string">"mnist-viz"</span></code></pre><h3 id="0-Setup"><a href="#0-Setup" class="headerlink" title="0. Setup"></a>0. Setup</h3><p>å®‰è£…ä¾èµ–é¡¹ï¼Œä¸‹è½½ MNISTï¼Œå¹¶ä½¿ç”¨ PyTorch åˆ›å»ºè®­ç»ƒå’Œæµ‹è¯•æ•°æ®é›†ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> torch<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn<span class="token keyword">import</span> torchvision<span class="token keyword">import</span> torchvision<span class="token punctuation">.</span>transforms <span class="token keyword">as</span> T <span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional <span class="token keyword">as</span> Fdevice <span class="token operator">=</span> <span class="token string">"cuda:0"</span> <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">"cpu"</span><span class="token comment" spellcheck="true"># create train and test dataloaders</span><span class="token keyword">def</span> <span class="token function">get_dataloader</span><span class="token punctuation">(</span>is_train<span class="token punctuation">,</span> batch_size<span class="token punctuation">,</span> slice<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token string">"Get a training dataloader"</span>    ds <span class="token operator">=</span> torchvision<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>MNIST<span class="token punctuation">(</span>root<span class="token operator">=</span><span class="token string">"."</span><span class="token punctuation">,</span> train<span class="token operator">=</span>is_train<span class="token punctuation">,</span> transform<span class="token operator">=</span>T<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> download<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    loader <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>dataset<span class="token operator">=</span>ds<span class="token punctuation">,</span>                                          batch_size<span class="token operator">=</span>batch_size<span class="token punctuation">,</span>                                          shuffle<span class="token operator">=</span><span class="token boolean">True</span> <span class="token keyword">if</span> is_train <span class="token keyword">else</span> <span class="token boolean">False</span><span class="token punctuation">,</span>                                          pin_memory<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> num_workers<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> loader</code></pre><h3 id="1-Define-the-model-and-training-schedule"><a href="#1-Define-the-model-and-training-schedule" class="headerlink" title="1. Define the model and training schedule"></a>1. Define the model and training schedule</h3><ul><li>è®¾ç½®è¦è¿è¡Œçš„çºªå…ƒæ•°ï¼Œå…¶ä¸­æ¯ä¸ªçºªå…ƒåŒ…å«ä¸€ä¸ªè®­ç»ƒæ­¥éª¤å’Œä¸€ä¸ªéªŒè¯ï¼ˆæµ‹è¯•ï¼‰æ­¥éª¤ã€‚ ï¼ˆå¯é€‰ï¼‰é…ç½®æ¯ä¸ªæµ‹è¯•æ­¥éª¤è¦è®°å½•çš„æ•°æ®é‡ã€‚è¿™é‡Œè¦å¯è§†åŒ–çš„æ‰¹æ¬¡æ•°å’Œæ¯æ‰¹æ¬¡çš„å›¾åƒæ•°è®¾ç½®å¾—è¾ƒä½ï¼Œä»¥ç®€åŒ–æ¼”ç¤ºã€‚</li><li>å®šä¹‰ä¸€ä¸ªç®€å•çš„å·ç§¯ç¥ç»ç½‘ç»œï¼ˆéµå¾ª <a href="https://github.com/yunjey/pytorch-tutorial">pytorch-tutorial</a> ä»£ç ï¼‰ã€‚</li><li>ä½¿ç”¨ PyTorch åŠ è½½è®­ç»ƒé›†å’Œæµ‹è¯•é›†</li></ul><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Number of epochs to run</span><span class="token comment" spellcheck="true"># Each epoch includes a training step and a test step, so this sets</span><span class="token comment" spellcheck="true"># the number of tables of test predictions to log</span>EPOCHS <span class="token operator">=</span> <span class="token number">1</span><span class="token comment" spellcheck="true"># Number of batches to log from the test data for each test step</span><span class="token comment" spellcheck="true"># (default set low to simplify demo)</span>NUM_BATCHES_TO_LOG <span class="token operator">=</span> <span class="token number">10</span> <span class="token comment" spellcheck="true">#79</span><span class="token comment" spellcheck="true"># Number of images to log per test batch</span><span class="token comment" spellcheck="true"># (default set low to simplify demo)</span>NUM_IMAGES_PER_BATCH <span class="token operator">=</span> <span class="token number">32</span> <span class="token comment" spellcheck="true">#128</span><span class="token comment" spellcheck="true"># training configuration and hyperparameters</span>NUM_CLASSES <span class="token operator">=</span> <span class="token number">10</span>BATCH_SIZE <span class="token operator">=</span> <span class="token number">32</span>LEARNING_RATE <span class="token operator">=</span> <span class="token number">0.001</span>L1_SIZE <span class="token operator">=</span> <span class="token number">32</span>L2_SIZE <span class="token operator">=</span> <span class="token number">64</span><span class="token comment" spellcheck="true"># changing this may require changing the shape of adjacent layers</span>CONV_KERNEL_SIZE <span class="token operator">=</span> <span class="token number">5</span><span class="token comment" spellcheck="true"># define a two-layer convolutional neural network</span><span class="token keyword">class</span> <span class="token class-name">ConvNet</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> num_classes<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span>ConvNet<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>layer1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>            nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> L1_SIZE<span class="token punctuation">,</span> CONV_KERNEL_SIZE<span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span>L1_SIZE<span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>MaxPool2d<span class="token punctuation">(</span>kernel_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>layer2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>            nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>L1_SIZE<span class="token punctuation">,</span> L2_SIZE<span class="token punctuation">,</span> CONV_KERNEL_SIZE<span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span>L2_SIZE<span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>MaxPool2d<span class="token punctuation">(</span>kernel_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>fc <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">7</span><span class="token operator">*</span>L2_SIZE<span class="token punctuation">,</span> NUM_CLASSES<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>softmax <span class="token operator">=</span> nn<span class="token punctuation">.</span>Softmax<span class="token punctuation">(</span>NUM_CLASSES<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># uncomment to see the shape of a given layer:</span>        <span class="token comment" spellcheck="true">#print("x: ", x.size())</span>        out <span class="token operator">=</span> self<span class="token punctuation">.</span>layer1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        out <span class="token operator">=</span> self<span class="token punctuation">.</span>layer2<span class="token punctuation">(</span>out<span class="token punctuation">)</span>        out <span class="token operator">=</span> out<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>out<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>        out <span class="token operator">=</span> self<span class="token punctuation">.</span>fc<span class="token punctuation">(</span>out<span class="token punctuation">)</span>        <span class="token keyword">return</span> outtrain_loader <span class="token operator">=</span> get_dataloader<span class="token punctuation">(</span>is_train<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> batch_size<span class="token operator">=</span>BATCH_SIZE<span class="token punctuation">)</span>test_loader <span class="token operator">=</span> get_dataloader<span class="token punctuation">(</span>is_train<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>BATCH_SIZE<span class="token punctuation">)</span>device <span class="token operator">=</span> torch<span class="token punctuation">.</span>device<span class="token punctuation">(</span><span class="token string">"cuda:0"</span> <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">"cpu"</span><span class="token punctuation">)</span></code></pre><h3 id="2-Run-training-and-log-test-predictions"><a href="#2-Run-training-and-log-test-predictions" class="headerlink" title="2. Run training and log test predictions"></a>2. Run training and log test predictions</h3><p>å¯¹äºæ¯ä¸ªæ—¶æœŸï¼Œè¿è¡Œä¸€ä¸ªè®­ç»ƒæ­¥éª¤å’Œä¸€ä¸ªæµ‹è¯•æ­¥éª¤ã€‚å¯¹äºæ¯ä¸ªæµ‹è¯•æ­¥éª¤ï¼Œåˆ›å»ºä¸€ä¸ª wandb.Table() æ¥å­˜å‚¨æµ‹è¯•é¢„æµ‹ã€‚è¿™äº›å¯ä»¥åœ¨æ‚¨çš„æµè§ˆå™¨ä¸­è¿›è¡Œå¯è§†åŒ–ã€åŠ¨æ€æŸ¥è¯¢å’Œå¹¶æ’æ¯”è¾ƒã€‚</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># âœ¨ W&amp;B: Initialize a new run to track this model's training</span>wandb<span class="token punctuation">.</span>init<span class="token punctuation">(</span>project<span class="token operator">=</span><span class="token string">"table-quickstart"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># âœ¨ W&amp;B: Log hyperparameters using config</span>cfg <span class="token operator">=</span> wandb<span class="token punctuation">.</span>configcfg<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"epochs"</span> <span class="token punctuation">:</span> EPOCHS<span class="token punctuation">,</span> <span class="token string">"batch_size"</span><span class="token punctuation">:</span> BATCH_SIZE<span class="token punctuation">,</span> <span class="token string">"lr"</span> <span class="token punctuation">:</span> LEARNING_RATE<span class="token punctuation">,</span>            <span class="token string">"l1_size"</span> <span class="token punctuation">:</span> L1_SIZE<span class="token punctuation">,</span> <span class="token string">"l2_size"</span><span class="token punctuation">:</span> L2_SIZE<span class="token punctuation">,</span>            <span class="token string">"conv_kernel"</span> <span class="token punctuation">:</span> CONV_KERNEL_SIZE<span class="token punctuation">,</span>            <span class="token string">"img_count"</span> <span class="token punctuation">:</span> min<span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">,</span> NUM_IMAGES_PER_BATCH<span class="token operator">*</span>NUM_BATCHES_TO_LOG<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># define model, loss, and optimizer</span>model <span class="token operator">=</span> ConvNet<span class="token punctuation">(</span>NUM_CLASSES<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>criterion <span class="token operator">=</span> nn<span class="token punctuation">.</span>CrossEntropyLoss<span class="token punctuation">(</span><span class="token punctuation">)</span>optimizer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span>LEARNING_RATE<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># convenience funtion to log predictions for a batch of test images</span><span class="token keyword">def</span> <span class="token function">log_test_predictions</span><span class="token punctuation">(</span>images<span class="token punctuation">,</span> labels<span class="token punctuation">,</span> outputs<span class="token punctuation">,</span> predicted<span class="token punctuation">,</span> test_table<span class="token punctuation">,</span> log_counter<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># obtain confidence scores for all classes</span>  scores <span class="token operator">=</span> F<span class="token punctuation">.</span>softmax<span class="token punctuation">(</span>outputs<span class="token punctuation">.</span>data<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  log_scores <span class="token operator">=</span> scores<span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>  log_images <span class="token operator">=</span> images<span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>  log_labels <span class="token operator">=</span> labels<span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>  log_preds <span class="token operator">=</span> predicted<span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># adding ids based on the order of the images</span>  _id <span class="token operator">=</span> <span class="token number">0</span>  <span class="token keyword">for</span> i<span class="token punctuation">,</span> l<span class="token punctuation">,</span> p<span class="token punctuation">,</span> s <span class="token keyword">in</span> zip<span class="token punctuation">(</span>log_images<span class="token punctuation">,</span> log_labels<span class="token punctuation">,</span> log_preds<span class="token punctuation">,</span> log_scores<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># add required info to data table:</span>    <span class="token comment" spellcheck="true"># id, image pixels, model's guess, true label, scores for all classes</span>    img_id <span class="token operator">=</span> str<span class="token punctuation">(</span>_id<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"_"</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>log_counter<span class="token punctuation">)</span>    test_table<span class="token punctuation">.</span>add_data<span class="token punctuation">(</span>img_id<span class="token punctuation">,</span> wandb<span class="token punctuation">.</span>Image<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token punctuation">,</span> l<span class="token punctuation">,</span> <span class="token operator">*</span>s<span class="token punctuation">)</span>    _id <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">if</span> _id <span class="token operator">==</span> NUM_IMAGES_PER_BATCH<span class="token punctuation">:</span>      <span class="token keyword">break</span><span class="token comment" spellcheck="true"># train the model</span>total_step <span class="token operator">=</span> len<span class="token punctuation">(</span>train_loader<span class="token punctuation">)</span><span class="token keyword">for</span> epoch <span class="token keyword">in</span> range<span class="token punctuation">(</span>EPOCHS<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># training step</span>    <span class="token keyword">for</span> i<span class="token punctuation">,</span> <span class="token punctuation">(</span>images<span class="token punctuation">,</span> labels<span class="token punctuation">)</span> <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>train_loader<span class="token punctuation">)</span><span class="token punctuation">:</span>        images <span class="token operator">=</span> images<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>        labels <span class="token operator">=</span> labels<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># forward pass</span>        outputs <span class="token operator">=</span> model<span class="token punctuation">(</span>images<span class="token punctuation">)</span>        loss <span class="token operator">=</span> criterion<span class="token punctuation">(</span>outputs<span class="token punctuation">,</span> labels<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># backward and optimize</span>        optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>        loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>        optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>          <span class="token comment" spellcheck="true"># âœ¨ W&amp;B: Log loss over training steps, visualized in the UI live</span>        wandb<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"loss"</span> <span class="token punctuation">:</span> loss<span class="token punctuation">}</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">100</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">'Epoch [{}/{}], Step [{}/{}], Loss: {:.4f}'</span>                <span class="token punctuation">.</span>format<span class="token punctuation">(</span>epoch<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> EPOCHS<span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> total_step<span class="token punctuation">,</span> loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># âœ¨ W&amp;B: Create a Table to store predictions for each test step</span>    columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"image"</span><span class="token punctuation">,</span> <span class="token string">"guess"</span><span class="token punctuation">,</span> <span class="token string">"truth"</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> digit <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>      columns<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"score_"</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>digit<span class="token punctuation">)</span><span class="token punctuation">)</span>    test_table <span class="token operator">=</span> wandb<span class="token punctuation">.</span>Table<span class="token punctuation">(</span>columns<span class="token operator">=</span>columns<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># test the model</span>    model<span class="token punctuation">.</span>eval<span class="token punctuation">(</span><span class="token punctuation">)</span>    log_counter <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        correct <span class="token operator">=</span> <span class="token number">0</span>        total <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">for</span> images<span class="token punctuation">,</span> labels <span class="token keyword">in</span> test_loader<span class="token punctuation">:</span>            images <span class="token operator">=</span> images<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>            labels <span class="token operator">=</span> labels<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>            outputs <span class="token operator">=</span> model<span class="token punctuation">(</span>images<span class="token punctuation">)</span>            _<span class="token punctuation">,</span> predicted <span class="token operator">=</span> torch<span class="token punctuation">.</span>max<span class="token punctuation">(</span>outputs<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> log_counter <span class="token operator">&lt;</span> NUM_BATCHES_TO_LOG<span class="token punctuation">:</span>              log_test_predictions<span class="token punctuation">(</span>images<span class="token punctuation">,</span> labels<span class="token punctuation">,</span> outputs<span class="token punctuation">,</span> predicted<span class="token punctuation">,</span> test_table<span class="token punctuation">,</span> log_counter<span class="token punctuation">)</span>              log_counter <span class="token operator">+=</span> <span class="token number">1</span>            total <span class="token operator">+=</span> labels<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>            correct <span class="token operator">+=</span> <span class="token punctuation">(</span>predicted <span class="token operator">==</span> labels<span class="token punctuation">)</span><span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>        acc <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">*</span> correct <span class="token operator">/</span> total        <span class="token comment" spellcheck="true"># âœ¨ W&amp;B: Log accuracy across training epochs, to visualize in the UI</span>        wandb<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"epoch"</span> <span class="token punctuation">:</span> epoch<span class="token punctuation">,</span> <span class="token string">"acc"</span> <span class="token punctuation">:</span> acc<span class="token punctuation">}</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Test Accuracy of the model on the 10000 test images: {} %'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>acc<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># âœ¨ W&amp;B: Log predictions table to wandb</span>    wandb<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"test_predictions"</span> <span class="token punctuation">:</span> test_table<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># âœ¨ W&amp;B: Mark the run as complete (useful for multi-cell notebook)</span>wandb<span class="token punctuation">.</span>finish<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="Tune-hyperparameters"><a href="#Tune-hyperparameters" class="headerlink" title="Tune hyperparameters"></a>Tune hyperparameters</h2><p><a href="https://colab.research.google.com/github/wandb/examples/blob/master/colabs/pytorch/Organizing_Hyperparameter_Sweeps_in_PyTorch_with_W&amp;B.ipynb">åœ¨æ­¤å¤„è¯•ç”¨ Colab Notebook â†’</a></p><p>åœ¨é«˜ç»´è¶…å‚æ•°ç©ºé—´ä¸­æœç´¢ä»¥æ‰¾åˆ°æ€§èƒ½æœ€é«˜çš„æ¨¡å‹å¯èƒ½ä¼šå¾ˆå¿«å˜å¾—ç¬¨æ‹™ã€‚è¶…å‚æ•°æ‰«ææä¾›äº†ä¸€ç§æœ‰ç»„ç»‡ä¸”é«˜æ•ˆçš„æ–¹å¼æ¥è¿›è¡Œæ¨¡å‹å¤§é€ƒæ€å¹¶é€‰æ‹©æœ€å‡†ç¡®çš„æ¨¡å‹ã€‚ä»–ä»¬é€šè¿‡è‡ªåŠ¨æœç´¢è¶…å‚æ•°å€¼çš„ç»„åˆï¼ˆä¾‹å¦‚ learning rate, batch size, number of hidden layers, optimizer typeï¼‰æ¥æ‰¾åˆ°æœ€ä½³å€¼æ¥å®ç°è¿™ä¸€ç‚¹ã€‚</p><p>åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†äº†è§£å¦‚ä½•ä½¿ç”¨ Weights &amp; Biases é€šè¿‡ 3 ä¸ªç®€å•æ­¥éª¤è¿è¡Œå¤æ‚çš„è¶…å‚æ•°æ‰«æã€‚</p><h3 id="Follow-along-with-a-video-tutorial"><a href="#Follow-along-with-a-video-tutorial" class="headerlink" title="Follow along with a video tutorial!"></a>Follow along with a <a href="http://wandb.me/sweeps-video">video tutorial</a>!</h3><p><img src="https://blog-img-1304093596.cos.ap-shanghai.myqcloud.com/undefinedWVKkMWw.png" alt="tune hyperparameters"></p><h3 id="Setup"><a href="#Setup" class="headerlink" title="Setup"></a>Setup</h3><p>é¦–å…ˆå®‰è£…å®éªŒè·Ÿè¸ªåº“å¹¶è®¾ç½®æ‚¨çš„å…è´¹ W&amp;B å¸æˆ·ï¼š</p><ol><li>ä½¿ç”¨ <code>pip install</code> å®‰è£…</li><li><code>import</code> Python æ‰€éœ€ä¾èµ–</li><li><code>.login()</code> è¿™æ ·æ‚¨å°±å¯ä»¥å°†æŒ‡æ ‡è®°å½•åˆ°æ‚¨çš„é¡¹ç›®ä¸­</li></ol><p>å¦‚æœæ‚¨ä»¥å‰ä»æœªä½¿ç”¨è¿‡ Weights &amp; Biasesï¼Œç™»å½•ç”µè¯ä¼šç»™æ‚¨ä¸€ä¸ªæ³¨å†Œå¸æˆ·çš„é“¾æ¥ã€‚ W&amp;B å¯å…è´¹ç”¨äºä¸ªäººå’Œå­¦æœ¯é¡¹ç›®ï¼</p><pre class=" language-bash"><code class="language-bash"><span class="token operator">!</span>pip <span class="token function">install</span> wandb -Uq</code></pre><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> wandbwandb<span class="token punctuation">.</span>login<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h3 id="Step-1ï¸âƒ£-Define-the-Sweep"><a href="#Step-1ï¸âƒ£-Define-the-Sweep" class="headerlink" title="Step 1ï¸âƒ£. Define the Sweep"></a>Step 1ï¸âƒ£. Define the Sweep</h3><p>ä»æ ¹æœ¬ä¸Šè¯´ï¼ŒSweep å°†å°è¯•ä¸€å †è¶…å‚æ•°å€¼çš„ç­–ç•¥ä¸è¯„ä¼°å®ƒä»¬çš„ä»£ç ç»“åˆåœ¨ä¸€èµ·ã€‚æ‚¨åªéœ€è¦ä»¥<a href="https://docs.wandb.com/sweeps/configuration">é…ç½®</a>çš„å½¢å¼å®šä¹‰æ‚¨çš„ç­–ç•¥ã€‚</p><p>å½“æ‚¨åƒè¿™æ ·åœ¨ç¬”è®°æœ¬ä¸­è®¾ç½® Sweep æ—¶ï¼Œè¯¥é…ç½®å¯¹è±¡æ˜¯ä¸€ä¸ªåµŒå¥—å­—å…¸ã€‚å½“æ‚¨é€šè¿‡å‘½ä»¤è¡Œè¿è¡Œ Sweep æ—¶ï¼Œé…ç½®å¯¹è±¡æ˜¯ä¸€ä¸ª <a href="https://docs.wandb.com/sweeps/quickstart#2-sweep-config">YAML file</a>ã€‚</p><p>è®©æˆ‘ä»¬ä¸€èµ·äº†è§£ Sweep é…ç½®çš„å®šä¹‰ã€‚æˆ‘ä»¬ä¼šæ…¢æ…¢æ¥ï¼Œè¿™æ ·æˆ‘ä»¬å°±æœ‰æœºä¼šè§£é‡Šæ¯ä¸ªç»„ä»¶ã€‚åœ¨å…¸å‹çš„ Sweep ç®¡é“ä¸­ï¼Œæ­¤æ­¥éª¤å°†åœ¨å•ä¸ªåˆ†é…ä¸­å®Œæˆã€‚</p><h4 id="Pick-a-method"><a href="#Pick-a-method" class="headerlink" title="Pick a method"></a>Pick a <code>method</code></h4><p>æˆ‘ä»¬éœ€è¦å®šä¹‰çš„ç¬¬ä¸€ä»¶äº‹æ˜¯é€‰æ‹©æ–°å‚æ•°å€¼çš„ <code>method</code>ã€‚</p><p>æˆ‘ä»¬æä¾›ä»¥ä¸‹æœç´¢ <code>methods</code>ï¼š</p><ul><li>**<code>grid</code> Search **â€“ è¿­ä»£è¶…å‚æ•°å€¼çš„æ¯ä¸ªç»„åˆã€‚éå¸¸æœ‰æ•ˆï¼Œä½†è®¡ç®—é‡å¤§ã€‚</li><li><strong><code>random</code> Search</strong> â€“ æ ¹æ®æä¾›çš„ <code>distribution</code> éšæœºé€‰æ‹©æ¯ä¸ªæ–°ç»„åˆã€‚å‡ºä¹æ„æ–™çš„æœ‰æ•ˆï¼</li><li><strong><code>bayesian</code> Search</strong> â€“ åˆ›å»ºä¸€ä¸ªåº¦é‡åˆ†æ•°ä½œä¸ºè¶…å‚æ•°å‡½æ•°çš„æ¦‚ç‡æ¨¡å‹ï¼Œå¹¶é€‰æ‹©å…·æœ‰æé«˜åº¦é‡çš„é«˜æ¦‚ç‡çš„å‚æ•°ã€‚é€‚ç”¨äºå°‘é‡è¿ç»­å‚æ•°ä½†æ‰©å±•æ€§å·®ã€‚</li></ul><p><code>random</code> æ–¹æ³•ï¼š</p><pre class=" language-python"><code class="language-python">sweep_config <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">'method'</span><span class="token punctuation">:</span> <span class="token string">'random'</span>    <span class="token punctuation">}</span></code></pre><p>å¯¹äº <code>bayesian</code> Sweepsï¼Œæ‚¨è¿˜éœ€è¦å‘Šè¯‰æˆ‘ä»¬ä¸€äº›å…³äºæ‚¨çš„ metric çš„ä¿¡æ¯ã€‚æˆ‘ä»¬éœ€è¦çŸ¥é“å®ƒçš„åç§°ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥åœ¨æ¨¡å‹è¾“å‡ºä¸­æ‰¾åˆ°å®ƒï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“æ‚¨çš„ç›®æ ‡æ˜¯æœ€å°åŒ–å®ƒï¼ˆä¾‹å¦‚ï¼Œå¦‚æœå®ƒæ˜¯ squared errorï¼‰è¿˜æ˜¯æœ€å¤§åŒ–å®ƒï¼ˆä¾‹å¦‚ï¼Œå¦‚æœå®ƒæ˜¯ accuracyï¼‰ã€‚</p><pre class=" language-python"><code class="language-python">metric <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'loss'</span><span class="token punctuation">,</span>    <span class="token string">'goal'</span><span class="token punctuation">:</span> <span class="token string">'minimize'</span>       <span class="token punctuation">}</span>sweep_config<span class="token punctuation">[</span><span class="token string">'metric'</span><span class="token punctuation">]</span> <span class="token operator">=</span> metric</code></pre><p>å¦‚æœæ‚¨æ²¡æœ‰è¿è¡Œ <code>bayesian</code> Sweepï¼Œåˆ™ä¸å¿…è¿™æ ·åšï¼Œä½†æ— è®ºå¦‚ä½•å°†å…¶åŒ…å«åœ¨æ‚¨çš„ <code>sweep_config</code> ä¸­å¹¶ä¸æ˜¯ä¸€ä¸ªåä¸»æ„ï¼Œä»¥é˜²æ‚¨ä»¥åæ”¹å˜ä¸»æ„ã€‚è®°å½•è¿™æ ·çš„äº‹æƒ…ä¹Ÿæ˜¯å¾ˆå¥½çš„å†ç°æ€§å®è·µï¼Œä»¥é˜²ä¸‡ä¸€æ‚¨æˆ–å…¶ä»–äººåœ¨ 6 ä¸ªæœˆæˆ– 6 å¹´åå›åˆ°æ‚¨çš„ Sweep å¹¶ä¸”ä¸çŸ¥é“ <code>val_G_batch</code> åº”è¯¥æ˜¯é«˜è¿˜æ˜¯ä½ã€‚</p><h4 id="Name-the-hyperparameters"><a href="#Name-the-hyperparameters" class="headerlink" title="Name the hyperparameters"></a>Name the hyper<code>parameters</code></h4><p>ä¸€æ—¦æ‚¨é€‰æ‹©äº†ä¸€ç§ <code>method</code> æ¥å°è¯•è¶…å‚æ•°çš„æ–°å€¼ï¼Œæ‚¨éœ€è¦å®šä¹‰è¿™äº› <code>parameters</code>æ˜¯ä»€ä¹ˆ</p><p>å¤§å¤šæ•°æ—¶å€™ï¼Œè¿™ä¸€æ­¥å¾ˆç®€å•ï¼šæ‚¨åªéœ€ä¸º <code>parameter</code> å‘½åå¹¶æŒ‡å®šå‚æ•°çš„åˆæ³• <code>values</code> åˆ—è¡¨ã€‚</p><p>ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬ä¸ºæˆ‘ä»¬çš„ç½‘ç»œé€‰æ‹© <code>optimizer</code> æ—¶ï¼Œåªæœ‰æœ‰é™æ•°é‡çš„é€‰é¡¹ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åšæŒä½¿ç”¨ä¸¤ä¸ªæœ€å—æ¬¢è¿çš„é€‰æ‹©ï¼Œ<code>adam</code> å’Œ <code>sgd</code>ã€‚å³ä½¿å¯¹äºå…·æœ‰æ½œåœ¨æ— é™é€‰é¡¹çš„è¶…å‚æ•°ï¼Œé€šå¸¸ä¹Ÿåªå°è¯•å‡ ä¸ªé€‰æ‹© <code>values</code> æ‰æœ‰æ„ä¹‰ï¼Œå°±åƒæˆ‘ä»¬åœ¨æ­¤å¤„å¯¹éšè—å±‚ <code>layer_size</code> å’Œ <code>dropout</code> æ‰€åšçš„é‚£æ ·ã€‚</p><pre class=" language-python"><code class="language-python">parameters_dict <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">'optimizer'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>        <span class="token string">'values'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'adam'</span><span class="token punctuation">,</span> <span class="token string">'sgd'</span><span class="token punctuation">]</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token string">'fc_layer_size'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>        <span class="token string">'values'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">]</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token string">'dropout'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>          <span class="token string">'values'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">]</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span>sweep_config<span class="token punctuation">[</span><span class="token string">'parameters'</span><span class="token punctuation">]</span> <span class="token operator">=</span> parameters_dict</code></pre><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæœ‰äº›è¶…å‚æ•°æˆ‘ä»¬ä¸æƒ³åœ¨æ­¤ Sweep ä¸­æ”¹å˜ï¼Œä½†æˆ‘ä»¬ä»å¸Œæœ›åœ¨æˆ‘ä»¬çš„ <code>sweep_config</code> ä¸­è®¾ç½®å®ƒä»¬ã€‚</p><p>åœ¨é‚£ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç›´æ¥è®¾ç½® <code>value</code>ï¼š</p><pre class=" language-python"><code class="language-python">parameters_dict<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span>    <span class="token string">'epochs'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>        <span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>å¯¹äº <code>grid</code> æœç´¢ï¼Œè¿™å°±æ˜¯æ‚¨æ‰€éœ€è¦çš„ã€‚</p><p>å¯¹äº <code>random</code> æœç´¢ï¼Œå‚æ•°çš„æ‰€æœ‰ <code>values</code> åœ¨ç»™å®šè¿è¡Œä¸­è¢«é€‰æ‹©çš„å¯èƒ½æ€§ç›¸åŒã€‚</p><p>å¦‚æœè¿™æ ·åšä¸è¡Œï¼Œæ‚¨å¯ä»¥æ”¹ä¸ºæŒ‡å®šå‘½å <code>distribution</code> åŠå…¶å‚æ•°ï¼Œä¾‹å¦‚ <code>normal</code> åˆ†å¸ƒçš„å‡å€¼ <code>mu</code> å’Œæ ‡å‡†å·® <code>sigma</code>ã€‚</p><p>åœ¨<a href="https://docs.wandb.com/sweeps/configuration#distributions">æ­¤å¤„</a>æŸ¥çœ‹æœ‰å…³å¦‚ä½•è®¾ç½®éšæœºå˜é‡åˆ†å¸ƒçš„æ›´å¤šä¿¡æ¯ã€‚</p><pre class=" language-python"><code class="language-python">parameters_dict<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span>    <span class="token string">'learning_rate'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true"># a flat distribution between 0 and 0.1</span>        <span class="token string">'distribution'</span><span class="token punctuation">:</span> <span class="token string">'uniform'</span><span class="token punctuation">,</span>        <span class="token string">'min'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>        <span class="token string">'max'</span><span class="token punctuation">:</span> <span class="token number">0.1</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token string">'batch_size'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true"># integers between 32 and 256</span>        <span class="token comment" spellcheck="true"># with evenly-distributed logarithms </span>        <span class="token string">'distribution'</span><span class="token punctuation">:</span> <span class="token string">'q_log_uniform_values'</span><span class="token punctuation">,</span>        <span class="token string">'q'</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>        <span class="token string">'min'</span><span class="token punctuation">:</span> <span class="token number">32</span><span class="token punctuation">,</span>        <span class="token string">'max'</span><span class="token punctuation">:</span> <span class="token number">256</span><span class="token punctuation">,</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>å½“æˆ‘ä»¬å®Œæˆåï¼Œ<code>sweep_config</code> æ˜¯ä¸€ä¸ªåµŒå¥—çš„å­—å…¸ï¼Œå®ƒå‡†ç¡®åœ°æŒ‡å®šäº†æˆ‘ä»¬æœ‰å…´è¶£å°è¯•å“ªäº› <code>parameters</code> ä»¥åŠæˆ‘ä»¬å°†ä½¿ç”¨ä»€ä¹ˆ <code>method</code> æ¥å°è¯•å®ƒä»¬ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> pprintpprint<span class="token punctuation">.</span>pprint<span class="token punctuation">(</span>sweep_config<span class="token punctuation">)</span></code></pre><p>ä½†è¿™ä¸æ˜¯æ‰€æœ‰çš„é…ç½®é€‰é¡¹ï¼</p><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¿˜æä¾›äº†ä½¿ç”¨ <a href="https://arxiv.org/pdf/1603.06560.pdf">HyperBand</a> è°ƒåº¦ç®—æ³• <code>early_terminate</code> è¿è¡Œçš„é€‰é¡¹ã€‚åœ¨<a href="https://docs.wandb.com/sweeps/configuration#stopping-criteria">è¿™é‡Œ</a>æŸ¥çœ‹æ›´å¤šã€‚</p><p>æ‚¨å¯ä»¥åœ¨<a href="https://docs.wandb.com/library/sweeps/configuration">æ­¤å¤„</a>æ‰¾åˆ°æ‰€æœ‰é…ç½®é€‰é¡¹çš„åˆ—è¡¨ï¼Œå¹¶åœ¨<a href="https://github.com/wandb/examples/tree/master/examples/keras/keras-cnn-fashion">æ­¤å¤„</a>æ‰¾åˆ°å¤§é‡ YAML æ ¼å¼çš„ç¤ºä¾‹ã€‚</p><h3 id="Step-2ï¸âƒ£-Initialize-the-Sweep"><a href="#Step-2ï¸âƒ£-Initialize-the-Sweep" class="headerlink" title="Step 2ï¸âƒ£. Initialize the Sweep"></a>Step 2ï¸âƒ£. Initialize the Sweep</h3><p>ä¸€æ—¦æ‚¨å®šä¹‰äº†æœç´¢ç­–ç•¥ï¼Œå°±è¯¥è®¾ç½®ä¸€äº›ä¸œè¥¿æ¥å®ç°å®ƒäº†ã€‚</p><p>è´Ÿè´£æˆ‘ä»¬ Sweep çš„ clockwork taskmaster è¢«ç§°ä¸º <em>Sweep Controller</em>ã€‚æ¯æ¬¡è¿è¡Œå®Œæˆæ—¶ï¼Œå®ƒå°†å‘å‡ºä¸€ç»„æ–°çš„æŒ‡ä»¤æ¥æè¿°è¦æ‰§è¡Œçš„æ–°è¿è¡Œã€‚è¿™äº›æŒ‡ä»¤ç”±å®é™…æ‰§è¡Œè¿è¡Œçš„ <em>agents</em> è·å–ã€‚</p><p>åœ¨å…¸å‹çš„ Sweep ä¸­ï¼ŒController ä½äºæˆ‘ä»¬çš„æœºå™¨ä¸Šï¼Œè€Œå®Œæˆè¿è¡Œçš„ä»£ç†ä½äºæ‚¨çš„æœºå™¨ä¸Šï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚è¿™ç§åˆ†å·¥ä½¿å¾—åªéœ€æ·»åŠ æ›´å¤šæœºå™¨æ¥è¿è¡Œä»£ç†å°±å¯ä»¥éå¸¸å®¹æ˜“åœ°æ‰©å±• Sweepsï¼</p><p><img src="https://blog-img-1304093596.cos.ap-shanghai.myqcloud.com/undefinedzlbw3vQ.png" alt="sweeps-diagram"></p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨é€‚å½“çš„ <code>sweep_config</code> å’Œ <code>project</code> åç§°è°ƒç”¨ <code>wandb.sweep</code> æ¥ç»“æŸ Sweep Controllerã€‚</p><p>æ­¤å‡½æ•°è¿”å›ä¸€ä¸ª <code>sweep_id</code>ï¼Œæˆ‘ä»¬ç¨åå°†ä½¿ç”¨å®ƒæ¥å°† agents åˆ†é…ç»™æ­¤ Controllerã€‚</p><p>æ—æ³¨ï¼šåœ¨å‘½ä»¤è¡Œä¸Šï¼Œæ­¤åŠŸèƒ½è¢«æ›¿æ¢ä¸º</p><pre class=" language-bash"><code class="language-bash">wandb sweep config.yaml</code></pre><p><a href="https://docs.wandb.com/sweeps/quickstart">äº†è§£æ›´å¤šå…³äºåœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨ Sweeps â¡</a></p><pre class=" language-python"><code class="language-python">sweep_id <span class="token operator">=</span> wandb<span class="token punctuation">.</span>sweep<span class="token punctuation">(</span>sweep_config<span class="token punctuation">,</span> project<span class="token operator">=</span><span class="token string">"pytorch-sweeps-demo"</span><span class="token punctuation">)</span></code></pre><h3 id="Step-3ï¸âƒ£-Run-the-Sweep-agent"><a href="#Step-3ï¸âƒ£-Run-the-Sweep-agent" class="headerlink" title="Step 3ï¸âƒ£. Run the Sweep agent"></a>Step 3ï¸âƒ£. Run the Sweep agent</h3><h4 id="Define-Your-Training-Procedure"><a href="#Define-Your-Training-Procedure" class="headerlink" title="Define Your Training Procedure"></a>Define Your Training Procedure</h4><p>åœ¨æˆ‘ä»¬å®é™…æ‰§è¡Œ sweep ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ä½¿ç”¨è¿™äº›å€¼çš„è®­ç»ƒè¿‡ç¨‹ã€‚</p><p>åœ¨ä¸‹é¢çš„å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬åœ¨ PyTorch ä¸­å®šä¹‰äº†ä¸€ä¸ªç®€å•çš„å…¨è¿æ¥ç¥ç»ç½‘ç»œï¼Œå¹¶æ·»åŠ äº†ä»¥ä¸‹ <code>wandb</code> å·¥å…·æ¥è®°å½•æ¨¡å‹æŒ‡æ ‡ã€å¯è§†åŒ–æ€§èƒ½å’Œè¾“å‡ºå¹¶è·Ÿè¸ªæˆ‘ä»¬çš„å®éªŒï¼š</p><ul><li><a href="https://docs.wandb.com/library/init"><strong><code>wandb.init()</code></strong></a> â€“ åˆå§‹åŒ–æ–°çš„ W&amp;B è¿è¡Œã€‚æ¯æ¬¡è¿è¡Œéƒ½æ˜¯è®­ç»ƒåŠŸèƒ½çš„ä¸€æ¬¡æ‰§è¡Œã€‚</li><li><a href="https://docs.wandb.com/library/config"><strong><code>wandb.config</code></strong></a> â€“ å°†æ‰€æœ‰è¶…å‚æ•°ä¿å­˜åœ¨é…ç½®å¯¹è±¡ä¸­ï¼Œä»¥ä¾¿è®°å½•å®ƒä»¬ã€‚åœ¨<a href="https://colab.research.google.com/github/wandb/examples/blob/master/colabs/wandb-config/Configs_in_W%26B.ipynb">æ­¤å¤„</a>é˜…è¯»æœ‰å…³å¦‚ä½•ä½¿ç”¨ <code>wandb.config</code> çš„æ›´å¤šä¿¡æ¯ã€‚</li><li><a href="https://docs.wandb.com/library/log"><strong><code>wandb.log()</code></strong></a> â€“ å°†æ¨¡å‹è¡Œä¸ºè®°å½•åˆ° W&amp;Bã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åªè®°å½•æ€§èƒ½ï¼›æœ‰å…³å¯ä»¥ä½¿ç”¨ <code>wandb.log</code> è®°å½•çš„æ‰€æœ‰å…¶ä»–å¯Œåª’ä½“ï¼Œè¯·å‚é˜…æ­¤ <a href="https://colab.research.google.com/github/wandb/examples/blob/master/colabs/wandb-log/Log_(Almost)_Anything_with_W%26B_Media.ipynb">Colab</a>ã€‚</li></ul><p>æœ‰å…³ä½¿ç”¨ PyTorch æ£€æµ‹ W&amp;B çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…æ­¤ <a href="https://colab.research.google.com/github/wandb/examples/blob/master/colabs/pytorch/Simple_PyTorch_Integration.ipynb">Colab</a>ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> torch<span class="token keyword">import</span> torch<span class="token punctuation">.</span>optim <span class="token keyword">as</span> optim<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional <span class="token keyword">as</span> F<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn<span class="token keyword">from</span> torchvision <span class="token keyword">import</span> datasets<span class="token punctuation">,</span> transformsdevice <span class="token operator">=</span> torch<span class="token punctuation">.</span>device<span class="token punctuation">(</span><span class="token string">"cuda"</span> <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">"cpu"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">train</span><span class="token punctuation">(</span>config<span class="token operator">=</span>None<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># Initialize a new wandb run</span>    <span class="token keyword">with</span> wandb<span class="token punctuation">.</span>init<span class="token punctuation">(</span>config<span class="token operator">=</span>config<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># If called by wandb.agent, as below,</span>        <span class="token comment" spellcheck="true"># this config will be set by Sweep Controller</span>        config <span class="token operator">=</span> wandb<span class="token punctuation">.</span>config        loader <span class="token operator">=</span> build_dataset<span class="token punctuation">(</span>config<span class="token punctuation">.</span>batch_size<span class="token punctuation">)</span>        network <span class="token operator">=</span> build_network<span class="token punctuation">(</span>config<span class="token punctuation">.</span>fc_layer_size<span class="token punctuation">,</span> config<span class="token punctuation">.</span>dropout<span class="token punctuation">)</span>        optimizer <span class="token operator">=</span> build_optimizer<span class="token punctuation">(</span>network<span class="token punctuation">,</span> config<span class="token punctuation">.</span>optimizer<span class="token punctuation">,</span> config<span class="token punctuation">.</span>learning_rate<span class="token punctuation">)</span>        <span class="token keyword">for</span> epoch <span class="token keyword">in</span> range<span class="token punctuation">(</span>config<span class="token punctuation">.</span>epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>            avg_loss <span class="token operator">=</span> train_epoch<span class="token punctuation">(</span>network<span class="token punctuation">,</span> loader<span class="token punctuation">,</span> optimizer<span class="token punctuation">)</span>            wandb<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"loss"</span><span class="token punctuation">:</span> avg_loss<span class="token punctuation">,</span> <span class="token string">"epoch"</span><span class="token punctuation">:</span> epoch<span class="token punctuation">}</span><span class="token punctuation">)</span>           </code></pre><p>è¿™ä¸ªå•å…ƒæ ¼å®šä¹‰äº†æˆ‘ä»¬è®­ç»ƒè¿‡ç¨‹çš„å››ä¸ªéƒ¨åˆ†ï¼š<code>build_dataset</code>, <code>build_network</code>, <code>build_optimizer</code> å’Œ<code>train_epoch</code>.</p><p>æ‰€æœ‰è¿™äº›éƒ½æ˜¯åŸºæœ¬ PyTorch ç®¡é“çš„æ ‡å‡†éƒ¨åˆ†ï¼Œå®ƒä»¬çš„å®ç°ä¸å—ä½¿ç”¨ W&amp;B çš„å½±å“ï¼Œå› æ­¤æˆ‘ä»¬ä¸ä¼šå¯¹å®ƒä»¬å‘è¡¨è¯„è®ºã€‚</p><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">build_dataset</span><span class="token punctuation">(</span>batch_size<span class="token punctuation">)</span><span class="token punctuation">:</span>       transform <span class="token operator">=</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span>        <span class="token punctuation">[</span>transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>         transforms<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0.1307</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0.3081</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># download MNIST training dataset</span>    dataset <span class="token operator">=</span> datasets<span class="token punctuation">.</span>MNIST<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">,</span> train<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> download<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                             transform<span class="token operator">=</span>transform<span class="token punctuation">)</span>    sub_dataset <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>Subset<span class="token punctuation">(</span>        dataset<span class="token punctuation">,</span> indices<span class="token operator">=</span>range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>dataset<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    loader <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>sub_dataset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span>batch_size<span class="token punctuation">)</span>    <span class="token keyword">return</span> loader<span class="token keyword">def</span> <span class="token function">build_network</span><span class="token punctuation">(</span>fc_layer_size<span class="token punctuation">,</span> dropout<span class="token punctuation">)</span><span class="token punctuation">:</span>    network <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>  <span class="token comment" spellcheck="true"># fully-connected, single hidden layer</span>        nn<span class="token punctuation">.</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">784</span><span class="token punctuation">,</span> fc_layer_size<span class="token punctuation">)</span><span class="token punctuation">,</span> nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        nn<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span>dropout<span class="token punctuation">)</span><span class="token punctuation">,</span>        nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>fc_layer_size<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        nn<span class="token punctuation">.</span>LogSoftmax<span class="token punctuation">(</span>dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> network<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>        <span class="token keyword">def</span> <span class="token function">build_optimizer</span><span class="token punctuation">(</span>network<span class="token punctuation">,</span> optimizer<span class="token punctuation">,</span> learning_rate<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> optimizer <span class="token operator">==</span> <span class="token string">"sgd"</span><span class="token punctuation">:</span>        optimizer <span class="token operator">=</span> optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>network<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                              lr<span class="token operator">=</span>learning_rate<span class="token punctuation">,</span> momentum<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> optimizer <span class="token operator">==</span> <span class="token string">"adam"</span><span class="token punctuation">:</span>        optimizer <span class="token operator">=</span> optim<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span>network<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                               lr<span class="token operator">=</span>learning_rate<span class="token punctuation">)</span>    <span class="token keyword">return</span> optimizer<span class="token keyword">def</span> <span class="token function">train_epoch</span><span class="token punctuation">(</span>network<span class="token punctuation">,</span> loader<span class="token punctuation">,</span> optimizer<span class="token punctuation">)</span><span class="token punctuation">:</span>    cumu_loss <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> _<span class="token punctuation">,</span> <span class="token punctuation">(</span>data<span class="token punctuation">,</span> target<span class="token punctuation">)</span> <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>loader<span class="token punctuation">)</span><span class="token punctuation">:</span>        data<span class="token punctuation">,</span> target <span class="token operator">=</span> data<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">,</span> target<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>        optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># â¡ Forward pass</span>        loss <span class="token operator">=</span> F<span class="token punctuation">.</span>nll_loss<span class="token punctuation">(</span>network<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> target<span class="token punctuation">)</span>        cumu_loss <span class="token operator">+=</span> loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># â¬… Backward pass + weight update</span>        loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>        optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>        wandb<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"batch loss"</span><span class="token punctuation">:</span> loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> cumu_loss <span class="token operator">/</span> len<span class="token punctuation">(</span>loader<span class="token punctuation">)</span></code></pre><p>ç°åœ¨ï¼Œæˆ‘ä»¬å‡†å¤‡å¼€å§‹ sweeping äº†ï¼</p><p>Sweep Controllersï¼Œå°±åƒæˆ‘ä»¬é€šè¿‡è¿è¡Œ <code>wandb.sweep</code> åˆ¶ä½œçš„æ§åˆ¶å™¨ä¸€æ ·ï¼Œåç­‰æœ‰äººè¦æ±‚ä»–ä»¬æä¾› <code>config </code>æ¥è¯•ç”¨ã€‚</p><p>æŸäººæ˜¯ <code>agent</code>ï¼Œä»–ä»¬æ˜¯ç”¨ <code>wandb.agent</code> åˆ›å»ºçš„ã€‚è¦å¼€å§‹ï¼Œagent åªéœ€è¦çŸ¥é“</p><ol><li>å®ƒæ˜¯ (<code>sweep_id</code>) çš„ä¸€éƒ¨åˆ†</li><li>å®ƒåº”è¯¥è¿è¡Œå“ªä¸ªå‡½æ•°ï¼ˆè¿™é‡Œæ˜¯ <code>train</code>ï¼‰</li><li>ï¼ˆå¯é€‰ï¼‰æœ‰å¤šå°‘é…ç½®è¦æ±‚æ§åˆ¶å™¨ï¼ˆ<code>count</code>ï¼‰</li></ol><p>ä»…ä¾›å‚è€ƒï¼Œæ‚¨å¯ä»¥åœ¨ä¸åŒçš„è®¡ç®—èµ„æºä¸Šå¯åŠ¨å…·æœ‰ç›¸åŒ <code>sweep_id</code> çš„å¤šä¸ª <code>agent</code>ï¼ŒController å°†ç¡®ä¿å®ƒä»¬æ ¹æ® <code>sweep_config</code> ä¸­åˆ¶å®šçš„ç­–ç•¥ååŒå·¥ä½œã€‚è¿™ä½¿å¾—åœ¨å°½å¯èƒ½å¤šçš„èŠ‚ç‚¹ä¸Šæ‰©å±• Sweeps å˜å¾—è½»è€Œæ˜“ä¸¾ï¼</p><p>æ—æ³¨ï¼šåœ¨å‘½ä»¤è¡Œä¸Šï¼Œæ­¤åŠŸèƒ½è¢«æ›¿æ¢ä¸º</p><pre class=" language-bash"><code class="language-bash">wandb agent sweep_id</code></pre><p><a href="https://docs.wandb.com/sweeps/quickstart">äº†è§£æ›´å¤šå…³äºåœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨ Sweeps â¡</a></p><p>ä¸‹é¢çš„å•å…ƒæ ¼å°†å¯åŠ¨ä¸€ä¸ªè¿è¡Œ <code>train</code> 5 æ¬¡çš„ <code>agent</code>ï¼Œä½¿ç”¨ Sweep Controller è¿”å›çš„éšæœºç”Ÿæˆçš„è¶…å‚æ•°å€¼ã€‚æ‰§è¡Œæ—¶é—´ä¸åˆ° 5 åˆ†é’Ÿã€‚</p><pre class=" language-python"><code class="language-python">wandb<span class="token punctuation">.</span>agent<span class="token punctuation">(</span>sweep_id<span class="token punctuation">,</span> train<span class="token punctuation">,</span> count<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span></code></pre><h3 id="Visualize-Sweep-Results"><a href="#Visualize-Sweep-Results" class="headerlink" title="Visualize Sweep Results"></a>Visualize Sweep Results</h3><h4 id="Parallel-Coordinates-Plot"><a href="#Parallel-Coordinates-Plot" class="headerlink" title="Parallel Coordinates Plot"></a>Parallel Coordinates Plot</h4><p>æ­¤å›¾å°†è¶…å‚æ•°å€¼æ˜ å°„åˆ°æ¨¡å‹æŒ‡æ ‡ã€‚å®ƒå¯¹äºç£¨ç»ƒå¯¼è‡´æœ€ä½³æ¨¡å‹æ€§èƒ½çš„è¶…å‚æ•°ç»„åˆå¾ˆæœ‰ç”¨ã€‚</p><p><img src="https://blog-img-1304093596.cos.ap-shanghai.myqcloud.com/undefined5e190366778ad831455f9af2_s_194708415DEC35F74A7691FF6810D3B14703D1EFE1672ED29000BA98171242A5_1578695138341_image.png" alt="hyperparameters map to metrics"></p><h4 id="Hyperparameter-Importance-Plot"><a href="#Hyperparameter-Importance-Plot" class="headerlink" title="Hyperparameter Importance Plot"></a>Hyperparameter Importance Plot</h4><p>è¶…å‚æ•°é‡è¦æ€§å›¾è¡¨æ˜å“ªäº›è¶…å‚æ•°æ˜¯æŒ‡æ ‡çš„æœ€ä½³é¢„æµ‹å› å­ã€‚æˆ‘ä»¬æŠ¥å‘Šç‰¹å¾é‡è¦æ€§ï¼ˆæ¥è‡ªéšæœºæ£®æ—æ¨¡å‹ï¼‰å’Œç›¸å…³æ€§ï¼ˆéšå¼çº¿æ€§æ¨¡å‹ï¼‰ã€‚</p><p><img src="https://blog-img-1304093596.cos.ap-shanghai.myqcloud.com/undefined5e190367778ad820b35f9af5_s_194708415DEC35F74A7691FF6810D3B14703D1EFE1672ED29000BA98171242A5_1578695757573_image.png" alt="parameter importance"></p><p>è¿™äº›å¯è§†åŒ–å¯ä»¥é€šè¿‡ç£¨ç»ƒæœ€é‡è¦çš„å‚æ•°ï¼ˆå’Œå€¼èŒƒå›´ï¼‰æ¥å¸®åŠ©æ‚¨èŠ‚çœè¿è¡Œæ˜‚è´µçš„è¶…å‚æ•°ä¼˜åŒ–çš„æ—¶é—´å’Œèµ„æºï¼Œå› æ­¤å€¼å¾—è¿›ä¸€æ­¥æ¢ç´¢ã€‚</p><h3 id="Get-your-hands-dirty-with-sweeps"><a href="#Get-your-hands-dirty-with-sweeps" class="headerlink" title="Get your hands dirty with sweeps"></a>Get your hands dirty with sweeps</h3><p>æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„è®­ç»ƒè„šæœ¬å’Œä¸€äº› <a href="https://github.com/wandb/examples/tree/master/examples/keras/keras-cnn-fashion">sweep configs</a> é£æ ¼ä¾›æ‚¨ä½¿ç”¨ã€‚æˆ‘ä»¬å¼ºçƒˆå»ºè®®æ‚¨å°è¯•ä¸€ä¸‹ã€‚</p><p>è¯¥å­˜å‚¨åº“è¿˜æä¾›äº†ä¸€äº›ç¤ºä¾‹ï¼Œå¯å¸®åŠ©æ‚¨å°è¯•æ›´é«˜çº§çš„ sweep åŠŸèƒ½ï¼Œä¾‹å¦‚ <a href="https://app.wandb.ai/wandb/examples-keras-cnn-fashion/sweeps/us0ifmrf?workspace=user-lavanyashukla&amp;_gl=1*1h57q6p*_ga*MTUwMzMwNTA4NC4xNjg1MzI0NjI3*_ga_JH1SJHJQXJ*MTY4NjYyMjIyOS43LjAuMTY4NjYyMjIyOS42MC4wLjA.">Bayesian Hyperband</a> å’Œ <a href="https://app.wandb.ai/wandb/examples-keras-cnn-fashion/sweeps/xbs2wm5e?workspace=user-lavanyashukla&amp;_gl=1*5hk37j*_ga*MTUwMzMwNTA4NC4xNjg1MzI0NjI3*_ga_JH1SJHJQXJ*MTY4NjYyMjIyOS43LjAuMTY4NjYyMjIyOS42MC4wLjA.">Hyperopt</a>ã€‚</p><h2 id="Track-models-and-datasets"><a href="#Track-models-and-datasets" class="headerlink" title="Track models and datasets"></a>Track models and datasets</h2><p><a href="https://colab.research.google.com/github/wandb/examples/blob/master/colabs/wandb-artifacts/Pipeline_Versioning_with_W&amp;B_Artifacts.ipynb">åœ¨æ­¤å¤„è¯•ç”¨ Colab Notebook â†’</a></p><p>åœ¨æ­¤ç¬”è®°æœ¬ä¸­ï¼Œæˆ‘ä»¬å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ä½¿ç”¨ W&amp;B Artifacts è·Ÿè¸ªæ‚¨çš„ ML å®éªŒç®¡é“ã€‚</p><h4 id="Follow-along-with-a-video-tutorial-1"><a href="#Follow-along-with-a-video-tutorial-1" class="headerlink" title="Follow along with a video tutorial!"></a>Follow along with a <a href="http://tiny.cc/wb-artifacts-video">video tutorial</a>!</h4><h5 id="What-are-Artifacts-and-Why-Should-I-Care"><a href="#What-are-Artifacts-and-Why-Should-I-Care" class="headerlink" title="What are Artifacts and Why Should I Care?"></a>What are Artifacts and Why Should I Care?</h5><p>â€œartifactâ€ï¼Œå¦‚å¸Œè…ŠåŒè€³ç“¶ğŸºï¼Œæ˜¯ä¸€ä¸ªç”Ÿäº§çš„å¯¹è±¡â€”â€”ä¸€ä¸ªè¿‡ç¨‹çš„è¾“å‡ºã€‚åœ¨ ML ä¸­ï¼Œæœ€é‡è¦çš„å·¥ä»¶æ˜¯ <em>datasets</em> å’Œ <em>models</em>ã€‚</p><p>è€Œä¸”ï¼Œå°±åƒ <a href="https://indianajones.fandom.com/wiki/Cross_of_Coronado">Cross of Coronado</a> ä¸€æ ·ï¼Œè¿™äº›é‡è¦çš„æ–‡ç‰©å±äºåšç‰©é¦†ï¼ä¹Ÿå°±æ˜¯è¯´ï¼Œåº”è¯¥å¯¹å®ƒä»¬è¿›è¡Œåˆ†ç±»å’Œç»„ç»‡ï¼Œä»¥ä¾¿æ‚¨ã€æ‚¨çš„å›¢é˜Ÿå’Œæ•´ä¸ª ML ç¤¾åŒºå¯ä»¥å‘å®ƒä»¬å­¦ä¹ ã€‚æ¯•ç«Ÿï¼Œé‚£äº›ä¸è·Ÿè¸ªè®­ç»ƒçš„äººæ³¨å®šè¦é‡è¹ˆè¦†è¾™ã€‚</p><p>ä½¿ç”¨æˆ‘ä»¬çš„ Artifacts APIï¼Œæ‚¨å¯ä»¥å°† <code>Artifacts</code> è®°å½•ä¸º W&amp;B <code>Runs</code> çš„è¾“å‡ºï¼Œæˆ–ä½¿ç”¨ <code>Artifacts</code> ä½œä¸º <code>Runs</code> çš„è¾“å…¥ï¼Œå¦‚æ­¤å›¾æ‰€ç¤ºï¼Œå…¶ä¸­è®­ç»ƒè¿è¡Œæ¥å—æ•°æ®é›†å¹¶ç”Ÿæˆæ¨¡å‹ã€‚</p><p><img src="https://blog-img-1304093596.cos.ap-shanghai.myqcloud.com/undefinedsimple%20artifact%20diagram%202.png" alt="simple artifact diagram"></p><p>ç”±äºä¸€æ¬¡è¿è¡Œå¯ä»¥ä½¿ç”¨å¦ä¸€æ¬¡çš„è¾“å‡ºä½œä¸ºè¾“å…¥ï¼Œå› æ­¤ Artifacts å’Œ Runs ä¸€èµ·å½¢æˆäº†ä¸€ä¸ªæœ‰å‘å›¾â€”â€”å®é™…ä¸Šæ˜¯ä¸€ä¸ªäºŒåˆ† <a href="https://en.wikipedia.org/wiki/Directed_acyclic_graph">DAG</a>ï¼ â€“ å¸¦æœ‰ <code>Artifact</code>s å’Œ <code>Run</code>s çš„èŠ‚ç‚¹ï¼Œä»¥åŠå°† <code>Run</code>s è¿æ¥åˆ°å®ƒä»¬æ¶ˆè€—æˆ–ç”Ÿäº§çš„ <code>Artifact</code>s çš„ç®­å¤´ã€‚</p><h3 id="0ï¸âƒ£-Install-and-Import"><a href="#0ï¸âƒ£-Install-and-Import" class="headerlink" title="0ï¸âƒ£ Install and Import"></a>0ï¸âƒ£ Install and Import</h3><p>Artifacts æ˜¯æˆ‘ä»¬ Python åº“çš„ä¸€éƒ¨åˆ†ï¼Œä» <code>0.9.2</code> ç‰ˆå¼€å§‹ã€‚</p><p>ä¸ ML Python å †æ ˆçš„å¤§å¤šæ•°éƒ¨åˆ†ä¸€æ ·ï¼Œå®ƒå¯ä»¥é€šè¿‡ <code>pip</code> è·å¾—ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Compatible with wandb version 0.9.2+</span>!pip install wandb <span class="token operator">-</span>qqq!apt install tree</code></pre><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> os<span class="token keyword">import</span> wandb</code></pre><h3 id="1ï¸âƒ£-Log-a-Dataset"><a href="#1ï¸âƒ£-Log-a-Dataset" class="headerlink" title="1ï¸âƒ£ Log a Dataset"></a>1ï¸âƒ£ Log a Dataset</h3><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬å®šä¹‰ä¸€äº› Artifactsã€‚</p><p>æ­¤ç¤ºä¾‹åŸºäºæ­¤ PyTorch <a href="https://github.com/pytorch/examples/tree/master/mnist/">â€œBasic MNIST Exampleâ€</a>ï¼Œä½†å¯ä»¥åœ¨ <a href="http://wandb.me/artifacts-colab">TensorFlow</a>ã€ä»»ä½•å…¶ä»–æ¡†æ¶æˆ–çº¯ Python ä¸­è½»æ¾å®Œæˆã€‚</p><p>æˆ‘ä»¬ä» <code>Dataset</code>s å¼€å§‹ï¼š</p><ul><li>ä¸€ä¸ª <code>train</code>ing setï¼Œç”¨äºé€‰æ‹©å‚æ•°ï¼Œ</li><li>ä¸€ä¸ª <code>validation</code> setï¼Œç”¨äºé€‰æ‹©è¶…å‚æ•°ï¼Œ</li><li>ä¸€ä¸ª <code>test</code>ing setï¼Œç”¨äºè¯„ä¼°æœ€ç»ˆæ¨¡å‹</li></ul><p>ä¸‹é¢çš„ç¬¬ä¸€ä¸ªå•å…ƒæ ¼å®šä¹‰äº†è¿™ä¸‰ä¸ªæ•°æ®é›†ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> random <span class="token keyword">import</span> torch<span class="token keyword">import</span> torchvision<span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data <span class="token keyword">import</span> TensorDataset<span class="token keyword">from</span> tqdm<span class="token punctuation">.</span>auto <span class="token keyword">import</span> tqdm<span class="token comment" spellcheck="true"># Ensure deterministic behavior</span>torch<span class="token punctuation">.</span>backends<span class="token punctuation">.</span>cudnn<span class="token punctuation">.</span>deterministic <span class="token operator">=</span> <span class="token boolean">True</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>torch<span class="token punctuation">.</span>manual_seed<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>manual_seed_all<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># Device configuration</span>device <span class="token operator">=</span> torch<span class="token punctuation">.</span>device<span class="token punctuation">(</span><span class="token string">"cuda:0"</span> <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">"cpu"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># Data parameters</span>num_classes <span class="token operator">=</span> <span class="token number">10</span>input_shape <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># drop slow mirror from list of MNIST mirrors</span>torchvision<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>MNIST<span class="token punctuation">.</span>mirrors <span class="token operator">=</span> <span class="token punctuation">[</span>mirror <span class="token keyword">for</span> mirror <span class="token keyword">in</span> torchvision<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>MNIST<span class="token punctuation">.</span>mirrors                                      <span class="token keyword">if</span> <span class="token operator">not</span> mirror<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">"http://yann.lecun.com"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">load</span><span class="token punctuation">(</span>train_size<span class="token operator">=</span>50_000<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    # Load the data    """</span>    <span class="token comment" spellcheck="true"># the data, split between train and test sets</span>    train <span class="token operator">=</span> torchvision<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>MNIST<span class="token punctuation">(</span><span class="token string">"./"</span><span class="token punctuation">,</span> train<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> download<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    test <span class="token operator">=</span> torchvision<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>MNIST<span class="token punctuation">(</span><span class="token string">"./"</span><span class="token punctuation">,</span> train<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> download<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    <span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>train<span class="token punctuation">.</span>data<span class="token punctuation">,</span> train<span class="token punctuation">.</span>targets<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>test<span class="token punctuation">.</span>data<span class="token punctuation">,</span> test<span class="token punctuation">.</span>targets<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># split off a validation set for hyperparameter tuning</span>    x_train<span class="token punctuation">,</span> x_val <span class="token operator">=</span> x_train<span class="token punctuation">[</span><span class="token punctuation">:</span>train_size<span class="token punctuation">]</span><span class="token punctuation">,</span> x_train<span class="token punctuation">[</span>train_size<span class="token punctuation">:</span><span class="token punctuation">]</span>    y_train<span class="token punctuation">,</span> y_val <span class="token operator">=</span> y_train<span class="token punctuation">[</span><span class="token punctuation">:</span>train_size<span class="token punctuation">]</span><span class="token punctuation">,</span> y_train<span class="token punctuation">[</span>train_size<span class="token punctuation">:</span><span class="token punctuation">]</span>    training_set <span class="token operator">=</span> TensorDataset<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>    validation_set <span class="token operator">=</span> TensorDataset<span class="token punctuation">(</span>x_val<span class="token punctuation">,</span> y_val<span class="token punctuation">)</span>    test_set <span class="token operator">=</span> TensorDataset<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span>    datasets <span class="token operator">=</span> <span class="token punctuation">[</span>training_set<span class="token punctuation">,</span> validation_set<span class="token punctuation">,</span> test_set<span class="token punctuation">]</span>    <span class="token keyword">return</span> datasets</code></pre><p>è¿™å»ºç«‹äº†ä¸€ä¸ªæ¨¡å¼ï¼Œæˆ‘ä»¬å°†åœ¨è¿™ä¸ªä¾‹å­ä¸­çœ‹åˆ°é‡å¤ï¼šå°†æ•°æ®è®°å½•ä¸ºå·¥ä»¶çš„ä»£ç åŒ…è£¹åœ¨ç”Ÿæˆè¯¥æ•°æ®çš„ä»£ç å‘¨å›´ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”¨äº <code>load</code>ing æ•°æ®çš„ä»£ç ä¸ç”¨äº <code>load_and_log</code>ging æ•°æ®çš„ä»£ç åˆ†å¼€ã€‚</p><p>è¿™æ˜¯å¾ˆå¥½çš„åšæ³•ï¼</p><p>ä¸ºäº†å°†è¿™äº›æ•°æ®é›†è®°å½•ä¸ºå·¥ä»¶ï¼Œæˆ‘ä»¬åªéœ€è¦</p><ol><li>ä½¿ç”¨ <code>wandb.init</code> åˆ›å»º <code>Run</code>ï¼Œ(L4)</li><li>ä¸ºæ•°æ®é›† (L10) åˆ›å»ºä¸€ä¸ª <code>Artifact</code>ï¼Œä»¥åŠ</li><li>ä¿å­˜å¹¶è®°å½•ç›¸å…³ <code>file</code>sï¼ˆL20ã€L23ï¼‰ã€‚</li></ol><p>æŸ¥çœ‹ä¸‹é¢ä»£ç å•å…ƒçš„ç¤ºä¾‹ï¼Œç„¶åå±•å¼€åé¢çš„éƒ¨åˆ†ä»¥äº†è§£æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">load_and_log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># ğŸš€ start a run, with a type to label it and a project it can call home</span>    <span class="token keyword">with</span> wandb<span class="token punctuation">.</span>init<span class="token punctuation">(</span>project<span class="token operator">=</span><span class="token string">"artifacts-example"</span><span class="token punctuation">,</span> job_type<span class="token operator">=</span><span class="token string">"load-data"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> run<span class="token punctuation">:</span>                datasets <span class="token operator">=</span> load<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># separate code for loading the datasets</span>        names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"training"</span><span class="token punctuation">,</span> <span class="token string">"validation"</span><span class="token punctuation">,</span> <span class="token string">"test"</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># ğŸº create our Artifact</span>        raw_data <span class="token operator">=</span> wandb<span class="token punctuation">.</span>Artifact<span class="token punctuation">(</span>            <span class="token string">"mnist-raw"</span><span class="token punctuation">,</span> type<span class="token operator">=</span><span class="token string">"dataset"</span><span class="token punctuation">,</span>            description<span class="token operator">=</span><span class="token string">"Raw MNIST dataset, split into train/val/test"</span><span class="token punctuation">,</span>            metadata<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"source"</span><span class="token punctuation">:</span> <span class="token string">"torchvision.datasets.MNIST"</span><span class="token punctuation">,</span>                      <span class="token string">"sizes"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>len<span class="token punctuation">(</span>dataset<span class="token punctuation">)</span> <span class="token keyword">for</span> dataset <span class="token keyword">in</span> datasets<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> name<span class="token punctuation">,</span> data <span class="token keyword">in</span> zip<span class="token punctuation">(</span>names<span class="token punctuation">,</span> datasets<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment" spellcheck="true"># ğŸ£ Store a new file in the artifact, and write something into its contents.</span>            <span class="token keyword">with</span> raw_data<span class="token punctuation">.</span>new_file<span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">".pt"</span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> file<span class="token punctuation">:</span>                x<span class="token punctuation">,</span> y <span class="token operator">=</span> data<span class="token punctuation">.</span>tensors                torch<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> file<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># âœï¸ Save the artifact to W&amp;B.</span>        run<span class="token punctuation">.</span>log_artifact<span class="token punctuation">(</span>raw_data<span class="token punctuation">)</span>load_and_log<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h4 id="ğŸš€-wandb-init"><a href="#ğŸš€-wandb-init" class="headerlink" title="ğŸš€ wandb.init"></a>ğŸš€ <code>wandb.init</code></h4><p>å½“æˆ‘ä»¬åˆ¶ä½œå°†è¦äº§ç”Ÿ <code>Artifact</code>s çš„ <code>Run</code>æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è¯´æ˜å®ƒå±äºå“ªä¸ª <code>project</code>ã€‚</p><p>æ ¹æ®æ‚¨çš„å·¥ä½œæµç¨‹ï¼Œé¡¹ç›®å¯èƒ½å¤§åˆ° <code>car-that-drives-itself</code>ï¼Œä¹Ÿå¯èƒ½å°åˆ° <code>iterative-architecture-experiment-117</code>ã€‚</p><p>Depending on your workflow, a project might be as big as <code>car-that-drives-itself</code> or as small as <code>iterative-architecture-experiment-117</code>.</p><blockquote><p>ğŸ‘è§„åˆ™ï¼šå¦‚æœå¯ä»¥ï¼Œè¯·å°†æ‰€æœ‰å…±äº« <code>Artifact</code>s çš„ <code>Run</code>s ä¿ç•™åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ã€‚è¿™ä½¿äº‹æƒ…å˜å¾—ç®€å•ï¼Œä½†ä¸è¦æ‹…å¿ƒ <code>Artifact</code>s å¯ä»¥è·¨é¡¹ç›®ç§»æ¤ï¼</p></blockquote><p>ä¸ºäº†å¸®åŠ©è·Ÿè¸ªæ‚¨å¯èƒ½è¿è¡Œçš„æ‰€æœ‰ä¸åŒç±»å‹çš„ä½œä¸šï¼Œåœ¨è¿›è¡Œ <code>Run</code>s æ—¶æä¾› <code>job_type</code> å¾ˆæœ‰ç”¨ã€‚è¿™å¯ä»¥ä½¿æ‚¨çš„ Artifacts å›¾è¡¨ä¿æŒæ•´æ´ã€‚</p><blockquote><p>ğŸ‘è§„åˆ™ï¼š<code>job_type</code> åº”è¯¥æ˜¯æè¿°æ€§çš„ï¼Œå¹¶ä¸”å¯¹åº”äºä½ çš„ç®¡é“çš„å•ä¸ªæ­¥éª¤ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°† <code>load</code>ing æ•°æ®ä¸ <code>preprocess</code>ing æ•°æ®åˆ†å¼€ã€‚</p></blockquote><h4 id="ğŸº-wandb-Artifact"><a href="#ğŸº-wandb-Artifact" class="headerlink" title="ğŸº wandb.Artifact"></a>ğŸº <code>wandb.Artifact</code></h4><p>è¦å°†æŸç‰©è®°å½•ä¸º <code>Artifact</code>ï¼Œæˆ‘ä»¬å¿…é¡»é¦–å…ˆåˆ›å»ºä¸€ä¸ª <code>Artifact</code> å¯¹è±¡ã€‚</p><p>æ¯ä¸ª <code>Artifact</code> éƒ½æœ‰ä¸€ä¸ª <code>name</code>â€”â€”è¿™æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°è®¾ç½®çš„åç§°ã€‚</p><blockquote><p>ğŸ‘çš„è§„åˆ™ï¼š<code>name</code> åº”è¯¥æ˜¯æè¿°æ€§çš„ï¼Œä½†æ˜“äºè®°å¿†å’Œè¾“å…¥â€”â€”æˆ‘ä»¬å–œæ¬¢ä½¿ç”¨è¿å­—ç¬¦åˆ†éš”çš„åç§°ï¼Œå¹¶ä¸ä»£ç ä¸­çš„å˜é‡åç›¸å¯¹åº”ã€‚</p></blockquote><p>å®ƒä¹Ÿæœ‰ä¸€ä¸ª <code>type</code>ã€‚å°±åƒ <code>Run</code>s çš„ <code>job_types</code> ä¸€æ ·ï¼Œå®ƒç”¨äºç»„ç»‡ <code>Run</code>s å’Œ <code>Artifact</code>s çš„å›¾è¡¨ã€‚</p><blockquote><p>ğŸ‘çš„è§„åˆ™ï¼š<code>type</code> åº”è¯¥ç®€å•ï¼šæ¯” <code>mnist-data-YYYYMMDD</code> æ›´åƒ <code>dataset</code> æˆ– <code>model</code>ã€‚</p></blockquote><p>æ‚¨è¿˜å¯ä»¥é™„åŠ  <code>description</code> å’Œä¸€äº› <code>metadata</code>ï¼Œä½œä¸ºå­—å…¸ã€‚<code>metadata</code> åªéœ€è¦å¯åºåˆ—åŒ–ä¸º JSONã€‚</p><blockquote><p>ğŸ‘è§„åˆ™ï¼š<code>metadata</code>åº”å°½å¯èƒ½å…·æœ‰æè¿°æ€§ã€‚</p></blockquote><h4 id="ğŸ£-artifact-new-file-and-âœï¸-run-log-artifact"><a href="#ğŸ£-artifact-new-file-and-âœï¸-run-log-artifact" class="headerlink" title="ğŸ£ artifact.new_file and âœï¸ run.log_artifact"></a>ğŸ£ <code>artifact.new_file</code> and âœï¸ <code>run.log_artifact</code></h4><p>ä¸€æ—¦æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª <code>Artifact</code> å¯¹è±¡ï¼Œæˆ‘ä»¬éœ€è¦å‘å®ƒæ·»åŠ æ–‡ä»¶ã€‚</p><p>æ‚¨æ²¡çœ‹é”™ï¼šå¸¦æœ‰ s çš„ <em>files</em>ã€‚<code>Artifact</code>s çš„ç»“æ„ç±»ä¼¼äºç›®å½•ï¼ŒåŒ…å«æ–‡ä»¶å’Œå­ç›®å½•ã€‚</p><blockquote><p>ğŸ‘è§„åˆ™ï¼šåªè¦æœ‰å¿…è¦ï¼Œå°† <code>Artifact</code> çš„å†…å®¹æ‹†åˆ†ä¸ºå¤šä¸ªæ–‡ä»¶ã€‚å¦‚æœéœ€è¦æ‰©å±•ï¼Œè¿™å°†æœ‰æ‰€å¸®åŠ©ï¼</p></blockquote><p>æˆ‘ä»¬ä½¿ç”¨ <code>new_file</code> æ–¹æ³•åŒæ—¶å†™å…¥æ–‡ä»¶å¹¶å°†å…¶é™„åŠ åˆ° <code>Artifact</code>ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ <code>add_file</code> æ–¹æ³•ï¼Œå®ƒå°†è¿™ä¸¤ä¸ªæ­¥éª¤åˆ†å¼€</p><p>æ·»åŠ å®Œæ‰€æœ‰æ–‡ä»¶åï¼Œæˆ‘ä»¬éœ€è¦å°† <code>log_artifact</code> æ·»åŠ åˆ° <a href="https://wandb.ai/?_gl=1*r07jdw*_ga*MTUwMzMwNTA4NC4xNjg1MzI0NjI3*_ga_JH1SJHJQXJ*MTY4NjY1MzgzNC45LjEuMTY4NjY1MzgzOS41NS4wLjA.">wandb.ai</a>ã€‚</p><p>æ‚¨ä¼šæ³¨æ„åˆ°ä¸€äº› URL å‡ºç°åœ¨è¾“å‡ºä¸­ï¼ŒåŒ…æ‹¬ä¸€ä¸ªç”¨äºè¿è¡Œé¡µé¢çš„ URLã€‚æ‚¨å¯ä»¥åœ¨æ­¤å¤„æŸ¥çœ‹ <code>Run</code> ç»“æœï¼ŒåŒ…æ‹¬å·²è®°å½•çš„ä»»ä½• <code>Artifact</code>sã€‚</p><p>æˆ‘ä»¬å°†åœ¨ä¸‹é¢çœ‹åˆ°ä¸€äº›ç¤ºä¾‹ï¼Œè¿™äº›ç¤ºä¾‹å¯ä»¥æ›´å¥½åœ°åˆ©ç”¨â€œè¿è¡Œâ€é¡µé¢çš„å…¶ä»–ç»„ä»¶ã€‚</p><h3 id="2ï¸âƒ£-Use-a-Logged-Dataset-Artifact"><a href="#2ï¸âƒ£-Use-a-Logged-Dataset-Artifact" class="headerlink" title="2ï¸âƒ£ Use a Logged Dataset Artifact"></a>2ï¸âƒ£ Use a Logged Dataset Artifact</h3><p>ä¸åšç‰©é¦†ä¸­çš„ artifacts ä¸åŒï¼ŒW&amp;B ä¸­çš„ <code>Artifact</code>s æ—¨åœ¨ä½¿ç”¨ï¼Œè€Œä¸ä»…ä»…æ˜¯å­˜å‚¨ã€‚</p><p>è®©æˆ‘ä»¬çœ‹çœ‹å®ƒæ˜¯ä»€ä¹ˆæ ·çš„ã€‚</p><p>ä¸‹é¢çš„å•å…ƒæ ¼å®šä¹‰äº†ä¸€ä¸ªç®¡é“æ­¥éª¤ï¼Œè¯¥æ­¥éª¤æ¥æ”¶åŸå§‹æ•°æ®é›†å¹¶ä½¿ç”¨å®ƒæ¥ç”Ÿæˆ <code>preprocess</code>ed  æ•°æ®é›†ï¼š<code>normalize</code>d å’Œæ­£ç¡®æ•´å½¢ã€‚</p><p>å†æ¬¡æ³¨æ„ï¼Œæˆ‘ä»¬ä»ä¸ <code>wandb</code> æ¥å£çš„ä»£ç ä¸­åˆ†ç¦»å‡ºäº†ä»£ç çš„ä¸»ä½“ï¼Œå³ <code>preprocess</code>ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">preprocess</span><span class="token punctuation">(</span>dataset<span class="token punctuation">,</span> normalize<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> expand_dims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    ## Prepare the data    """</span>    x<span class="token punctuation">,</span> y <span class="token operator">=</span> dataset<span class="token punctuation">.</span>tensors    <span class="token keyword">if</span> normalize<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># Scale images to the [0, 1] range</span>        x <span class="token operator">=</span> x<span class="token punctuation">.</span>type<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255</span>    <span class="token keyword">if</span> expand_dims<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># Make sure images have shape (1, 28, 28)</span>        x <span class="token operator">=</span> torch<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> TensorDataset<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span></code></pre><p>ç°åœ¨æ˜¯ä½¿ç”¨ <code>wandb.Artifact</code> æ—¥å¿—è®°å½•è¿™ä¸ª <code>preprocess</code> æ­¥éª¤çš„ä»£ç ã€‚</p><p>è¯·æ³¨æ„ï¼Œä¸‹é¢çš„ç¤ºä¾‹éƒ½ <code>use</code>s äº†ä¸€ä¸ªæ–°çš„ <code>Artifact</code>ï¼Œå¹¶å°†å…¶ <code>log</code>s ä¸‹æ¥ï¼Œè¿™ä¸ä¸Šä¸€æ­¥ç›¸åŒã€‚<code>Artifact</code>s æ—¢æ˜¯ <code>Run</code>s çš„è¾“å…¥åˆæ˜¯è¾“å‡ºï¼</p><p>æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªæ–°çš„ <code>job_type</code>ï¼Œ<code>preprocess-data</code>ï¼Œæ¥æ˜ç¡®è¿™æ˜¯ä¸€ä¸ªä¸åŒäºä¹‹å‰çš„ jobã€‚</p><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">preprocess_and_log</span><span class="token punctuation">(</span>steps<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> wandb<span class="token punctuation">.</span>init<span class="token punctuation">(</span>project<span class="token operator">=</span><span class="token string">"artifacts-example"</span><span class="token punctuation">,</span> job_type<span class="token operator">=</span><span class="token string">"preprocess-data"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> run<span class="token punctuation">:</span>        processed_data <span class="token operator">=</span> wandb<span class="token punctuation">.</span>Artifact<span class="token punctuation">(</span>            <span class="token string">"mnist-preprocess"</span><span class="token punctuation">,</span> type<span class="token operator">=</span><span class="token string">"dataset"</span><span class="token punctuation">,</span>            description<span class="token operator">=</span><span class="token string">"Preprocessed MNIST dataset"</span><span class="token punctuation">,</span>            metadata<span class="token operator">=</span>steps<span class="token punctuation">)</span>                 <span class="token comment" spellcheck="true"># âœ”ï¸ declare which artifact we'll be using</span>        raw_data_artifact <span class="token operator">=</span> run<span class="token punctuation">.</span>use_artifact<span class="token punctuation">(</span><span class="token string">'mnist-raw:latest'</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># ğŸ“¥ if need be, download the artifact</span>        raw_dataset <span class="token operator">=</span> raw_data_artifact<span class="token punctuation">.</span>download<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token keyword">for</span> split <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">"training"</span><span class="token punctuation">,</span> <span class="token string">"validation"</span><span class="token punctuation">,</span> <span class="token string">"test"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            raw_split <span class="token operator">=</span> read<span class="token punctuation">(</span>raw_dataset<span class="token punctuation">,</span> split<span class="token punctuation">)</span>            processed_dataset <span class="token operator">=</span> preprocess<span class="token punctuation">(</span>raw_split<span class="token punctuation">,</span> <span class="token operator">**</span>steps<span class="token punctuation">)</span>            <span class="token keyword">with</span> processed_data<span class="token punctuation">.</span>new_file<span class="token punctuation">(</span>split <span class="token operator">+</span> <span class="token string">".pt"</span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> file<span class="token punctuation">:</span>                x<span class="token punctuation">,</span> y <span class="token operator">=</span> processed_dataset<span class="token punctuation">.</span>tensors                torch<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> file<span class="token punctuation">)</span>        run<span class="token punctuation">.</span>log_artifact<span class="token punctuation">(</span>processed_data<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>data_dir<span class="token punctuation">,</span> split<span class="token punctuation">)</span><span class="token punctuation">:</span>    filename <span class="token operator">=</span> split <span class="token operator">+</span> <span class="token string">".pt"</span>    x<span class="token punctuation">,</span> y <span class="token operator">=</span> torch<span class="token punctuation">.</span>load<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>data_dir<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> TensorDataset<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span></code></pre><p>è¿™é‡Œè¦æ³¨æ„çš„ä¸€ä»¶äº‹æ˜¯é¢„å¤„ç†çš„ <code>steps</code> ä½œä¸º <code>metadata</code> ä¸ <code>preprocessed_data</code> ä¸€èµ·ä¿å­˜ã€‚</p><p>å¦‚æœæ‚¨æƒ³è®©æ‚¨çš„å®éªŒå¯é‡ç°ï¼Œæ•è·å¤§é‡å…ƒæ•°æ®æ˜¯ä¸ªå¥½ä¸»æ„ï¼</p><p>æ­¤å¤–ï¼Œå³ä½¿æˆ‘ä»¬çš„æ•°æ®é›†æ˜¯ â€œ<code>large artifact</code>â€œï¼Œ<code>download</code> æ­¥éª¤ä¹Ÿå¯ä»¥åœ¨ä¸åˆ°ä¸€ç§’çš„æ—¶é—´å†…å®Œæˆã€‚</p><p>å±•å¼€ä¸‹é¢çš„ markdown å•å…ƒæ ¼ä»¥äº†è§£è¯¦ç»†ä¿¡æ¯ã€‚</p><pre class=" language-python"><code class="language-python">steps <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"normalize"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span>         <span class="token string">"expand_dims"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">}</span>preprocess_and_log<span class="token punctuation">(</span>steps<span class="token punctuation">)</span></code></pre><h4 id="âœ”ï¸-run-use-artifact"><a href="#âœ”ï¸-run-use-artifact" class="headerlink" title="âœ”ï¸ run.use_artifact"></a>âœ”ï¸ <code>run.use_artifact</code></h4><p>è¿™äº›æ­¥éª¤æ¯”è¾ƒç®€å•ã€‚æ¶ˆè´¹è€…åªéœ€è¦çŸ¥é“ <code>Artifact</code> çš„<code>name</code>ï¼Œå†åŠ ä¸Š bit moreã€‚</p><p>â€œbit moreâ€ æ˜¯æ‚¨æƒ³è¦çš„ <code>Artifact</code> çš„ç‰¹å®šç‰ˆæœ¬çš„ <code>alias</code>ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæœ€åä¸Šä¼ çš„ç‰ˆæœ¬è¢«æ ‡è®°ä¸º<code>latest</code>ã€‚å¦åˆ™ï¼Œæ‚¨å¯ä»¥é€‰æ‹©å¸¦æœ‰ <code>v0</code>/<code>v1</code> ç­‰çš„æ—§ç‰ˆæœ¬ï¼Œæˆ–è€…æ‚¨å¯ä»¥æä¾›è‡ªå·±çš„åˆ«åï¼Œä¾‹å¦‚ <code>best</code> æˆ– <code>jit-script</code>ã€‚å°±åƒ <a href="https://hub.docker.com/">Docker Hub</a> æ ‡ç­¾ä¸€æ ·ï¼Œåˆ«åä¸åç§°ç”¨ <code>:</code> åˆ†éš”ï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³è¦çš„ <code>Artifact</code> æ˜¯ <code>mnist-raw:latest</code>ã€‚</p><blockquote><p>ğŸ‘è§„åˆ™ï¼šä¿æŒåˆ«åç®€çŸ­è€Œç”œç¾ã€‚å½“æ‚¨æƒ³è¦æ»¡è¶³æŸäº›å±æ€§çš„ <code>Artifact</code> æ—¶ï¼Œè¯·ä½¿ç”¨è‡ªå®šä¹‰ <code>alias</code>esï¼Œå¦‚ <code>latest</code> æˆ– <code>best</code></p></blockquote><h4 id="ğŸ“¥-artifact-download"><a href="#ğŸ“¥-artifact-download" class="headerlink" title="ğŸ“¥ artifact.download"></a>ğŸ“¥ <code>artifact.download</code></h4><p>ç°åœ¨ï¼Œæ‚¨å¯èƒ½æ­£åœ¨æ‹…å¿ƒ <code>download</code> è°ƒç”¨ã€‚å¦‚æœæˆ‘ä»¬å†ä¸‹è½½ä¸€ä»½ï¼Œå†…å­˜çš„è´Ÿæ‹…ä¼šä¸ä¼šåŠ å€ï¼Ÿ</p><p>åˆ«æ‹…å¿ƒï¼Œæœ‹å‹ã€‚åœ¨æˆ‘ä»¬å®é™…ä¸‹è½½ä»»ä½•ä¸œè¥¿ä¹‹å‰ï¼Œæˆ‘ä»¬ä¼šæ£€æŸ¥æœ¬åœ°æ˜¯å¦æœ‰æ­£ç¡®çš„ç‰ˆæœ¬ã€‚ä½¿ç”¨å’Œç‰ˆæœ¬æ§åˆ¶ <code>git</code> å’Œ <a href="https://en.wikipedia.org/wiki/Torrent_file">torrenting</a> ç›¸åŒçš„æŠ€æœ¯ï¼šhashingã€‚</p><p>éšç€ <code>Artifact</code>s çš„åˆ›å»ºå’Œè®°å½•ï¼Œå·¥ä½œç›®å½•ä¸­åä¸º <code>artifacts</code> çš„æ–‡ä»¶å¤¹å°†å¼€å§‹å¡«å……å­ç›®å½•ï¼Œæ¯ä¸ª <code>Artifact</code>ä¸€ä¸ªã€‚ä½¿ç”¨  <code>!tree artifacts</code> æ£€æŸ¥å…¶å†…å®¹ï¼š</p><pre class=" language-python"><code class="language-python">!tree artifacts</code></pre><h4 id="ğŸŒ-The-Artifacts-page-on-wandb-ai"><a href="#ğŸŒ-The-Artifacts-page-on-wandb-ai" class="headerlink" title="ğŸŒ The Artifacts page on wandb.ai"></a>ğŸŒ The Artifacts page on <a href="https://wandb.ai/">wandb.ai</a></h4><p>ç°åœ¨æˆ‘ä»¬å·²ç»è®°å½•å¹¶ä½¿ç”¨äº†ä¸€ä¸ª <code>Artifact</code>ï¼Œè®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹ Run é¡µé¢ä¸Šçš„ Artifacts é€‰é¡¹å¡ã€‚</p><p>ä»<code> wandb</code> è¾“å‡ºå¯¼èˆªåˆ°è¿è¡Œé¡µé¢ URLï¼Œç„¶åä»å·¦ä¾§è¾¹æ ä¸­é€‰æ‹©â€œå·¥ä»¶â€é€‰é¡¹å¡ï¼ˆå®ƒæ˜¯å¸¦æœ‰æ•°æ®åº“å›¾æ ‡çš„é€‰é¡¹å¡ï¼Œçœ‹èµ·æ¥åƒä¸‰ä¸ªå†°çƒå åœ¨ä¸€èµ·ï¼‰ã€‚</p><p>å•å‡» â€œInput Artifactsâ€ è¡¨æˆ– â€œOutput Artifactsâ€ è¡¨ä¸­çš„ä¸€è¡Œï¼Œç„¶åæŸ¥çœ‹é€‰é¡¹å¡ï¼ˆâ€Overviewâ€, â€œMetadataâ€ï¼‰ä»¥æŸ¥çœ‹è®°å½•çš„æœ‰å…³ <code>Artifact</code> çš„æ‰€æœ‰å†…å®¹ã€‚</p><p>æˆ‘ä»¬ç‰¹åˆ«å–œæ¬¢ â€œGraph Viewâ€ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒæ˜¾ç¤ºä¸€ä¸ªå›¾è¡¨ï¼Œå…¶ä¸­ <code>Artifact</code>s çš„ <code>type</code>s å’Œ <code>Run</code> çš„ <code>job_types</code> æ˜¯ä¸¤ç§ç±»å‹çš„èŠ‚ç‚¹ï¼Œç®­å¤´ä»£è¡¨æ¶ˆè´¹å’Œç”Ÿäº§ã€‚</p><h3 id="3ï¸âƒ£-Log-a-Model"><a href="#3ï¸âƒ£-Log-a-Model" class="headerlink" title="3ï¸âƒ£ Log a Model"></a>3ï¸âƒ£ Log a Model</h3><p>è¿™è¶³ä»¥äº†è§£ <code>Artifact</code>s çš„ API å¦‚ä½•å·¥ä½œï¼Œä½†è®©æˆ‘ä»¬æŒ‰ç…§è¿™ä¸ªç¤ºä¾‹ä¸€ç›´åˆ°ç®¡é“çš„æœ«å°¾ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥äº†è§£ <code>Artifact</code>s å¦‚ä½•æ”¹è¿›æ‚¨çš„ ML å·¥ä½œæµç¨‹ã€‚</p><p>è¿™é‡Œçš„ç¬¬ä¸€ä¸ªå•å…ƒæ ¼åœ¨ PyTorch ä¸­æ„å»ºäº†ä¸€ä¸ª DNN <code>model</code>â€”â€”ä¸€ä¸ªéå¸¸ç®€å•çš„ ConvNetã€‚</p><p>æˆ‘ä»¬å°†ä»åˆå§‹åŒ– <code>model</code> å¼€å§‹ï¼Œè€Œä¸æ˜¯è®­ç»ƒå®ƒã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥é‡å¤è®­ç»ƒï¼ŒåŒæ—¶ä¿æŒå…¶ä»–ä¸€åˆ‡ä¸å˜ã€‚</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> math <span class="token keyword">import</span> floor<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn<span class="token keyword">class</span> <span class="token class-name">ConvNet</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> hidden_layer_sizes<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                  kernel_sizes<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                  activation<span class="token operator">=</span><span class="token string">"ReLU"</span><span class="token punctuation">,</span>                  pool_sizes<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                  dropout<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                  num_classes<span class="token operator">=</span>num_classes<span class="token punctuation">,</span>                  input_shape<span class="token operator">=</span>input_shape<span class="token punctuation">)</span><span class="token punctuation">:</span>              super<span class="token punctuation">(</span>ConvNet<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>layer1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>              nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span>input_shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span>hidden_layer_sizes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span>kernel_sizes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>              getattr<span class="token punctuation">(</span>nn<span class="token punctuation">,</span> activation<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>              nn<span class="token punctuation">.</span>MaxPool2d<span class="token punctuation">(</span>kernel_size<span class="token operator">=</span>pool_sizes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">)</span>        self<span class="token punctuation">.</span>layer2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>              nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span>hidden_layer_sizes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span>hidden_layer_sizes<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span>kernel_sizes<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>              getattr<span class="token punctuation">(</span>nn<span class="token punctuation">,</span> activation<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>              nn<span class="token punctuation">.</span>MaxPool2d<span class="token punctuation">(</span>kernel_size<span class="token operator">=</span>pool_sizes<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">)</span>        self<span class="token punctuation">.</span>layer3 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>              nn<span class="token punctuation">.</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>              nn<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span>dropout<span class="token punctuation">)</span>        <span class="token punctuation">)</span>        fc_input_dims <span class="token operator">=</span> floor<span class="token punctuation">(</span><span class="token punctuation">(</span>input_shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> kernel_sizes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> pool_sizes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># layer 1 output size</span>        fc_input_dims <span class="token operator">=</span> floor<span class="token punctuation">(</span><span class="token punctuation">(</span>fc_input_dims <span class="token operator">-</span> kernel_sizes<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> pool_sizes<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># layer 2 output size</span>        fc_input_dims <span class="token operator">=</span> fc_input_dims<span class="token operator">*</span>fc_input_dims<span class="token operator">*</span>hidden_layer_sizes<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># layer 3 output size</span>        self<span class="token punctuation">.</span>fc <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>fc_input_dims<span class="token punctuation">,</span> num_classes<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>        x <span class="token operator">=</span> self<span class="token punctuation">.</span>layer1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        x <span class="token operator">=</span> self<span class="token punctuation">.</span>layer2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        x <span class="token operator">=</span> self<span class="token punctuation">.</span>layer3<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        x <span class="token operator">=</span> self<span class="token punctuation">.</span>fc<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token keyword">return</span> x</code></pre><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ W&amp;B æ¥è·Ÿè¸ªè¿è¡Œï¼Œå› æ­¤ä½¿ç”¨ <code>wandb.config</code> å¯¹è±¡æ¥å­˜å‚¨æ‰€æœ‰è¶…å‚æ•°ã€‚</p><p>è¯¥ <code>config</code> å¯¹è±¡çš„ <code>dict</code>ionary ç‰ˆæœ¬æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„ <code>metadata</code>ï¼Œæ‰€ä»¥ä¸€å®šè¦åŒ…å«å®ƒï¼</p><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">build_model_and_log</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> wandb<span class="token punctuation">.</span>init<span class="token punctuation">(</span>project<span class="token operator">=</span><span class="token string">"artifacts-example"</span><span class="token punctuation">,</span> job_type<span class="token operator">=</span><span class="token string">"initialize"</span><span class="token punctuation">,</span> config<span class="token operator">=</span>config<span class="token punctuation">)</span> <span class="token keyword">as</span> run<span class="token punctuation">:</span>        config <span class="token operator">=</span> wandb<span class="token punctuation">.</span>config                model <span class="token operator">=</span> ConvNet<span class="token punctuation">(</span><span class="token operator">**</span>config<span class="token punctuation">)</span>        model_artifact <span class="token operator">=</span> wandb<span class="token punctuation">.</span>Artifact<span class="token punctuation">(</span>            <span class="token string">"convnet"</span><span class="token punctuation">,</span> type<span class="token operator">=</span><span class="token string">"model"</span><span class="token punctuation">,</span>            description<span class="token operator">=</span><span class="token string">"Simple AlexNet style CNN"</span><span class="token punctuation">,</span>            metadata<span class="token operator">=</span>dict<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">)</span>        torch<span class="token punctuation">.</span>save<span class="token punctuation">(</span>model<span class="token punctuation">.</span>state_dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"initialized_model.pth"</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># â• another way to add a file to an Artifact</span>        model_artifact<span class="token punctuation">.</span>add_file<span class="token punctuation">(</span><span class="token string">"initialized_model.pth"</span><span class="token punctuation">)</span>        wandb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"initialized_model.pth"</span><span class="token punctuation">)</span>        run<span class="token punctuation">.</span>log_artifact<span class="token punctuation">(</span>model_artifact<span class="token punctuation">)</span>model_config <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"hidden_layer_sizes"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                <span class="token string">"kernel_sizes"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                <span class="token string">"activation"</span><span class="token punctuation">:</span> <span class="token string">"ReLU"</span><span class="token punctuation">,</span>                <span class="token string">"pool_sizes"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                <span class="token string">"dropout"</span><span class="token punctuation">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span>                <span class="token string">"num_classes"</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">}</span>build_model_and_log<span class="token punctuation">(</span>model_config<span class="token punctuation">)</span></code></pre><h4 id="â•-artifact-add-file"><a href="#â•-artifact-add-file" class="headerlink" title="â• artifact.add_file"></a>â• <code>artifact.add_file</code></h4><p>ä¸åœ¨æ•°æ®é›†æ—¥å¿—è®°å½•ç¤ºä¾‹ä¸­åŒæ—¶ç¼–å†™ <code>new_file</code> å¹¶å°†å…¶æ·»åŠ åˆ° <code>Artifact</code> ä¸åŒï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä¸€æ­¥å†™å…¥æ–‡ä»¶ï¼ˆæ­¤å¤„ä¸º <code>torch.save</code>ï¼‰ï¼Œç„¶ååœ¨å¦ä¸€æ­¥ä¸­å°†å®ƒä»¬ <code>add</code> åˆ° <code>Artifact</code>ã€‚</p><blockquote><p>ğŸ‘è§„åˆ™ï¼šå°½å¯èƒ½ä½¿ç”¨ <code>new_file</code>ï¼Œä»¥é˜²æ­¢é‡å¤ã€‚</p></blockquote><h3 id="4ï¸âƒ£-Use-a-Logged-Model-Artifact"><a href="#4ï¸âƒ£-Use-a-Logged-Model-Artifact" class="headerlink" title="4ï¸âƒ£ Use a Logged Model Artifact"></a>4ï¸âƒ£ Use a Logged Model Artifact</h3><p>å°±åƒæˆ‘ä»¬å¯ä»¥åœ¨ <code>dataset</code> ä¸Šè°ƒç”¨ <code>use_artifact</code> ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬çš„ <code>initialized_model</code> ä¸Šè°ƒç”¨å®ƒä»¥åœ¨å¦ä¸€ä¸ªè¿è¡Œä¸­ä½¿ç”¨å®ƒã€‚</p><p>è¿™ä¸€æ¬¡ï¼Œè®©æˆ‘ä»¬ <code>train</code> <code>model</code>ã€‚</p><p>æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹æˆ‘ä»¬å…³äº <a href="http://wandb.me/pytorch-colab">instrumenting W&amp;B with PyTorch</a> çš„ Colabã€‚</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional <span class="token keyword">as</span> F<span class="token keyword">def</span> <span class="token function">train</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> train_loader<span class="token punctuation">,</span> valid_loader<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">:</span>    optimizer <span class="token operator">=</span> getattr<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>optim<span class="token punctuation">,</span> config<span class="token punctuation">.</span>optimizer<span class="token punctuation">)</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    model<span class="token punctuation">.</span>train<span class="token punctuation">(</span><span class="token punctuation">)</span>    example_ct <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> epoch <span class="token keyword">in</span> range<span class="token punctuation">(</span>config<span class="token punctuation">.</span>epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> batch_idx<span class="token punctuation">,</span> <span class="token punctuation">(</span>data<span class="token punctuation">,</span> target<span class="token punctuation">)</span> <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>train_loader<span class="token punctuation">)</span><span class="token punctuation">:</span>            data<span class="token punctuation">,</span> target <span class="token operator">=</span> data<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">,</span> target<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>            optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>            output <span class="token operator">=</span> model<span class="token punctuation">(</span>data<span class="token punctuation">)</span>            loss <span class="token operator">=</span> F<span class="token punctuation">.</span>cross_entropy<span class="token punctuation">(</span>output<span class="token punctuation">,</span> target<span class="token punctuation">)</span>            loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>            optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>            example_ct <span class="token operator">+=</span> len<span class="token punctuation">(</span>data<span class="token punctuation">)</span>            <span class="token keyword">if</span> batch_idx <span class="token operator">%</span> config<span class="token punctuation">.</span>batch_log_interval <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Train Epoch: {} [{}/{} ({:.0%})]\tLoss: {:.6f}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>                    epoch<span class="token punctuation">,</span> batch_idx <span class="token operator">*</span> len<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>train_loader<span class="token punctuation">.</span>dataset<span class="token punctuation">)</span><span class="token punctuation">,</span>                    batch_idx <span class="token operator">/</span> len<span class="token punctuation">(</span>train_loader<span class="token punctuation">)</span><span class="token punctuation">,</span> loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                                train_log<span class="token punctuation">(</span>loss<span class="token punctuation">,</span> example_ct<span class="token punctuation">,</span> epoch<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># evaluate the model on the validation set at each epoch</span>        loss<span class="token punctuation">,</span> accuracy <span class="token operator">=</span> test<span class="token punctuation">(</span>model<span class="token punctuation">,</span> valid_loader<span class="token punctuation">)</span>          test_log<span class="token punctuation">(</span>loss<span class="token punctuation">,</span> accuracy<span class="token punctuation">,</span> example_ct<span class="token punctuation">,</span> epoch<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> test_loader<span class="token punctuation">)</span><span class="token punctuation">:</span>    model<span class="token punctuation">.</span>eval<span class="token punctuation">(</span><span class="token punctuation">)</span>    test_loss <span class="token operator">=</span> <span class="token number">0</span>    correct <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> data<span class="token punctuation">,</span> target <span class="token keyword">in</span> test_loader<span class="token punctuation">:</span>            data<span class="token punctuation">,</span> target <span class="token operator">=</span> data<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">,</span> target<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>            output <span class="token operator">=</span> model<span class="token punctuation">(</span>data<span class="token punctuation">)</span>            test_loss <span class="token operator">+=</span> F<span class="token punctuation">.</span>cross_entropy<span class="token punctuation">(</span>output<span class="token punctuation">,</span> target<span class="token punctuation">,</span> reduction<span class="token operator">=</span><span class="token string">'sum'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># sum up batch loss</span>            pred <span class="token operator">=</span> output<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> keepdim<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># get the index of the max log-probability</span>            correct <span class="token operator">+=</span> pred<span class="token punctuation">.</span>eq<span class="token punctuation">(</span>target<span class="token punctuation">.</span>view_as<span class="token punctuation">(</span>pred<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token punctuation">)</span>    test_loss <span class="token operator">/=</span> len<span class="token punctuation">(</span>test_loader<span class="token punctuation">.</span>dataset<span class="token punctuation">)</span>    accuracy <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">.</span> <span class="token operator">*</span> correct <span class="token operator">/</span> len<span class="token punctuation">(</span>test_loader<span class="token punctuation">.</span>dataset<span class="token punctuation">)</span>        <span class="token keyword">return</span> test_loss<span class="token punctuation">,</span> accuracy<span class="token keyword">def</span> <span class="token function">train_log</span><span class="token punctuation">(</span>loss<span class="token punctuation">,</span> example_ct<span class="token punctuation">,</span> epoch<span class="token punctuation">)</span><span class="token punctuation">:</span>    loss <span class="token operator">=</span> float<span class="token punctuation">(</span>loss<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># where the magic happens</span>    wandb<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"epoch"</span><span class="token punctuation">:</span> epoch<span class="token punctuation">,</span> <span class="token string">"train/loss"</span><span class="token punctuation">:</span> loss<span class="token punctuation">}</span><span class="token punctuation">,</span> step<span class="token operator">=</span>example_ct<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token string">"Loss after "</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>example_ct<span class="token punctuation">)</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> f<span class="token string">" examples: {loss:.3f}"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">test_log</span><span class="token punctuation">(</span>loss<span class="token punctuation">,</span> accuracy<span class="token punctuation">,</span> example_ct<span class="token punctuation">,</span> epoch<span class="token punctuation">)</span><span class="token punctuation">:</span>    loss <span class="token operator">=</span> float<span class="token punctuation">(</span>loss<span class="token punctuation">)</span>    accuracy <span class="token operator">=</span> float<span class="token punctuation">(</span>accuracy<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># where the magic happens</span>    wandb<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"epoch"</span><span class="token punctuation">:</span> epoch<span class="token punctuation">,</span> <span class="token string">"validation/loss"</span><span class="token punctuation">:</span> loss<span class="token punctuation">,</span> <span class="token string">"validation/accuracy"</span><span class="token punctuation">:</span> accuracy<span class="token punctuation">}</span><span class="token punctuation">,</span> step<span class="token operator">=</span>example_ct<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token string">"Loss/accuracy after "</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>example_ct<span class="token punctuation">)</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> f<span class="token string">" examples: {loss:.3f}/{accuracy:.3f}"</span><span class="token punctuation">)</span></code></pre><p>è¿™æ¬¡æˆ‘ä»¬å°†è¿è¡Œä¸¤ä¸ªç‹¬ç«‹çš„ <code>Artifact</code> ç”Ÿäº§ <code>Run</code>sã€‚</p><p>ä¸€æ—¦ç¬¬ä¸€ä¸ªå®Œæˆ <code>train</code>ing <code>model</code>ï¼Œç¬¬äºŒä¸ªå°†é€šè¿‡è¯„ä¼°å…¶åœ¨ <code>test_dataset</code> ä¸Šçš„æ€§èƒ½æ¥ä½¿ç”¨ <code>trained-model</code> <code>Artifact</code>ã€‚</p><p>æ­¤å¤–ï¼Œæˆ‘ä»¬å°†æå–ç½‘ç»œæœ€æ··ä¹±çš„ 32 ä¸ªç¤ºä¾‹â€”â€”åœ¨è¿™äº›ç¤ºä¾‹ä¸­ï¼Œ<code>categorical_crossentropy</code> æœ€é«˜ã€‚</p><p>è¿™æ˜¯è¯Šæ–­æ•°æ®é›†å’Œæ¨¡å‹é—®é¢˜çš„å¥½æ–¹æ³•ï¼</p><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">evaluate</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> test_loader<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    ## Evaluate the trained model    """</span>    loss<span class="token punctuation">,</span> accuracy <span class="token operator">=</span> test<span class="token punctuation">(</span>model<span class="token punctuation">,</span> test_loader<span class="token punctuation">)</span>    highest_losses<span class="token punctuation">,</span> hardest_examples<span class="token punctuation">,</span> true_labels<span class="token punctuation">,</span> predictions <span class="token operator">=</span> get_hardest_k_examples<span class="token punctuation">(</span>model<span class="token punctuation">,</span> test_loader<span class="token punctuation">.</span>dataset<span class="token punctuation">)</span>    <span class="token keyword">return</span> loss<span class="token punctuation">,</span> accuracy<span class="token punctuation">,</span> highest_losses<span class="token punctuation">,</span> hardest_examples<span class="token punctuation">,</span> true_labels<span class="token punctuation">,</span> predictions<span class="token keyword">def</span> <span class="token function">get_hardest_k_examples</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> testing_set<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    model<span class="token punctuation">.</span>eval<span class="token punctuation">(</span><span class="token punctuation">)</span>    loader <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>testing_set<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># get the losses and predictions for each item in the dataset</span>    losses <span class="token operator">=</span> None    predictions <span class="token operator">=</span> None    <span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> data<span class="token punctuation">,</span> target <span class="token keyword">in</span> loader<span class="token punctuation">:</span>            data<span class="token punctuation">,</span> target <span class="token operator">=</span> data<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">,</span> target<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>            output <span class="token operator">=</span> model<span class="token punctuation">(</span>data<span class="token punctuation">)</span>            loss <span class="token operator">=</span> F<span class="token punctuation">.</span>cross_entropy<span class="token punctuation">(</span>output<span class="token punctuation">,</span> target<span class="token punctuation">)</span>            pred <span class="token operator">=</span> output<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> keepdim<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>                        <span class="token keyword">if</span> losses <span class="token keyword">is</span> None<span class="token punctuation">:</span>                losses <span class="token operator">=</span> loss<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                predictions <span class="token operator">=</span> pred            <span class="token keyword">else</span><span class="token punctuation">:</span>                losses <span class="token operator">=</span> torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span><span class="token punctuation">(</span>losses<span class="token punctuation">,</span> loss<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>                predictions <span class="token operator">=</span> torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span><span class="token punctuation">(</span>predictions<span class="token punctuation">,</span> pred<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>    argsort_loss <span class="token operator">=</span> torch<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>losses<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    highest_k_losses <span class="token operator">=</span> losses<span class="token punctuation">[</span>argsort_loss<span class="token punctuation">[</span><span class="token operator">-</span>k<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">]</span>    hardest_k_examples <span class="token operator">=</span> testing_set<span class="token punctuation">[</span>argsort_loss<span class="token punctuation">[</span><span class="token operator">-</span>k<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    true_labels <span class="token operator">=</span> testing_set<span class="token punctuation">[</span>argsort_loss<span class="token punctuation">[</span><span class="token operator">-</span>k<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    predicted_labels <span class="token operator">=</span> predictions<span class="token punctuation">[</span>argsort_loss<span class="token punctuation">[</span><span class="token operator">-</span>k<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> highest_k_losses<span class="token punctuation">,</span> hardest_k_examples<span class="token punctuation">,</span> true_labels<span class="token punctuation">,</span> predicted_labels</code></pre><p>è¿™äº›æ—¥å¿—è®°å½•åŠŸèƒ½ä¸ä¼šæ·»åŠ ä»»ä½•æ–°çš„ <code>Artifact</code> åŠŸèƒ½ï¼Œå› æ­¤æˆ‘ä»¬ä¸ä¼šå¯¹å…¶è¿›è¡Œè¯„è®ºï¼šæˆ‘ä»¬åªæ˜¯åœ¨ä½¿ç”¨ã€ä¸‹è½½å’Œè®°å½• <code>Artifact</code>sã€‚</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data <span class="token keyword">import</span> DataLoader<span class="token keyword">def</span> <span class="token function">train_and_log</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> wandb<span class="token punctuation">.</span>init<span class="token punctuation">(</span>project<span class="token operator">=</span><span class="token string">"artifacts-example"</span><span class="token punctuation">,</span> job_type<span class="token operator">=</span><span class="token string">"train"</span><span class="token punctuation">,</span> config<span class="token operator">=</span>config<span class="token punctuation">)</span> <span class="token keyword">as</span> run<span class="token punctuation">:</span>        config <span class="token operator">=</span> wandb<span class="token punctuation">.</span>config        data <span class="token operator">=</span> run<span class="token punctuation">.</span>use_artifact<span class="token punctuation">(</span><span class="token string">'mnist-preprocess:latest'</span><span class="token punctuation">)</span>        data_dir <span class="token operator">=</span> data<span class="token punctuation">.</span>download<span class="token punctuation">(</span><span class="token punctuation">)</span>        training_dataset <span class="token operator">=</span>  read<span class="token punctuation">(</span>data_dir<span class="token punctuation">,</span> <span class="token string">"training"</span><span class="token punctuation">)</span>        validation_dataset <span class="token operator">=</span> read<span class="token punctuation">(</span>data_dir<span class="token punctuation">,</span> <span class="token string">"validation"</span><span class="token punctuation">)</span>        train_loader <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>training_dataset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span>config<span class="token punctuation">.</span>batch_size<span class="token punctuation">)</span>        validation_loader <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>validation_dataset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span>config<span class="token punctuation">.</span>batch_size<span class="token punctuation">)</span>                model_artifact <span class="token operator">=</span> run<span class="token punctuation">.</span>use_artifact<span class="token punctuation">(</span><span class="token string">"convnet:latest"</span><span class="token punctuation">)</span>        model_dir <span class="token operator">=</span> model_artifact<span class="token punctuation">.</span>download<span class="token punctuation">(</span><span class="token punctuation">)</span>        model_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>model_dir<span class="token punctuation">,</span> <span class="token string">"initialized_model.pth"</span><span class="token punctuation">)</span>        model_config <span class="token operator">=</span> model_artifact<span class="token punctuation">.</span>metadata        config<span class="token punctuation">.</span>update<span class="token punctuation">(</span>model_config<span class="token punctuation">)</span>        model <span class="token operator">=</span> ConvNet<span class="token punctuation">(</span><span class="token operator">**</span>model_config<span class="token punctuation">)</span>        model<span class="token punctuation">.</span>load_state_dict<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>load<span class="token punctuation">(</span>model_path<span class="token punctuation">)</span><span class="token punctuation">)</span>        model <span class="token operator">=</span> model<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>         train<span class="token punctuation">(</span>model<span class="token punctuation">,</span> train_loader<span class="token punctuation">,</span> validation_loader<span class="token punctuation">,</span> config<span class="token punctuation">)</span>        model_artifact <span class="token operator">=</span> wandb<span class="token punctuation">.</span>Artifact<span class="token punctuation">(</span>            <span class="token string">"trained-model"</span><span class="token punctuation">,</span> type<span class="token operator">=</span><span class="token string">"model"</span><span class="token punctuation">,</span>            description<span class="token operator">=</span><span class="token string">"Trained NN model"</span><span class="token punctuation">,</span>            metadata<span class="token operator">=</span>dict<span class="token punctuation">(</span>model_config<span class="token punctuation">)</span><span class="token punctuation">)</span>        torch<span class="token punctuation">.</span>save<span class="token punctuation">(</span>model<span class="token punctuation">.</span>state_dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"trained_model.pth"</span><span class="token punctuation">)</span>        model_artifact<span class="token punctuation">.</span>add_file<span class="token punctuation">(</span><span class="token string">"trained_model.pth"</span><span class="token punctuation">)</span>        wandb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"trained_model.pth"</span><span class="token punctuation">)</span>        run<span class="token punctuation">.</span>log_artifact<span class="token punctuation">(</span>model_artifact<span class="token punctuation">)</span>    <span class="token keyword">return</span> model    <span class="token keyword">def</span> <span class="token function">evaluate_and_log</span><span class="token punctuation">(</span>config<span class="token operator">=</span>None<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">with</span> wandb<span class="token punctuation">.</span>init<span class="token punctuation">(</span>project<span class="token operator">=</span><span class="token string">"artifacts-example"</span><span class="token punctuation">,</span> job_type<span class="token operator">=</span><span class="token string">"report"</span><span class="token punctuation">,</span> config<span class="token operator">=</span>config<span class="token punctuation">)</span> <span class="token keyword">as</span> run<span class="token punctuation">:</span>        data <span class="token operator">=</span> run<span class="token punctuation">.</span>use_artifact<span class="token punctuation">(</span><span class="token string">'mnist-preprocess:latest'</span><span class="token punctuation">)</span>        data_dir <span class="token operator">=</span> data<span class="token punctuation">.</span>download<span class="token punctuation">(</span><span class="token punctuation">)</span>        testing_set <span class="token operator">=</span> read<span class="token punctuation">(</span>data_dir<span class="token punctuation">,</span> <span class="token string">"test"</span><span class="token punctuation">)</span>        test_loader <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>testing_set<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>        model_artifact <span class="token operator">=</span> run<span class="token punctuation">.</span>use_artifact<span class="token punctuation">(</span><span class="token string">"trained-model:latest"</span><span class="token punctuation">)</span>        model_dir <span class="token operator">=</span> model_artifact<span class="token punctuation">.</span>download<span class="token punctuation">(</span><span class="token punctuation">)</span>        model_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>model_dir<span class="token punctuation">,</span> <span class="token string">"trained_model.pth"</span><span class="token punctuation">)</span>        model_config <span class="token operator">=</span> model_artifact<span class="token punctuation">.</span>metadata        model <span class="token operator">=</span> ConvNet<span class="token punctuation">(</span><span class="token operator">**</span>model_config<span class="token punctuation">)</span>        model<span class="token punctuation">.</span>load_state_dict<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>load<span class="token punctuation">(</span>model_path<span class="token punctuation">)</span><span class="token punctuation">)</span>        model<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>        loss<span class="token punctuation">,</span> accuracy<span class="token punctuation">,</span> highest_losses<span class="token punctuation">,</span> hardest_examples<span class="token punctuation">,</span> true_labels<span class="token punctuation">,</span> preds <span class="token operator">=</span> evaluate<span class="token punctuation">(</span>model<span class="token punctuation">,</span> test_loader<span class="token punctuation">)</span>        run<span class="token punctuation">.</span>summary<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"loss"</span><span class="token punctuation">:</span> loss<span class="token punctuation">,</span> <span class="token string">"accuracy"</span><span class="token punctuation">:</span> accuracy<span class="token punctuation">}</span><span class="token punctuation">)</span>        wandb<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"high-loss-examples"</span><span class="token punctuation">:</span>            <span class="token punctuation">[</span>wandb<span class="token punctuation">.</span>Image<span class="token punctuation">(</span>hard_example<span class="token punctuation">,</span> caption<span class="token operator">=</span>str<span class="token punctuation">(</span>int<span class="token punctuation">(</span>pred<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">","</span> <span class="token operator">+</span>  str<span class="token punctuation">(</span>int<span class="token punctuation">(</span>label<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>             <span class="token keyword">for</span> hard_example<span class="token punctuation">,</span> pred<span class="token punctuation">,</span> label <span class="token keyword">in</span> zip<span class="token punctuation">(</span>hardest_examples<span class="token punctuation">,</span> preds<span class="token punctuation">,</span> true_labels<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><pre class=" language-python"><code class="language-python">train_config <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"batch_size"</span><span class="token punctuation">:</span> <span class="token number">128</span><span class="token punctuation">,</span>                <span class="token string">"epochs"</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>                <span class="token string">"batch_log_interval"</span><span class="token punctuation">:</span> <span class="token number">25</span><span class="token punctuation">,</span>                <span class="token string">"optimizer"</span><span class="token punctuation">:</span> <span class="token string">"Adam"</span><span class="token punctuation">}</span>model <span class="token operator">=</span> train_and_log<span class="token punctuation">(</span>train_config<span class="token punctuation">)</span>evaluate_and_log<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h4 id="ğŸ”-The-Graph-View"><a href="#ğŸ”-The-Graph-View" class="headerlink" title="ğŸ” The Graph View"></a>ğŸ” The Graph View</h4><p>è¯·æ³¨æ„ï¼Œæˆ‘ä»¬æ›´æ”¹äº† <code>Artifact</code> çš„ <code>type</code>ï¼šè¿™äº› <code>Run</code>s ä½¿ç”¨çš„æ˜¯æ¨¡å‹ï¼Œè€Œä¸æ˜¯æ•°æ®é›†ã€‚åœ¨ Artifacts é¡µé¢çš„å›¾å½¢è§†å›¾ä¸­ï¼Œç”Ÿäº§æ¨¡å‹çš„ <code>Run</code>s å°†ä¸ç”Ÿæˆ <code>dataset</code>s çš„è¿è¡Œåˆ†å¼€ã€‚</p><p>å»çœ‹çœ‹å§ï¼å’Œä»¥å‰ä¸€æ ·ï¼Œæ‚¨éœ€è¦å‰å¾€ Run é¡µé¢ï¼Œä»å·¦ä¾§æ ä¸­é€‰æ‹© â€œArtifactsâ€ é€‰é¡¹å¡ï¼Œé€‰æ‹©ä¸€ä¸ª <code>Artifact</code>ï¼Œç„¶åå•å‡» â€œGraph Viewâ€ é€‰é¡¹å¡ã€‚</p><h4 id="ğŸ’£-Exploded-Graphs"><a href="#ğŸ’£-Exploded-Graphs" class="headerlink" title="ğŸ’£ Exploded Graphs"></a>ğŸ’£ Exploded Graphs</h4><p>æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°æ ‡æœ‰â€œçˆ†ç‚¸â€çš„æŒ‰é’®ã€‚ä¸è¦ç‚¹å‡»å®ƒï¼Œå› ä¸ºå®ƒä¼šåœ¨ W&amp;B æ€»éƒ¨æ‚¨ä¸èµ·çœ¼çš„ä½œè€…åŠå…¬æ¡Œä¸‹å¼•çˆ†ä¸€æšå°ç‚¸å¼¹ï¼</p><p>åªæ˜¯åœ¨å¼€ç©ç¬‘ã€‚å®ƒä»¥æ›´æ¸©å’Œçš„æ–¹å¼â€œåˆ†è§£â€å›¾è¡¨ï¼š<code>Artifact</code>s å’Œ <code>Run</code>s åœ¨å•ä¸ªå®ä¾‹çº§åˆ«è€Œä¸æ˜¯ç±»å‹çº§åˆ«åˆ†ç¦»ï¼šèŠ‚ç‚¹ä¸æ˜¯ <code>dataset</code> å’Œ <code>load-data</code>ï¼Œè€Œæ˜¯ <code>dataset:mnist-raw:v1</code> å’Œ <code>load-data:sunny-smoke-1</code>ï¼Œç­‰ç­‰ã€‚</p><p>è¿™æä¾›äº†å¯¹æ‚¨çš„ç®¡é“çš„å…¨é¢æ´å¯Ÿï¼Œè®°å½•çš„æŒ‡æ ‡ã€å…ƒæ•°æ®ç­‰éƒ½è§¦æ‰‹å¯åŠâ€”â€”æ‚¨ä»…å—é™äºæ‚¨é€‰æ‹©ä¸æˆ‘ä»¬ä¸€èµ·è®°å½•çš„å†…å®¹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> WandB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WandB </tag>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Github Pages + Hexo + Vercel ä¸ªäººåšå®¢æ­å»ºï¼ˆå››ï¼‰è‡ªå®šä¹‰åŸŸååŠç™¾åº¦è°·æ­Œæ”¶å½•</title>
      <link href="/2023/06/04/2023-0github-pages-ge-ren-bo-ke-da-jian-si-zi-ding-yi-yu-ming-ji-bai-du-gu-ge-shou-lu/"/>
      <url>/2023/06/04/2023-0github-pages-ge-ren-bo-ke-da-jian-si-zi-ding-yi-yu-ming-ji-bai-du-gu-ge-shou-lu/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> Blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Blog </tag>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Github Pages + Hexo + Vercel ä¸ªäººåšå®¢æ­å»ºï¼ˆäºŒï¼‰Matery ä¸»é¢˜</title>
      <link href="/2023/06/04/github-pages-ge-ren-bo-ke-da-jian-er-matery-zhu-ti/"/>
      <url>/2023/06/04/github-pages-ge-ren-bo-ke-da-jian-er-matery-zhu-ti/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h2><p>æœ¬ä¸»é¢˜<strong>æ¨èä½ ä½¿ç”¨ Hexo 5.0.0 åŠä»¥ä¸Šçš„ç‰ˆæœ¬</strong>ã€‚å¦‚æœï¼Œä½ å·²ç»æœ‰ä¸€ä¸ªè‡ªå·±çš„ <a href="https://hexo.io/zh-cn/">Hexo</a> åšå®¢äº†ï¼Œå»ºè®®ä½ å°† Hexo å‡çº§åˆ°æœ€æ–°ç¨³å®šçš„ç‰ˆæœ¬ã€‚</p><p>ç‚¹å‡» <a href="https://codeload.github.com/blinkfox/hexo-theme-matery/zip/master">è¿™é‡Œ</a> ä¸‹è½½ <code>master</code> åˆ†æ”¯çš„æœ€æ–°ç¨³å®šç‰ˆçš„ä»£ç ï¼Œè§£å‹ç¼©åï¼Œå°† <code>hexo-theme-matery</code> çš„æ–‡ä»¶å¤¹å¤åˆ¶åˆ°ä½  Hexo çš„ <code>themes</code> æ–‡ä»¶å¤¹ä¸­å³å¯ã€‚</p><p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥åœ¨ä½ çš„ <code>themes</code> æ–‡ä»¶å¤¹ä¸‹ä½¿ç”¨ <code>git clone</code> å‘½ä»¤æ¥ä¸‹è½½:</p><pre class=" language-bash"><code class="language-bash"><span class="token function">git</span> clone https://github.com/blinkfox/hexo-theme-matery.git</code></pre><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><h3 id="åˆ‡æ¢ä¸»é¢˜"><a href="#åˆ‡æ¢ä¸»é¢˜" class="headerlink" title="åˆ‡æ¢ä¸»é¢˜"></a>åˆ‡æ¢ä¸»é¢˜</h3><p>ä¿®æ”¹ Hexo æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code> çš„  <code>theme</code> çš„å€¼ï¼š<code>theme: hexo-theme-matery</code></p><h4 id="config-yml-æ–‡ä»¶çš„å…¶å®ƒä¿®æ”¹å»ºè®®"><a href="#config-yml-æ–‡ä»¶çš„å…¶å®ƒä¿®æ”¹å»ºè®®" class="headerlink" title="_config.yml æ–‡ä»¶çš„å…¶å®ƒä¿®æ”¹å»ºè®®:"></a><code>_config.yml</code> æ–‡ä»¶çš„å…¶å®ƒä¿®æ”¹å»ºè®®:</h4><ul><li>è¯·ä¿®æ”¹ <code>_config.yml</code> çš„ <code>url</code> çš„å€¼ä¸ºä½ çš„ç½‘ç«™ä¸» <code>URL</code>ï¼ˆå¦‚ï¼š<code>http://xxx.github.io</code>ï¼‰ã€‚</li><li>å»ºè®®ä¿®æ”¹ä¸¤ä¸ª <code>per_page</code> çš„åˆ†é¡µæ¡æ•°å€¼ä¸º <code>6</code> çš„å€æ•°ï¼Œå¦‚ï¼š<code>12</code>ã€<code>18</code> ç­‰ï¼Œè¿™æ ·æ–‡ç« åˆ—è¡¨åœ¨å„ä¸ªå±å¹•ä¸‹éƒ½èƒ½è¾ƒå¥½çš„æ˜¾ç¤ºã€‚</li><li>å¦‚æœä½ æ˜¯ä¸­æ–‡ç”¨æˆ·ï¼Œåˆ™å»ºè®®ä¿®æ”¹ <code>language</code> çš„å€¼ä¸º <code>zh-CN</code>ã€‚</li></ul><h3 id="æ–°å»ºåˆ†ç±»-categories-é¡µ"><a href="#æ–°å»ºåˆ†ç±»-categories-é¡µ" class="headerlink" title="æ–°å»ºåˆ†ç±» categories é¡µ"></a>æ–°å»ºåˆ†ç±» categories é¡µ</h3><p><code>categories</code> é¡µæ˜¯ç”¨æ¥å±•ç¤ºæ‰€æœ‰åˆ†ç±»çš„é¡µé¢ï¼Œå¦‚æœåœ¨ä½ çš„åšå®¢ <code>source</code> ç›®å½•ä¸‹è¿˜æ²¡æœ‰ <code>categories/index.md</code> æ–‡ä»¶ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦æ–°å»ºä¸€ä¸ªï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><pre class=" language-bash"><code class="language-bash">hexo new page <span class="token string">"categories"</span></code></pre><p>ç¼–è¾‘ä½ åˆšåˆšæ–°å»ºçš„é¡µé¢æ–‡ä»¶ <code>/source/categories/index.md</code>ï¼Œè‡³å°‘éœ€è¦ä»¥ä¸‹å†…å®¹ï¼š</p><pre class=" language-yaml"><code class="language-yaml"><span class="token punctuation">---</span><span class="token key atrule">title</span><span class="token punctuation">:</span> categories<span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2018-09-30 17:25:30</span><span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"categories"</span><span class="token key atrule">layout</span><span class="token punctuation">:</span> <span class="token string">"categories"</span><span class="token punctuation">---</span></code></pre><h3 id="æ–°å»ºæ ‡ç­¾-tags-é¡µ"><a href="#æ–°å»ºæ ‡ç­¾-tags-é¡µ" class="headerlink" title="æ–°å»ºæ ‡ç­¾ tags é¡µ"></a>æ–°å»ºæ ‡ç­¾ tags é¡µ</h3><p><code>tags</code> é¡µæ˜¯ç”¨æ¥å±•ç¤ºæ‰€æœ‰æ ‡ç­¾çš„é¡µé¢ï¼Œå¦‚æœåœ¨ä½ çš„åšå®¢ <code>source</code> ç›®å½•ä¸‹è¿˜æ²¡æœ‰ <code>tags/index.md</code> æ–‡ä»¶ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦æ–°å»ºä¸€ä¸ªï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><pre class=" language-bash"><code class="language-bash">hexo new page <span class="token string">"tags"</span></code></pre><p>ç¼–è¾‘ä½ åˆšåˆšæ–°å»ºçš„é¡µé¢æ–‡ä»¶ <code>/source/tags/index.md</code>ï¼Œè‡³å°‘éœ€è¦ä»¥ä¸‹å†…å®¹ï¼š</p><pre class=" language-yaml"><code class="language-yaml"><span class="token punctuation">---</span><span class="token key atrule">title</span><span class="token punctuation">:</span> tags<span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2018-09-30 18:23:38</span><span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"tags"</span><span class="token key atrule">layout</span><span class="token punctuation">:</span> <span class="token string">"tags"</span><span class="token punctuation">---</span></code></pre><h3 id="æ–°å»ºå…³äºæˆ‘-about-é¡µ"><a href="#æ–°å»ºå…³äºæˆ‘-about-é¡µ" class="headerlink" title="æ–°å»ºå…³äºæˆ‘ about é¡µ"></a>æ–°å»ºå…³äºæˆ‘ about é¡µ</h3><p><code>about</code> é¡µæ˜¯ç”¨æ¥å±•ç¤º<strong>å…³äºæˆ‘å’Œæˆ‘çš„åšå®¢</strong>ä¿¡æ¯çš„é¡µé¢ï¼Œå¦‚æœåœ¨ä½ çš„åšå®¢ <code>source</code> ç›®å½•ä¸‹è¿˜æ²¡æœ‰ <code>about/index.md</code> æ–‡ä»¶ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦æ–°å»ºä¸€ä¸ªï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><pre class=" language-bash"><code class="language-bash">hexo new page <span class="token string">"about"</span></code></pre><p>ç¼–è¾‘ä½ åˆšåˆšæ–°å»ºçš„é¡µé¢æ–‡ä»¶ <code>/source/about/index.md</code>ï¼Œè‡³å°‘éœ€è¦ä»¥ä¸‹å†…å®¹ï¼š</p><pre class=" language-yaml"><code class="language-yaml"><span class="token punctuation">---</span><span class="token key atrule">title</span><span class="token punctuation">:</span> about<span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2018-09-30 17:25:30</span><span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"about"</span><span class="token key atrule">layout</span><span class="token punctuation">:</span> <span class="token string">"about"</span><span class="token punctuation">---</span></code></pre><h3 id="æ–°å»ºç•™è¨€æ¿-contact-é¡µï¼ˆå¯é€‰çš„ï¼‰"><a href="#æ–°å»ºç•™è¨€æ¿-contact-é¡µï¼ˆå¯é€‰çš„ï¼‰" class="headerlink" title="æ–°å»ºç•™è¨€æ¿ contact é¡µï¼ˆå¯é€‰çš„ï¼‰"></a>æ–°å»ºç•™è¨€æ¿ contact é¡µï¼ˆå¯é€‰çš„ï¼‰</h3><p><code>contact</code> é¡µæ˜¯ç”¨æ¥å±•ç¤º<strong>ç•™è¨€æ¿</strong>ä¿¡æ¯çš„é¡µé¢ï¼Œå¦‚æœåœ¨ä½ çš„åšå®¢ <code>source</code> ç›®å½•ä¸‹è¿˜æ²¡æœ‰ <code>contact/index.md</code> æ–‡ä»¶ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦æ–°å»ºä¸€ä¸ªï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><pre class=" language-bash"><code class="language-bash">hexo new page <span class="token string">"contact"</span></code></pre><p>ç¼–è¾‘ä½ åˆšåˆšæ–°å»ºçš„é¡µé¢æ–‡ä»¶ <code>/source/contact/index.md</code>ï¼Œè‡³å°‘éœ€è¦ä»¥ä¸‹å†…å®¹ï¼š</p><pre class=" language-yaml"><code class="language-yaml"><span class="token punctuation">---</span><span class="token key atrule">title</span><span class="token punctuation">:</span> contact<span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2018-09-30 17:25:30</span><span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"contact"</span><span class="token key atrule">layout</span><span class="token punctuation">:</span> <span class="token string">"contact"</span><span class="token punctuation">---</span></code></pre><blockquote><p><strong>æ³¨</strong>ï¼šæœ¬ç•™è¨€æ¿åŠŸèƒ½ä¾èµ–äºç¬¬ä¸‰æ–¹è¯„è®ºç³»ç»Ÿï¼Œè¯·<strong>æ¿€æ´»</strong>ä½ çš„è¯„è®ºç³»ç»Ÿæ‰æœ‰æ•ˆæœã€‚å¹¶ä¸”åœ¨ä¸»é¢˜çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ï¼Œç¬¬ <code>19</code> è‡³ <code>21</code> è¡Œçš„â€œ<strong>èœå•</strong>â€é…ç½®ï¼Œå–æ¶ˆå…³äºç•™è¨€æ¿çš„æ³¨é‡Šå³å¯ã€‚</p></blockquote><h3 id="æ–°å»ºå‹æƒ…é“¾æ¥-friends-é¡µï¼ˆå¯é€‰çš„ï¼‰"><a href="#æ–°å»ºå‹æƒ…é“¾æ¥-friends-é¡µï¼ˆå¯é€‰çš„ï¼‰" class="headerlink" title="æ–°å»ºå‹æƒ…é“¾æ¥ friends é¡µï¼ˆå¯é€‰çš„ï¼‰"></a>æ–°å»ºå‹æƒ…é“¾æ¥ friends é¡µï¼ˆå¯é€‰çš„ï¼‰</h3><p><code>friends</code> é¡µæ˜¯ç”¨æ¥å±•ç¤º<strong>å‹æƒ…é“¾æ¥</strong>ä¿¡æ¯çš„é¡µé¢ï¼Œå¦‚æœåœ¨ä½ çš„åšå®¢ <code>source</code> ç›®å½•ä¸‹è¿˜æ²¡æœ‰ <code>friends/index.md</code> æ–‡ä»¶ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦æ–°å»ºä¸€ä¸ªï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><pre class=" language-bash"><code class="language-bash">hexo new page <span class="token string">"friends"</span></code></pre><p>ç¼–è¾‘ä½ åˆšåˆšæ–°å»ºçš„é¡µé¢æ–‡ä»¶ <code>/source/friends/index.md</code>ï¼Œè‡³å°‘éœ€è¦ä»¥ä¸‹å†…å®¹ï¼š</p><pre class=" language-yaml"><code class="language-yaml"><span class="token punctuation">---</span><span class="token key atrule">title</span><span class="token punctuation">:</span> friends<span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2018-12-12 21:25:30</span><span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"friends"</span><span class="token key atrule">layout</span><span class="token punctuation">:</span> <span class="token string">"friends"</span><span class="token punctuation">---</span></code></pre><p>åŒæ—¶ï¼Œåœ¨ä½ çš„åšå®¢ <code>source</code> ç›®å½•ä¸‹æ–°å»º <code>_data</code> ç›®å½•ï¼Œåœ¨ <code>_data</code> ç›®å½•ä¸­æ–°å»º <code>friends.json</code> æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre class=" language-json"><code class="language-json"><span class="token punctuation">[</span><span class="token punctuation">{</span>    <span class="token property">"avatar"</span><span class="token operator">:</span> <span class="token string">"http://image.luokangyuan.com/1_qq_27922023.jpg"</span><span class="token punctuation">,</span>    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"ç é…±"</span><span class="token punctuation">,</span>    <span class="token property">"introduction"</span><span class="token operator">:</span> <span class="token string">"æˆ‘ä¸æ˜¯å¤§ä½¬ï¼Œåªæ˜¯åœ¨è¿½å¯»å¤§ä½¬çš„è„šæ­¥"</span><span class="token punctuation">,</span>    <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"http://luokangyuan.com/"</span><span class="token punctuation">,</span>    <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"å‰å»å­¦ä¹ "</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>    <span class="token property">"avatar"</span><span class="token operator">:</span> <span class="token string">"http://image.luokangyuan.com/4027734.jpeg"</span><span class="token punctuation">,</span>    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"é—ªçƒä¹‹ç‹"</span><span class="token punctuation">,</span>    <span class="token property">"introduction"</span><span class="token operator">:</span> <span class="token string">"ç¼–ç¨‹ç•Œå¤§ä½¬ï¼ŒæŠ€æœ¯ç‰›ï¼Œäººè¿˜ç‰¹åˆ«å¥½ï¼Œä¸æ‡‚çš„éƒ½å¯ä»¥è¯·æ•™å¤§ä½¬"</span><span class="token punctuation">,</span>    <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"https://blinkfox.github.io/"</span><span class="token punctuation">,</span>    <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"å‰å»å­¦ä¹ "</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>    <span class="token property">"avatar"</span><span class="token operator">:</span> <span class="token string">"http://image.luokangyuan.com/avatar.jpg"</span><span class="token punctuation">,</span>    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"ja_rome"</span><span class="token punctuation">,</span>    <span class="token property">"introduction"</span><span class="token operator">:</span> <span class="token string">"å¹³å‡¡çš„è„šæ­¥ä¹Ÿå¯ä»¥èµ°å‡ºä¼Ÿå¤§çš„è¡Œç¨‹"</span><span class="token punctuation">,</span>    <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"https://me.csdn.net/jlh912008548"</span><span class="token punctuation">,</span>    <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"å‰å»å­¦ä¹ "</span><span class="token punctuation">}</span><span class="token punctuation">]</span></code></pre><h3 id="æ–°å»º-404-é¡µ"><a href="#æ–°å»º-404-é¡µ" class="headerlink" title="æ–°å»º 404 é¡µ"></a>æ–°å»º 404 é¡µ</h3><p>å¦‚æœåœ¨ä½ çš„åšå®¢ <code>source</code> ç›®å½•ä¸‹è¿˜æ²¡æœ‰ <code>404.md</code> æ–‡ä»¶ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦æ–°å»ºä¸€ä¸ªã€‚ç¼–è¾‘ä½ åˆšåˆšæ–°å»ºçš„é¡µé¢æ–‡ä»¶ <code>/source/404.md</code>ï¼Œè‡³å°‘éœ€è¦ä»¥ä¸‹å†…å®¹ï¼š</p><pre class=" language-yaml"><code class="language-yaml"><span class="token punctuation">---</span><span class="token key atrule">title</span><span class="token punctuation">:</span> <span class="token number">404</span><span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2018-09-30 17:25:30</span><span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"404"</span><span class="token key atrule">layout</span><span class="token punctuation">:</span> <span class="token string">"404"</span><span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">"Oopsï½ï¼Œæˆ‘å´©æºƒäº†ï¼æ‰¾ä¸åˆ°ä½ æƒ³è¦çš„é¡µé¢ :("</span><span class="token punctuation">---</span></code></pre><h3 id="èœå•å¯¼èˆªé…ç½®"><a href="#èœå•å¯¼èˆªé…ç½®" class="headerlink" title="èœå•å¯¼èˆªé…ç½®"></a>èœå•å¯¼èˆªé…ç½®</h3><h4 id="é…ç½®åŸºæœ¬èœå•å¯¼èˆªçš„åç§°ã€è·¯å¾„urlå’Œå›¾æ ‡icon"><a href="#é…ç½®åŸºæœ¬èœå•å¯¼èˆªçš„åç§°ã€è·¯å¾„urlå’Œå›¾æ ‡icon" class="headerlink" title="é…ç½®åŸºæœ¬èœå•å¯¼èˆªçš„åç§°ã€è·¯å¾„urlå’Œå›¾æ ‡icon."></a>é…ç½®åŸºæœ¬èœå•å¯¼èˆªçš„åç§°ã€è·¯å¾„urlå’Œå›¾æ ‡icon.</h4><p>1.èœå•å¯¼èˆªåç§°å¯ä»¥æ˜¯ä¸­æ–‡ä¹Ÿå¯ä»¥æ˜¯è‹±æ–‡(å¦‚ï¼š<code>Index</code>æˆ–<code>ä¸»é¡µ</code>)<br>2.å›¾æ ‡icon å¯ä»¥åœ¨<a href="https://fontawesome.com/icons">Font Awesome</a> ä¸­æŸ¥æ‰¾   </p><pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">menu</span><span class="token punctuation">:</span>  <span class="token key atrule">Index</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>home  <span class="token key atrule">Tags</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /tags    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>tags  <span class="token key atrule">Categories</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /categories    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>bookmark  <span class="token key atrule">Archives</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /archives    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>archive  <span class="token key atrule">About</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /about    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>user<span class="token punctuation">-</span>circle  <span class="token key atrule">Friends</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /friends    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>address<span class="token punctuation">-</span>book</code></pre><h4 id="äºŒçº§èœå•é…ç½®æ–¹æ³•"><a href="#äºŒçº§èœå•é…ç½®æ–¹æ³•" class="headerlink" title="äºŒçº§èœå•é…ç½®æ–¹æ³•"></a>äºŒçº§èœå•é…ç½®æ–¹æ³•</h4><p>å¦‚æœä½ éœ€è¦äºŒçº§èœå•åˆ™å¯ä»¥åœ¨åŸåŸºæœ¬èœå•å¯¼èˆªçš„åŸºç¡€ä¸Šå¦‚ä¸‹æ“ä½œ</p><ol><li>åœ¨éœ€è¦æ·»åŠ äºŒçº§èœå•çš„ä¸€çº§èœå•ä¸‹æ·»åŠ <code>children</code>å…³é”®å­—(å¦‚:<code>About</code>èœå•ä¸‹æ·»åŠ <code>children</code>)     </li><li>åœ¨<code>children</code>ä¸‹åˆ›å»ºäºŒçº§èœå•çš„ åç§°name,è·¯å¾„urlå’Œå›¾æ ‡icon.      </li><li>æ³¨æ„æ¯ä¸ªäºŒçº§èœå•æ¨¡å—å‰è¦åŠ  <code>-</code>.     </li><li>æ³¨æ„ç¼©è¿›æ ¼å¼</li></ol><pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">menu</span><span class="token punctuation">:</span>  <span class="token key atrule">Index</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>home  <span class="token key atrule">Tags</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /tags    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>tags  <span class="token key atrule">Categories</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /categories    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>bookmark  <span class="token key atrule">Archives</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /archives    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>archive  <span class="token key atrule">About</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /about    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>user<span class="token punctuation">-</span>circle<span class="token punctuation">-</span>o  <span class="token key atrule">Friends</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /friends    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>address<span class="token punctuation">-</span>book  <span class="token key atrule">Medias</span><span class="token punctuation">:</span>    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>list    <span class="token key atrule">children</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Music        <span class="token key atrule">url</span><span class="token punctuation">:</span> /music        <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>music      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Movies        <span class="token key atrule">url</span><span class="token punctuation">:</span> /movies        <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>film      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Books        <span class="token key atrule">url</span><span class="token punctuation">:</span> /books        <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>book      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Galleries        <span class="token key atrule">url</span><span class="token punctuation">:</span> /galleries        <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>image</code></pre><h3 id="ä»£ç é«˜äº®"><a href="#ä»£ç é«˜äº®" class="headerlink" title="ä»£ç é«˜äº®"></a>ä»£ç é«˜äº®</h3><p>ä» Hexo5.0 ç‰ˆæœ¬å¼€å§‹è‡ªå¸¦äº† <code>prismjs</code> ä»£ç è¯­æ³•é«˜äº®çš„æ”¯æŒï¼Œæœ¬ä¸»é¢˜å¯¹æ­¤è¿›è¡Œäº†æ”¹é€ æ”¯æŒã€‚</p><p>å¦‚æœä½ çš„åšå®¢ä¸­æ›¾ç»å®‰è£…è¿‡ <code>hexo-prism-plugin</code> çš„æ’ä»¶ï¼Œé‚£ä¹ˆä½ é¡»è¦æ‰§è¡Œ <code>npm uninstall hexo-prism-plugin</code> æ¥å¸è½½æ‰å®ƒï¼Œå¦åˆ™ç”Ÿæˆçš„ä»£ç ä¸­ä¼šæœ‰ <code>&amp;#123;</code> å’Œ <code>&amp;#125;</code> çš„è½¬ä¹‰å­—ç¬¦ã€‚</p><p>ç„¶åï¼Œä¿®æ”¹ Hexo æ ¹ç›®å½•ä¸‹ <code>_config.yml</code> æ–‡ä»¶ä¸­ <code>highlight.enable</code> çš„å€¼ä¸º <code>false</code>ï¼Œå¹¶å°† <code>prismjs.enable</code> çš„å€¼è®¾ç½®ä¸º <code>true</code>ï¼Œä¸»è¦é…ç½®å¦‚ä¸‹ï¼š</p><pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">highlight</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>  <span class="token key atrule">line_number</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">auto_detect</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>  <span class="token key atrule">tab_replace</span><span class="token punctuation">:</span> <span class="token string">''</span>  <span class="token key atrule">wrap</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">hljs</span><span class="token punctuation">:</span> <span class="token boolean important">false</span><span class="token key atrule">prismjs</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">preprocess</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">line_number</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">tab_replace</span><span class="token punctuation">:</span> <span class="token string">''</span></code></pre><p>ä¸»é¢˜ä¸­é»˜è®¤çš„ <code>prismjs</code> ä¸»é¢˜æ˜¯ <code>Tomorrow Night</code>ï¼Œå¦‚æœä½ æƒ³å®šåˆ¶è‡ªå·±çš„ä¸»é¢˜ï¼Œå¯ä»¥å‰å¾€ <a href="https://prismjs.com/download.html">prismjs ä¸‹è½½é¡µé¢</a> å®šåˆ¶ä¸‹è½½è‡ªå·±å–œæ¬¢çš„ä¸»é¢˜ <code>css</code> æ–‡ä»¶ï¼Œç„¶åå°†æ­¤ css ä¸»é¢˜æ–‡ä»¶å–åä¸º <code>prism.css</code>ï¼Œæ›¿æ¢æ‰ <code>hexo-theme-matery</code> ä¸»é¢˜æ–‡ä»¶å¤¹ä¸­çš„ <code>source/libs/prism/prism.css</code> æ–‡ä»¶å³å¯ã€‚</p><h3 id="æœç´¢"><a href="#æœç´¢" class="headerlink" title="æœç´¢"></a>æœç´¢</h3><p>æœ¬ä¸»é¢˜ä¸­è¿˜ä½¿ç”¨åˆ°äº† <a href="https://github.com/wzpan/hexo-generator-search">hexo-generator-search</a> çš„ Hexo æ’ä»¶æ¥åšå†…å®¹æœç´¢ï¼Œå®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> hexo-generator-search --save</code></pre><p>åœ¨ Hexo æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ï¼Œæ–°å¢ä»¥ä¸‹çš„é…ç½®é¡¹ï¼š</p><pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">search</span><span class="token punctuation">:</span>  <span class="token key atrule">path</span><span class="token punctuation">:</span> search.xml  <span class="token key atrule">field</span><span class="token punctuation">:</span> post</code></pre><h3 id="ä¸­æ–‡é“¾æ¥è½¬æ‹¼éŸ³ï¼ˆå»ºè®®å®‰è£…ï¼‰"><a href="#ä¸­æ–‡é“¾æ¥è½¬æ‹¼éŸ³ï¼ˆå»ºè®®å®‰è£…ï¼‰" class="headerlink" title="ä¸­æ–‡é“¾æ¥è½¬æ‹¼éŸ³ï¼ˆå»ºè®®å®‰è£…ï¼‰"></a>ä¸­æ–‡é“¾æ¥è½¬æ‹¼éŸ³ï¼ˆå»ºè®®å®‰è£…ï¼‰</h3><p>å¦‚æœä½ çš„æ–‡ç« åç§°æ˜¯ä¸­æ–‡çš„ï¼Œé‚£ä¹ˆ Hexo é»˜è®¤ç”Ÿæˆçš„æ°¸ä¹…é“¾æ¥ä¹Ÿä¼šæœ‰ä¸­æ–‡ï¼Œè¿™æ ·ä¸åˆ©äº <code>SEO</code>ï¼Œä¸” <code>gitment</code> è¯„è®ºå¯¹ä¸­æ–‡é“¾æ¥ä¹Ÿä¸æ”¯æŒã€‚æˆ‘ä»¬å¯ä»¥ç”¨ <a href="https://github.com/viko16/hexo-permalink-pinyin">hexo-permalink-pinyin</a> Hexo æ’ä»¶ä½¿åœ¨ç”Ÿæˆæ–‡ç« æ—¶ç”Ÿæˆä¸­æ–‡æ‹¼éŸ³çš„æ°¸ä¹…é“¾æ¥ã€‚</p><p>å®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token function">npm</span> i hexo-permalink-pinyin --save</code></pre><p>åœ¨ Hexo æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ï¼Œæ–°å¢ä»¥ä¸‹çš„é…ç½®é¡¹ï¼š</p><pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">permalink_pinyin</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">separator</span><span class="token punctuation">:</span> <span class="token string">'-'</span> <span class="token comment" spellcheck="true"># default: '-'</span></code></pre><blockquote><p><strong>æ³¨</strong>ï¼šé™¤äº†æ­¤æ’ä»¶å¤–ï¼Œ<a href="https://github.com/rozbo/hexo-abbrlink">hexo-abbrlink</a> æ’ä»¶ä¹Ÿå¯ä»¥ç”Ÿæˆéä¸­æ–‡çš„é“¾æ¥ã€‚</p></blockquote><h3 id="æ–‡ç« å­—æ•°ç»Ÿè®¡æ’ä»¶ï¼ˆå»ºè®®å®‰è£…ï¼‰"><a href="#æ–‡ç« å­—æ•°ç»Ÿè®¡æ’ä»¶ï¼ˆå»ºè®®å®‰è£…ï¼‰" class="headerlink" title="æ–‡ç« å­—æ•°ç»Ÿè®¡æ’ä»¶ï¼ˆå»ºè®®å®‰è£…ï¼‰"></a>æ–‡ç« å­—æ•°ç»Ÿè®¡æ’ä»¶ï¼ˆå»ºè®®å®‰è£…ï¼‰</h3><p>å¦‚æœä½ æƒ³è¦åœ¨æ–‡ç« ä¸­æ˜¾ç¤ºæ–‡ç« å­—æ•°ã€é˜…è¯»æ—¶é•¿ä¿¡æ¯ï¼Œå¯ä»¥å®‰è£… <a href="https://github.com/willin/hexo-wordcount">hexo-wordcount</a>æ’ä»¶ã€‚</p><p>å®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token function">npm</span> i --save hexo-wordcount</code></pre><p>ç„¶ååªéœ€åœ¨æœ¬ä¸»é¢˜ä¸‹çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ï¼Œå°†å„ä¸ªæ–‡ç« å­—æ•°ç›¸å…³çš„é…ç½®æ¿€æ´»å³å¯ï¼š</p><pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">postInfo</span><span class="token punctuation">:</span>  <span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">update</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>  <span class="token key atrule">wordCount</span><span class="token punctuation">:</span> <span class="token boolean important">false </span><span class="token comment" spellcheck="true"># è®¾ç½®æ–‡ç« å­—æ•°ç»Ÿè®¡ä¸º true.</span>  <span class="token key atrule">totalCount</span><span class="token punctuation">:</span> <span class="token boolean important">false </span><span class="token comment" spellcheck="true"># è®¾ç½®ç«™ç‚¹æ–‡ç« æ€»å­—æ•°ç»Ÿè®¡ä¸º true.</span>  <span class="token key atrule">min2read</span><span class="token punctuation">:</span> <span class="token boolean important">false </span><span class="token comment" spellcheck="true"># é˜…è¯»æ—¶é•¿.</span>  <span class="token key atrule">readCount</span><span class="token punctuation">:</span> <span class="token boolean important">false </span><span class="token comment" spellcheck="true"># é˜…è¯»æ¬¡æ•°.</span></code></pre><h3 id="æ·»åŠ emojiè¡¨æƒ…æ”¯æŒï¼ˆå¯é€‰çš„ï¼‰"><a href="#æ·»åŠ emojiè¡¨æƒ…æ”¯æŒï¼ˆå¯é€‰çš„ï¼‰" class="headerlink" title="æ·»åŠ emojiè¡¨æƒ…æ”¯æŒï¼ˆå¯é€‰çš„ï¼‰"></a>æ·»åŠ emojiè¡¨æƒ…æ”¯æŒï¼ˆå¯é€‰çš„ï¼‰</h3><p>æœ¬ä¸»é¢˜æ–°å¢äº†å¯¹<code>emoji</code>è¡¨æƒ…çš„æ”¯æŒï¼Œä½¿ç”¨åˆ°äº† <a href="https://npm.taobao.org/package/hexo-filter-github-emojis">hexo-filter-github-emojis</a> çš„ Hexo æ’ä»¶æ¥æ”¯æŒ <code>emoji</code>è¡¨æƒ…çš„ç”Ÿæˆï¼ŒæŠŠå¯¹åº”çš„<code>markdown emoji</code>è¯­æ³•ï¼ˆ<code>::</code>,ä¾‹å¦‚ï¼š<code>:smile:</code>ï¼‰è½¬å˜æˆä¼šè·³è·ƒçš„<code>emoji</code>è¡¨æƒ…ï¼Œå®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> hexo-filter-github-emojis --save</code></pre><p>åœ¨ Hexo æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ï¼Œæ–°å¢ä»¥ä¸‹çš„é…ç½®é¡¹ï¼š</p><pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">githubEmojis</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">className</span><span class="token punctuation">:</span> github<span class="token punctuation">-</span>emoji  <span class="token key atrule">inject</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">styles</span><span class="token punctuation">:</span>  <span class="token key atrule">customEmojis</span><span class="token punctuation">:</span></code></pre><p>æ‰§è¡Œ <code>hexo clean &amp;&amp; hexo g</code> é‡æ–°ç”Ÿæˆåšå®¢æ–‡ä»¶ï¼Œç„¶åå°±å¯ä»¥åœ¨æ–‡ç« ä¸­å¯¹åº”ä½ç½®çœ‹åˆ°ä½ ç”¨<code>emoji</code>è¯­æ³•å†™çš„è¡¨æƒ…äº†ã€‚</p><h3 id="æ·»åŠ -RSS-è®¢é˜…æ”¯æŒï¼ˆå¯é€‰çš„ï¼‰"><a href="#æ·»åŠ -RSS-è®¢é˜…æ”¯æŒï¼ˆå¯é€‰çš„ï¼‰" class="headerlink" title="æ·»åŠ  RSS è®¢é˜…æ”¯æŒï¼ˆå¯é€‰çš„ï¼‰"></a>æ·»åŠ  RSS è®¢é˜…æ”¯æŒï¼ˆå¯é€‰çš„ï¼‰</h3><p>æœ¬ä¸»é¢˜ä¸­è¿˜ä½¿ç”¨åˆ°äº† <a href="https://github.com/hexojs/hexo-generator-feed">hexo-generator-feed</a> çš„ Hexo æ’ä»¶æ¥åš <code>RSS</code>ï¼Œå®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> hexo-generator-feed --save</code></pre><p>åœ¨ Hexo æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ï¼Œæ–°å¢ä»¥ä¸‹çš„é…ç½®é¡¹ï¼š</p><pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">feed</span><span class="token punctuation">:</span>  <span class="token key atrule">type</span><span class="token punctuation">:</span> atom  <span class="token key atrule">path</span><span class="token punctuation">:</span> atom.xml  <span class="token key atrule">limit</span><span class="token punctuation">:</span> <span class="token number">20</span>  <span class="token key atrule">hub</span><span class="token punctuation">:</span>  <span class="token key atrule">content</span><span class="token punctuation">:</span>  <span class="token key atrule">content_limit</span><span class="token punctuation">:</span> <span class="token number">140</span>  <span class="token key atrule">content_limit_delim</span><span class="token punctuation">:</span> <span class="token string">' '</span>  <span class="token key atrule">order_by</span><span class="token punctuation">:</span> <span class="token punctuation">-</span>date</code></pre><p>æ‰§è¡Œ <code>hexo clean &amp;&amp; hexo g</code> é‡æ–°ç”Ÿæˆåšå®¢æ–‡ä»¶ï¼Œç„¶ååœ¨ <code>public</code> æ–‡ä»¶å¤¹ä¸­å³å¯çœ‹åˆ° <code>atom.xml</code> æ–‡ä»¶ï¼Œè¯´æ˜ä½ å·²ç»å®‰è£…æˆåŠŸäº†ã€‚</p><h3 id="æ·»åŠ -DaoVoice-åœ¨çº¿èŠå¤©åŠŸèƒ½ï¼ˆå¯é€‰çš„ï¼‰"><a href="#æ·»åŠ -DaoVoice-åœ¨çº¿èŠå¤©åŠŸèƒ½ï¼ˆå¯é€‰çš„ï¼‰" class="headerlink" title="æ·»åŠ  DaoVoice åœ¨çº¿èŠå¤©åŠŸèƒ½ï¼ˆå¯é€‰çš„ï¼‰"></a>æ·»åŠ  <a href="http://www.daovoice.io/">DaoVoice</a> åœ¨çº¿èŠå¤©åŠŸèƒ½ï¼ˆå¯é€‰çš„ï¼‰</h3><p>å‰å¾€ <a href="http://www.daovoice.io/">DaoVoice</a> å®˜ç½‘æ³¨å†Œå¹¶ä¸”è·å– <code>app_id</code>ï¼Œå¹¶å°† <code>app_id</code> å¡«å…¥ä¸»é¢˜çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ã€‚</p><h3 id="æ·»åŠ -Tidio-åœ¨çº¿èŠå¤©åŠŸèƒ½ï¼ˆå¯é€‰çš„ï¼‰"><a href="#æ·»åŠ -Tidio-åœ¨çº¿èŠå¤©åŠŸèƒ½ï¼ˆå¯é€‰çš„ï¼‰" class="headerlink" title="æ·»åŠ  Tidio åœ¨çº¿èŠå¤©åŠŸèƒ½ï¼ˆå¯é€‰çš„ï¼‰"></a>æ·»åŠ  <a href="https://www.tidio.com/">Tidio</a> åœ¨çº¿èŠå¤©åŠŸèƒ½ï¼ˆå¯é€‰çš„ï¼‰</h3><p>å‰å¾€ <a href="https://www.tidio.com/">Tidio</a> å®˜ç½‘æ³¨å†Œå¹¶ä¸”è·å– <code>Public Key</code>ï¼Œå¹¶å°† <code>Public Key</code> å¡«å…¥ä¸»é¢˜çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ã€‚</p><h3 id="ä¿®æ”¹é¡µè„š"><a href="#ä¿®æ”¹é¡µè„š" class="headerlink" title="ä¿®æ”¹é¡µè„š"></a>ä¿®æ”¹é¡µè„š</h3><p>é¡µè„šä¿¡æ¯å¯èƒ½éœ€è¦åšå®šåˆ¶åŒ–ä¿®æ”¹ï¼Œè€Œä¸”å®ƒä¸ä¾¿äºåšæˆé…ç½®ä¿¡æ¯ï¼Œæ‰€ä»¥å¯èƒ½éœ€è¦ä½ è‡ªå·±å»å†ä¿®æ”¹å’ŒåŠ å·¥ã€‚ä¿®æ”¹çš„åœ°æ–¹åœ¨ä¸»é¢˜æ–‡ä»¶çš„ <code>/layout/_partial/footer.ejs</code> æ–‡ä»¶ä¸­ï¼ŒåŒ…æ‹¬ç«™ç‚¹ã€ä½¿ç”¨çš„ä¸»é¢˜ã€è®¿é—®é‡ç­‰ã€‚</p><h3 id="æ·»åŠ ä¸­æ–‡ç¹ç®€è½¬æ¢"><a href="#æ·»åŠ ä¸­æ–‡ç¹ç®€è½¬æ¢" class="headerlink" title="æ·»åŠ ä¸­æ–‡ç¹ç®€è½¬æ¢"></a>æ·»åŠ ä¸­æ–‡ç¹ç®€è½¬æ¢</h3><p>åœ¨ä¸»é¢˜çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ï¼Œå¼€å¯ translate ä¸º enableã€‚</p><blockquote><p>å¼€å¯ä¸­æ–‡ç¹ç®€è½¬æ¢å¦‚ä¸‹ä¿®æ”¹ã€‚é»˜è®¤ä¸å¼€å¯ã€‚<br>å®ä¾‹æ¼”ç¤ºï¼š <a href="https://blog.17lai.site/">ç¹ç®€è½¬æ¢</a> åº•ä¸‹ footer æ </p></blockquote><pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">translate</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></code></pre><h3 id="ä¿®æ”¹ç¤¾äº¤é“¾æ¥"><a href="#ä¿®æ”¹ç¤¾äº¤é“¾æ¥" class="headerlink" title="ä¿®æ”¹ç¤¾äº¤é“¾æ¥"></a>ä¿®æ”¹ç¤¾äº¤é“¾æ¥</h3><p>åœ¨ä¸»é¢˜çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ï¼Œé»˜è®¤æ”¯æŒ <code>QQ</code>ã€<code>GitHub</code> å’Œé‚®ç®±ç­‰çš„é…ç½®ï¼Œä½ å¯ä»¥åœ¨ä¸»é¢˜æ–‡ä»¶çš„ <code>/layout/_partial/social-link.ejs</code> æ–‡ä»¶ä¸­ï¼Œæ–°å¢ã€ä¿®æ”¹ä½ éœ€è¦çš„ç¤¾äº¤é“¾æ¥åœ°å€ï¼Œå¢åŠ é“¾æ¥å¯å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>%</span> <span class="token attr-name">if</span> <span class="token attr-name">(theme.socialLink.github)</span> <span class="token attr-name">{</span> <span class="token attr-name">%</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>&lt;%<span class="token punctuation">=</span> theme.socialLink.github %<span class="token punctuation">></span><span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tooltipped<span class="token punctuation">"</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>_blank<span class="token punctuation">"</span></span> <span class="token attr-name">data-tooltip</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>è®¿é—®æˆ‘çš„GitHub<span class="token punctuation">"</span></span> <span class="token attr-name">data-position</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>top<span class="token punctuation">"</span></span> <span class="token attr-name">data-delay</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fab fa-github<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>%</span> <span class="token attr-name">}</span> <span class="token attr-name">%</span><span class="token punctuation">></span></span></code></pre><p>å…¶ä¸­ï¼Œç¤¾äº¤å›¾æ ‡ï¼ˆå¦‚ï¼š<code>fa-github</code>ï¼‰ä½ å¯ä»¥åœ¨ <a href="https://fontawesome.com/icons">Font Awesome</a> ä¸­æœç´¢æ‰¾åˆ°ã€‚ä»¥ä¸‹æ˜¯å¸¸ç”¨ç¤¾äº¤å›¾æ ‡çš„æ ‡è¯†ï¼Œä¾›ä½ å‚è€ƒï¼š</p><ul><li>Facebook: <code>fab fa-facebook</code></li><li>Twitter: <code>fab fa-twitter</code></li><li>Google-plus: <code>fab fa-google-plus</code></li><li>Linkedin: <code>fab fa-linkedin</code></li><li>Tumblr: <code>fab fa-tumblr</code></li><li>Medium: <code>fab fa-medium</code></li><li>Slack: <code>fab fa-slack</code></li><li>Sina Weibo: <code>fab fa-weibo</code></li><li>Wechat: <code>fab fa-weixin</code></li><li>QQ: <code>fab fa-qq</code></li><li>Zhihu: <code>fab fa-zhihu</code></li></ul><blockquote><p><strong>æ³¨æ„</strong>: æœ¬ä¸»é¢˜ä¸­ä½¿ç”¨çš„ <code>Font Awesome</code> ç‰ˆæœ¬ä¸º <code>5.11.0</code>ã€‚</p></blockquote><h3 id="ä¿®æ”¹æ‰“èµçš„äºŒç»´ç å›¾ç‰‡"><a href="#ä¿®æ”¹æ‰“èµçš„äºŒç»´ç å›¾ç‰‡" class="headerlink" title="ä¿®æ”¹æ‰“èµçš„äºŒç»´ç å›¾ç‰‡"></a>ä¿®æ”¹æ‰“èµçš„äºŒç»´ç å›¾ç‰‡</h3><p>åœ¨ä¸»é¢˜æ–‡ä»¶çš„ <code>source/medias/reward</code> æ–‡ä»¶ä¸­ï¼Œä½ å¯ä»¥æ›¿æ¢æˆä½ çš„çš„å¾®ä¿¡å’Œæ”¯ä»˜å®çš„æ‰“èµäºŒç»´ç å›¾ç‰‡ã€‚</p><h3 id="é…ç½®éŸ³ä¹æ’­æ”¾å™¨ï¼ˆå¯é€‰çš„ï¼‰"><a href="#é…ç½®éŸ³ä¹æ’­æ”¾å™¨ï¼ˆå¯é€‰çš„ï¼‰" class="headerlink" title="é…ç½®éŸ³ä¹æ’­æ”¾å™¨ï¼ˆå¯é€‰çš„ï¼‰"></a>é…ç½®éŸ³ä¹æ’­æ”¾å™¨ï¼ˆå¯é€‰çš„ï¼‰</h3><p>è¦æ”¯æŒéŸ³ä¹æ’­æ”¾ï¼Œåœ¨ä¸»é¢˜çš„ <code>_config.yml</code> é…ç½®æ–‡ä»¶ä¸­æ¿€æ´»musicé…ç½®å³å¯ï¼š</p><pre class=" language-yaml"><code class="language-yaml"><span class="token comment" spellcheck="true"># æ˜¯å¦åœ¨é¦–é¡µæ˜¾ç¤ºéŸ³ä¹</span><span class="token key atrule">music</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">title</span><span class="token punctuation">:</span>         <span class="token comment" spellcheck="true"># éå¸åº•æ¨¡å¼æœ‰æ•ˆ</span>    <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>    <span class="token key atrule">show</span><span class="token punctuation">:</span> å¬å¬éŸ³ä¹  <span class="token key atrule">server</span><span class="token punctuation">:</span> netease   <span class="token comment" spellcheck="true"># require music platform: netease, tencent, kugou, xiami, baidu</span>  <span class="token key atrule">type</span><span class="token punctuation">:</span> playlist    <span class="token comment" spellcheck="true"># require song, playlist, album, search, artist</span>  <span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token number">503838841     </span><span class="token comment" spellcheck="true"># require song id / playlist id / album id / search keyword</span>  <span class="token key atrule">fixed</span><span class="token punctuation">:</span> <span class="token boolean important">false      </span><span class="token comment" spellcheck="true"># å¼€å¯å¸åº•æ¨¡å¼</span>  <span class="token key atrule">autoplay</span><span class="token punctuation">:</span> <span class="token boolean important">false   </span><span class="token comment" spellcheck="true"># æ˜¯å¦è‡ªåŠ¨æ’­æ”¾</span>  <span class="token key atrule">theme</span><span class="token punctuation">:</span> '<span class="token comment" spellcheck="true">#42b983'</span>  <span class="token key atrule">loop</span><span class="token punctuation">:</span> <span class="token string">'all'</span>       <span class="token comment" spellcheck="true"># éŸ³é¢‘å¾ªç¯æ’­æ”¾, å¯é€‰å€¼: 'all', 'one', 'none'</span>  <span class="token key atrule">order</span><span class="token punctuation">:</span> <span class="token string">'random'</span>   <span class="token comment" spellcheck="true"># éŸ³é¢‘å¾ªç¯é¡ºåº, å¯é€‰å€¼: 'list', 'random'</span>  <span class="token key atrule">preload</span><span class="token punctuation">:</span> <span class="token string">'auto'</span>   <span class="token comment" spellcheck="true"># é¢„åŠ è½½ï¼Œå¯é€‰å€¼: 'none', 'metadata', 'auto'</span>  <span class="token key atrule">volume</span><span class="token punctuation">:</span> <span class="token number">0.7       </span><span class="token comment" spellcheck="true"># é»˜è®¤éŸ³é‡ï¼Œè¯·æ³¨æ„æ’­æ”¾å™¨ä¼šè®°å¿†ç”¨æˆ·è®¾ç½®ï¼Œç”¨æˆ·æ‰‹åŠ¨è®¾ç½®éŸ³é‡åé»˜è®¤éŸ³é‡å³å¤±æ•ˆ</span>  <span class="token key atrule">listFolded</span><span class="token punctuation">:</span> <span class="token boolean important">true  </span><span class="token comment" spellcheck="true"># åˆ—è¡¨é»˜è®¤æŠ˜å </span></code></pre><blockquote><p><code>server</code>å¯é€‰<code>netease</code>ï¼ˆç½‘æ˜“äº‘éŸ³ä¹ï¼‰ï¼Œ<code>tencent</code>ï¼ˆQQéŸ³ä¹ï¼‰ï¼Œ<code>kugou</code>ï¼ˆé…·ç‹—éŸ³ä¹ï¼‰ï¼Œ<code>xiami</code>ï¼ˆè™¾ç±³éŸ³ä¹ï¼‰ï¼Œ</p><p><code>baidu</code>ï¼ˆç™¾åº¦éŸ³ä¹ï¼‰ã€‚</p><p><code>type</code>å¯é€‰<code>song</code>ï¼ˆæ­Œæ›²ï¼‰ï¼Œ<code>playlist</code>ï¼ˆæ­Œå•ï¼‰ï¼Œ<code>album</code>ï¼ˆä¸“è¾‘ï¼‰ï¼Œ<code>search</code>ï¼ˆæœç´¢å…³é”®å­—ï¼‰ï¼Œ<code>artist</code>ï¼ˆæ­Œæ‰‹ï¼‰</p><p><code>id</code>è·å–æ–¹æ³•ç¤ºä¾‹: æµè§ˆå™¨æ‰“å¼€ç½‘æ˜“äº‘éŸ³ä¹ï¼Œç‚¹å‡»æˆ‘å–œæ¬¢çš„éŸ³ä¹æ­Œå•ï¼Œæµè§ˆå™¨åœ°å€æ åé¢ä¼šæœ‰ä¸€ä¸²æ•°å­—ï¼Œ<code>playlist</code>çš„<code>id</code></p><p>å³ä¸ºè¿™ä¸²æ•°å­—ã€‚</p></blockquote><h3 id="æ·»åŠ note"><a href="#æ·»åŠ note" class="headerlink" title="æ·»åŠ note"></a>æ·»åŠ note</h3><blockquote><p><a href="https://blog.17lai.site/posts/cf0f47fd/#tag-note">æ¼”ç¤º</a></p></blockquote><h4 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h4><pre class=" language-html"><code class="language-html">{% note [class] [no-icon] [summary] %}Any content (support inline tags too).{% endnote %}</code></pre><ul><li><code>[class]</code> : <em>Optional parameter.</em> Supported values: default | primary | success | info | warning | danger.</li><li><code>[no-icon]</code> : <em>Optional parameter.</em> Disable icon in note.</li><li><code>[summary]</code> : <em>Optional parameter.</em> Optional summary of the note.</li></ul><p>All parameters are optional.</p><h4 id="example"><a href="#example" class="headerlink" title="example"></a>example</h4><pre class=" language-html"><code class="language-html">{% note %}#### Header(without define class style){% endnote %}</code></pre><h3 id="æ·»åŠ button"><a href="#æ·»åŠ button" class="headerlink" title="æ·»åŠ button"></a>æ·»åŠ button</h3><blockquote><p><a href="https://blog.17lai.site/posts/cf0f47fd/#tag-button">æ¼”ç¤º</a></p></blockquote><h4 id="Usage-1"><a href="#Usage-1" class="headerlink" title="Usage"></a>Usage</h4><pre class=" language-html"><code class="language-html">{% button url, text, icon [class], [title] %}</code></pre><p>or</p><pre class=" language-html"><code class="language-html">{% btn url, text, icon [class], [title] %}</code></pre><ul><li><code>url</code> : Absolute or relative path to URL.</li><li><code>text</code> : Button text. Required if no icon specified.</li><li><code>icon</code> : Font Awesome icon name. Required if no text specified.</li><li><code>[class]</code> : <em>Optional parameter.</em> Font Awesome class(es): <code>fa-fw</code> | <code>fa-lg</code> | <code>fa-2x</code> | <code>fa-3x</code> | <code>fa-4x</code> | <code>fa-5x</code></li><li><code>[title]</code> : <em>Optional parameter.</em> Tooltip at mouseover.</li></ul><h4 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h4><pre class=" language-html"><code class="language-html">{% button #, Text %}</code></pre><h2 id="æ–‡ç« -Front-matter-ä»‹ç»"><a href="#æ–‡ç« -Front-matter-ä»‹ç»" class="headerlink" title="æ–‡ç«  Front-matter ä»‹ç»"></a>æ–‡ç«  Front-matter ä»‹ç»</h2><h3 id="Front-matter-é€‰é¡¹è¯¦è§£"><a href="#Front-matter-é€‰é¡¹è¯¦è§£" class="headerlink" title="Front-matter é€‰é¡¹è¯¦è§£"></a>Front-matter é€‰é¡¹è¯¦è§£</h3><p><code>Front-matter</code> é€‰é¡¹ä¸­çš„æ‰€æœ‰å†…å®¹å‡ä¸º<strong>éå¿…å¡«</strong>çš„ã€‚ä½†æˆ‘ä»ç„¶å»ºè®®è‡³å°‘å¡«å†™ <code>title</code> å’Œ <code>date</code> çš„å€¼ã€‚</p><table><thead><tr><th>é…ç½®é€‰é¡¹</th><th>é»˜è®¤å€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>title</td><td><code>Markdown</code> çš„æ–‡ä»¶æ ‡é¢˜</td><td>æ–‡ç« æ ‡é¢˜ï¼Œå¼ºçƒˆå»ºè®®å¡«å†™æ­¤é€‰é¡¹</td></tr><tr><td>date</td><td>æ–‡ä»¶åˆ›å»ºæ—¶çš„æ—¥æœŸæ—¶é—´</td><td>å‘å¸ƒæ—¶é—´ï¼Œå¼ºçƒˆå»ºè®®å¡«å†™æ­¤é€‰é¡¹ï¼Œä¸”æœ€å¥½ä¿è¯å…¨å±€å”¯ä¸€</td></tr><tr><td>author</td><td>æ ¹ <code>_config.yml</code> ä¸­çš„ <code>author</code></td><td>æ–‡ç« ä½œè€…</td></tr><tr><td>img</td><td><code>featureImages</code> ä¸­çš„æŸä¸ªå€¼</td><td>æ–‡ç« ç‰¹å¾å›¾ï¼Œæ¨èä½¿ç”¨å›¾åºŠ(è…¾è®¯äº‘ã€ä¸ƒç‰›äº‘ã€åˆæ‹äº‘ç­‰)æ¥åšå›¾ç‰‡çš„è·¯å¾„.å¦‚: <code>http://xxx.com/xxx.jpg</code></td></tr><tr><td>top</td><td><code>true</code></td><td>æ¨èæ–‡ç« ï¼ˆæ–‡ç« æ˜¯å¦ç½®é¡¶ï¼‰ï¼Œå¦‚æœ <code>top</code> å€¼ä¸º <code>true</code>ï¼Œåˆ™ä¼šä½œä¸ºé¦–é¡µæ¨èæ–‡ç« </td></tr><tr><td>hide</td><td><code>false</code></td><td>éšè—æ–‡ç« ï¼Œå¦‚æœ<code>hide</code>å€¼ä¸º<code>true</code>ï¼Œåˆ™æ–‡ç« ä¸ä¼šåœ¨é¦–é¡µæ˜¾ç¤º</td></tr><tr><td>cover</td><td><code>false</code></td><td><code>v1.0.2</code>ç‰ˆæœ¬æ–°å¢ï¼Œè¡¨ç¤ºè¯¥æ–‡ç« æ˜¯å¦éœ€è¦åŠ å…¥åˆ°é¦–é¡µè½®æ’­å°é¢ä¸­</td></tr><tr><td>coverImg</td><td>æ— </td><td><code>v1.0.2</code>ç‰ˆæœ¬æ–°å¢ï¼Œè¡¨ç¤ºè¯¥æ–‡ç« åœ¨é¦–é¡µè½®æ’­å°é¢éœ€è¦æ˜¾ç¤ºçš„å›¾ç‰‡è·¯å¾„ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™é»˜è®¤ä½¿ç”¨æ–‡ç« çš„ç‰¹è‰²å›¾ç‰‡</td></tr><tr><td>password</td><td>æ— </td><td>æ–‡ç« é˜…è¯»å¯†ç ï¼Œå¦‚æœè¦å¯¹æ–‡ç« è®¾ç½®é˜…è¯»éªŒè¯å¯†ç çš„è¯ï¼Œå°±å¯ä»¥è®¾ç½® <code>password</code> çš„å€¼ï¼Œè¯¥å€¼å¿…é¡»æ˜¯ç”¨ <code>SHA256</code> åŠ å¯†åçš„å¯†ç ï¼Œé˜²æ­¢è¢«ä»–äººè¯†ç ´ã€‚å‰ææ˜¯åœ¨ä¸»é¢˜çš„ <code>config.yml</code> ä¸­æ¿€æ´»äº† <code>verifyPassword</code> é€‰é¡¹</td></tr><tr><td>toc</td><td><code>true</code></td><td>æ˜¯å¦å¼€å¯ TOCï¼Œå¯ä»¥é’ˆå¯¹æŸç¯‡æ–‡ç« å•ç‹¬å…³é—­ TOC çš„åŠŸèƒ½ã€‚å‰ææ˜¯åœ¨ä¸»é¢˜çš„ <code>config.yml</code> ä¸­æ¿€æ´»äº† <code>toc</code> é€‰é¡¹</td></tr><tr><td>mathjax</td><td><code>false</code></td><td>æ˜¯å¦å¼€å¯æ•°å­¦å…¬å¼æ”¯æŒ ï¼Œæœ¬æ–‡ç« æ˜¯å¦å¼€å¯ <code>mathjax</code>ï¼Œä¸”éœ€è¦åœ¨ä¸»é¢˜çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ä¹Ÿéœ€è¦å¼€å¯æ‰è¡Œ</td></tr><tr><td>summary</td><td>æ— </td><td>æ–‡ç« æ‘˜è¦ï¼Œè‡ªå®šä¹‰çš„æ–‡ç« æ‘˜è¦å†…å®¹ï¼Œå¦‚æœè¿™ä¸ªå±æ€§æœ‰å€¼ï¼Œæ–‡ç« å¡ç‰‡æ‘˜è¦å°±æ˜¾ç¤ºè¿™æ®µæ–‡å­—ï¼Œå¦åˆ™ç¨‹åºä¼šè‡ªåŠ¨æˆªå–æ–‡ç« çš„éƒ¨åˆ†å†…å®¹ä½œä¸ºæ‘˜è¦</td></tr><tr><td>categories</td><td>æ— </td><td>æ–‡ç« åˆ†ç±»ï¼Œæœ¬ä¸»é¢˜çš„åˆ†ç±»è¡¨ç¤ºå®è§‚ä¸Šå¤§çš„åˆ†ç±»ï¼Œåªå»ºè®®ä¸€ç¯‡æ–‡ç« ä¸€ä¸ªåˆ†ç±»</td></tr><tr><td>tags</td><td>æ— </td><td>æ–‡ç« æ ‡ç­¾ï¼Œä¸€ç¯‡æ–‡ç« å¯ä»¥å¤šä¸ªæ ‡ç­¾</td></tr><tr><td>keywords</td><td>æ–‡ç« æ ‡é¢˜</td><td>æ–‡ç« å…³é”®å­—ï¼ŒSEO æ—¶éœ€è¦</td></tr><tr><td>reprintPolicy</td><td>cc_by</td><td>æ–‡ç« è½¬è½½è§„åˆ™ï¼Œ å¯ä»¥æ˜¯ cc_by, cc_by_nd, cc_by_sa, cc_by_nc, cc_by_nc_nd, cc_by_nc_sa, cc0, noreprint æˆ– pay ä¸­çš„ä¸€ä¸ª</td></tr></tbody></table><blockquote><p><strong>æ³¨æ„</strong>:</p><ol><li>å¦‚æœ <code>img</code> å±æ€§ä¸å¡«å†™çš„è¯ï¼Œæ–‡ç« ç‰¹è‰²å›¾ä¼šæ ¹æ®æ–‡ç« æ ‡é¢˜çš„ <code>hashcode</code> çš„å€¼å–ä½™ï¼Œç„¶åé€‰å–ä¸»é¢˜ä¸­å¯¹åº”çš„ç‰¹è‰²å›¾ç‰‡ï¼Œä»è€Œè¾¾åˆ°è®©æ‰€æœ‰æ–‡ç« çš„ç‰¹è‰²å›¾<strong>å„æœ‰ç‰¹è‰²</strong>ã€‚</li><li><code>date</code> çš„å€¼å°½é‡ä¿è¯æ¯ç¯‡æ–‡ç« æ˜¯å”¯ä¸€çš„ï¼Œå› ä¸ºæœ¬ä¸»é¢˜ä¸­ <code>Gitalk</code> å’Œ <code>Gitment</code> è¯†åˆ« <code>id</code> æ˜¯é€šè¿‡ <code>date</code> çš„å€¼æ¥ä½œä¸ºå”¯ä¸€æ ‡è¯†çš„ã€‚</li><li>å¦‚æœè¦å¯¹æ–‡ç« è®¾ç½®é˜…è¯»éªŒè¯å¯†ç çš„åŠŸèƒ½ï¼Œä¸ä»…è¦åœ¨ Front-matter ä¸­è®¾ç½®é‡‡ç”¨äº† SHA256 åŠ å¯†çš„ password çš„å€¼ï¼Œè¿˜éœ€è¦åœ¨ä¸»é¢˜çš„ <code>_config.yml</code> ä¸­æ¿€æ´»äº†é…ç½®ã€‚æœ‰äº›åœ¨çº¿çš„ SHA256 åŠ å¯†çš„åœ°å€ï¼Œå¯ä¾›ä½ ä½¿ç”¨ï¼š<a href="http://tool.oschina.net/encrypt?type=2">å¼€æºä¸­å›½åœ¨çº¿å·¥å…·</a>ã€<a href="http://encode.chahuo.com/">chahuo</a>ã€<a href="http://tool.chinaz.com/tools/hash.aspx">ç«™é•¿å·¥å…·</a>ã€‚</li><li>æ‚¨å¯ä»¥åœ¨æ–‡ç« mdæ–‡ä»¶çš„ front-matter ä¸­æŒ‡å®š reprintPolicy æ¥ç»™å•ä¸ªæ–‡ç« é…ç½®è½¬è½½è§„åˆ™</li></ol></blockquote><p>ä»¥ä¸‹ä¸ºæ–‡ç« çš„ <code>Front-matter</code> ç¤ºä¾‹ã€‚</p><h3 id="æœ€ç®€ç¤ºä¾‹"><a href="#æœ€ç®€ç¤ºä¾‹" class="headerlink" title="æœ€ç®€ç¤ºä¾‹"></a>æœ€ç®€ç¤ºä¾‹</h3><pre class=" language-yaml"><code class="language-yaml"><span class="token punctuation">---</span><span class="token key atrule">title</span><span class="token punctuation">:</span> typora<span class="token punctuation">-</span>vue<span class="token punctuation">-</span>themeä¸»é¢˜ä»‹ç»<span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2018-09-07 09:25:00</span><span class="token punctuation">---</span></code></pre><h3 id="æœ€å…¨ç¤ºä¾‹"><a href="#æœ€å…¨ç¤ºä¾‹" class="headerlink" title="æœ€å…¨ç¤ºä¾‹"></a>æœ€å…¨ç¤ºä¾‹</h3><pre class=" language-yaml"><code class="language-yaml"><span class="token punctuation">---</span><span class="token key atrule">title</span><span class="token punctuation">:</span> typora<span class="token punctuation">-</span>vue<span class="token punctuation">-</span>themeä¸»é¢˜ä»‹ç»<span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2018-09-07 09:25:00</span><span class="token key atrule">author</span><span class="token punctuation">:</span> èµµå¥‡<span class="token key atrule">img</span><span class="token punctuation">:</span> /source/images/xxx.jpg<span class="token key atrule">top</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span class="token key atrule">hide</span><span class="token punctuation">:</span> <span class="token boolean important">false</span><span class="token key atrule">cover</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span class="token key atrule">coverImg</span><span class="token punctuation">:</span> /images/1.jpg<span class="token key atrule">password</span><span class="token punctuation">:</span> 8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92<span class="token key atrule">toc</span><span class="token punctuation">:</span> <span class="token boolean important">false</span><span class="token key atrule">mathjax</span><span class="token punctuation">:</span> <span class="token boolean important">false</span><span class="token key atrule">summary</span><span class="token punctuation">:</span> è¿™æ˜¯ä½ è‡ªå®šä¹‰çš„æ–‡ç« æ‘˜è¦å†…å®¹ï¼Œå¦‚æœè¿™ä¸ªå±æ€§æœ‰å€¼ï¼Œæ–‡ç« å¡ç‰‡æ‘˜è¦å°±æ˜¾ç¤ºè¿™æ®µæ–‡å­—ï¼Œå¦åˆ™ç¨‹åºä¼šè‡ªåŠ¨æˆªå–æ–‡ç« çš„éƒ¨åˆ†å†…å®¹ä½œä¸ºæ‘˜è¦<span class="token key atrule">categories</span><span class="token punctuation">:</span> Markdown<span class="token key atrule">tags</span><span class="token punctuation">:</span>  <span class="token punctuation">-</span> Typora  <span class="token punctuation">-</span> Markdown<span class="token punctuation">---</span></code></pre><h2 id="è‡ªå®šåˆ¶ä¿®æ”¹"><a href="#è‡ªå®šåˆ¶ä¿®æ”¹" class="headerlink" title="è‡ªå®šåˆ¶ä¿®æ”¹"></a>è‡ªå®šåˆ¶ä¿®æ”¹</h2><p>åœ¨æœ¬ä¸»é¢˜çš„ <code>_config.yml</code> ä¸­å¯ä»¥ä¿®æ”¹éƒ¨åˆ†è‡ªå®šä¹‰ä¿¡æ¯ï¼Œæœ‰ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p><ul><li>èœå•</li><li>æˆ‘çš„æ¢¦æƒ³</li><li>é¦–é¡µçš„éŸ³ä¹æ’­æ”¾å™¨å’Œè§†é¢‘æ’­æ”¾å™¨é…ç½®</li><li>æ˜¯å¦æ˜¾ç¤ºæ¨èæ–‡ç« åç§°å’ŒæŒ‰é’®é…ç½®</li><li><code>favicon</code> å’Œ <code>Logo</code></li><li>ä¸ªäººä¿¡æ¯</li><li>TOC ç›®å½•</li><li>æ–‡ç« æ‰“èµä¿¡æ¯</li><li>å¤åˆ¶æ–‡ç« å†…å®¹æ—¶è¿½åŠ ç‰ˆæƒä¿¡æ¯</li><li>MathJax</li><li>æ–‡ç« å­—æ•°ç»Ÿè®¡ã€é˜…è¯»æ—¶é•¿</li><li>ç‚¹å‡»é¡µé¢çš„â€™çˆ±å¿ƒâ€™æ•ˆæœ</li><li>æˆ‘çš„é¡¹ç›®</li><li>æˆ‘çš„æŠ€èƒ½</li><li>æˆ‘çš„ç›¸å†Œ</li><li><code>Gitalk</code>ã€<code>Gitment</code>ã€<code>Valine</code> å’Œ <code>disqus</code> è¯„è®ºé…ç½®</li><li><a href="http://busuanzi.ibruce.info/">ä¸è’œå­ç»Ÿè®¡</a>å’Œè°·æ­Œåˆ†æï¼ˆ<code>Google Analytics</code>ï¼‰</li><li>é»˜è®¤ç‰¹è‰²å›¾çš„é›†åˆã€‚å½“æ–‡ç« æ²¡æœ‰è®¾ç½®ç‰¹è‰²å›¾æ—¶ï¼Œæœ¬ä¸»é¢˜ä¼šæ ¹æ®æ–‡ç« æ ‡é¢˜çš„ <code>hashcode</code> å€¼å–ä½™ï¼Œæ¥é€‰æ‹©å±•ç¤ºå¯¹åº”çš„ç‰¹è‰²å›¾</li></ul><p><strong>æˆ‘è®¤ä¸ºä¸ªäººåšå®¢åº”è¯¥éƒ½æœ‰è‡ªå·±çš„é£æ ¼å’Œç‰¹è‰²</strong>ã€‚å¦‚æœæœ¬ä¸»é¢˜ä¸­çš„è¯¸å¤šåŠŸèƒ½å’Œä¸»é¢˜è‰²å½©ä½ ä¸æ»¡æ„ï¼Œå¯ä»¥åœ¨ä¸»é¢˜ä¸­è‡ªå®šä¹‰ä¿®æ”¹ï¼Œå¾ˆå¤šæ›´è‡ªç”±çš„åŠŸèƒ½å’Œç»†èŠ‚ç‚¹çš„ä¿®æ”¹éš¾ä»¥åœ¨ä¸»é¢˜çš„ <code>_config.yml</code> ä¸­å®Œæˆï¼Œéœ€è¦ä¿®æ”¹æºä»£ç æ‰æ¥å®Œæˆã€‚ä»¥ä¸‹åˆ—å‡ºäº†å¯èƒ½å¯¹ä½ æœ‰ç”¨çš„åœ°æ–¹ï¼š</p><h3 id="ä¿®æ”¹ä¸»é¢˜é¢œè‰²"><a href="#ä¿®æ”¹ä¸»é¢˜é¢œè‰²" class="headerlink" title="ä¿®æ”¹ä¸»é¢˜é¢œè‰²"></a>ä¿®æ”¹ä¸»é¢˜é¢œè‰²</h3><p>åœ¨ä¸»é¢˜æ–‡ä»¶çš„ <code>/source/css/matery.css</code> æ–‡ä»¶ä¸­ï¼Œæœç´¢ <code>.bg-color</code> æ¥ä¿®æ”¹èƒŒæ™¯é¢œè‰²ï¼š</p><pre class=" language-css"><code class="language-css"><span class="token comment" spellcheck="true">/* æ•´ä½“èƒŒæ™¯é¢œè‰²ï¼ŒåŒ…æ‹¬å¯¼èˆªã€ç§»åŠ¨ç«¯çš„å¯¼èˆªã€é¡µå°¾ã€æ ‡ç­¾é¡µç­‰çš„èƒŒæ™¯é¢œè‰². */</span><span class="token selector"><span class="token class">.bg-color</span> </span><span class="token punctuation">{</span>    <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token function">linear-gradient</span><span class="token punctuation">(</span>to right, <span class="token hexcode">#4cbf30</span> <span class="token number">0%</span>, <span class="token hexcode">#0f9d58</span> <span class="token number">100%</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token atrule"><span class="token rule">@-webkit-keyframes</span> rainbow</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck="true">/* åŠ¨æ€åˆ‡æ¢èƒŒæ™¯é¢œè‰². */</span><span class="token punctuation">}</span><span class="token atrule"><span class="token rule">@keyframes</span> rainbow</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">/* åŠ¨æ€åˆ‡æ¢èƒŒæ™¯é¢œè‰². */</span><span class="token punctuation">}</span></code></pre><h3 id="ä¿®æ”¹-banner-å›¾å’Œæ–‡ç« ç‰¹è‰²å›¾"><a href="#ä¿®æ”¹-banner-å›¾å’Œæ–‡ç« ç‰¹è‰²å›¾" class="headerlink" title="ä¿®æ”¹ banner å›¾å’Œæ–‡ç« ç‰¹è‰²å›¾"></a>ä¿®æ”¹ banner å›¾å’Œæ–‡ç« ç‰¹è‰²å›¾</h3><p>ä½ å¯ä»¥ç›´æ¥åœ¨ <code>/source/medias/banner</code> æ–‡ä»¶å¤¹ä¸­æ›´æ¢ä½ å–œæ¬¢çš„ <code>banner</code> å›¾ç‰‡ï¼Œä¸»é¢˜ä»£ç ä¸­æ˜¯æ¯å¤©åŠ¨æ€åˆ‡æ¢ä¸€å¼ ï¼Œåªéœ€ <code>7</code> å¼ å³å¯ã€‚å¦‚æœä½ ä¼š <code>JavaScript</code> ä»£ç ï¼Œå¯ä»¥ä¿®æ”¹æˆä½ è‡ªå·±å–œæ¬¢åˆ‡æ¢é€»è¾‘ï¼Œå¦‚ï¼šéšæœºåˆ‡æ¢ç­‰ï¼Œ<code>banner</code> åˆ‡æ¢çš„ä»£ç ä½ç½®åœ¨ <code>/layout/_partial/bg-cover-content.ejs</code> æ–‡ä»¶çš„ <code>&lt;script&gt;&lt;/script&gt;</code> ä»£ç ä¸­ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.bg-cover'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'background-image'</span><span class="token punctuation">,</span> <span class="token string">'url(/medias/banner/'</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.jpg)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>åœ¨ <code>/source/medias/featureimages</code> æ–‡ä»¶å¤¹ä¸­é»˜è®¤æœ‰ 24 å¼ ç‰¹è‰²å›¾ç‰‡ï¼Œä½ å¯ä»¥å†å¢åŠ æˆ–è€…å‡å°‘ï¼Œå¹¶éœ€è¦åœ¨ <code>_config.yml</code> åšåŒæ­¥ä¿®æ”¹ã€‚</p><p>å‚è€ƒ</p><p>[1] <a href="https://github.com/blinkfox/hexo-theme-matery/blob/develop/README_CN.md">hexo-theme-matery ä¸­æ–‡æ–‡æ¡£</a></p>]]></content>
      
      
      <categories>
          
          <category> Blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Blog </tag>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Github Pages + Hexo + Vercel ä¸ªäººåšå®¢æ­å»ºï¼ˆä¸‰ï¼‰Typora + PicGo+ è…¾è®¯äº‘å›¾åºŠ</title>
      <link href="/2023/06/04/github-pages-ge-ren-bo-ke-da-jian-san-typora-teng-xun-yun-tu-chuang/"/>
      <url>/2023/06/04/github-pages-ge-ren-bo-ke-da-jian-san-typora-teng-xun-yun-tu-chuang/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> Blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Blog </tag>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Latex å¤šè¡Œå…¬å¼ç­‰å·å¯¹é½</title>
      <link href="/2023/06/01/latex-duo-xing-gong-shi-dui-qi/"/>
      <url>/2023/06/01/latex-duo-xing-gong-shi-dui-qi/</url>
      
        <content type="html"><![CDATA[<p>åœ¨ LaTeX ä¸­ï¼Œä½¿ç”¨â€œalignâ€ç¯å¢ƒå¯ä»¥æ–¹ä¾¿åœ°å®ç°ç­‰å·å¯¹é½ã€‚ä½¿ç”¨â€œ&amp;â€ç¬¦å·å¯ä»¥åœ¨æ¯è¡Œä¸­åˆ†éš”ç­‰å·ä¸¤è¾¹çš„å†…å®¹ï¼Œè¡¨ç¤ºå¯¹é½ä½ç½®ï¼Œâ€˜â€™\\â€˜â€™è¡¨ç¤ºæ¢è¡Œ$\lambda$ï¼š</p><pre class=" language-latex"><code class="language-latex"><span class="token function selector">\begin</span><span class="token punctuation">{</span><span class="token keyword">aligned</span><span class="token punctuation">}</span>  2x + 3y <span class="token punctuation">&amp;</span>= 7 <span class="token function selector">\\</span>  5x - 2y <span class="token punctuation">&amp;</span>= 1<span class="token function selector">\end</span><span class="token punctuation">{</span><span class="token keyword">aligned</span><span class="token punctuation">}</span></code></pre><p>è¯¥ä»£ç å°†äº§ç”Ÿä»¥ä¸‹ç­‰å¼ï¼š<br>$$<br>\begin{align}<br>  2x + 3y &amp;= 7 \\<br>  5x - 2y &amp;= 1<br>\end{align}<br>$$</p>]]></content>
      
      
      <categories>
          
          <category> Latex </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Latex </tag>
            
            <tag> Markdown </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Github kex_exchange_identification Connection closed by remote host</title>
      <link href="/2023/05/31/github-kex-exchange/"/>
      <url>/2023/05/31/github-kex-exchange/</url>
      
        <content type="html"><![CDATA[<h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><pre class=" language-bash"><code class="language-bash">kex_exchange_identification: Connection closed by remote hostConnection closed by 20.205.243.166 port 22fatal: Could not <span class="token function">read</span> from remote repository.Please <span class="token function">make</span> sure you have the correct access rightsand the repository exists.</code></pre><h2 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h2><p><strong>æœ¬åœ°ç”Ÿæˆ.pubæ–‡ä»¶</strong></p><pre class=" language-bash"><code class="language-bash">ssh-keygen -t ed25519 -C <span class="token string">"your_mail@xxx.com"</span>ssh-agent <span class="token function">bash</span></code></pre><p>ä¼šåœ¨<code>C:\Users\admin\.ssh</code>ç›®å½•ç”Ÿæˆä¸€ä¸ª<code>id_ed25519.pub</code>æ–‡ä»¶ï¼Œå¤åˆ¶é‡Œé¢çš„å†…å®¹ã€‚</p><p><strong>Github æ–°å»º SSH key</strong></p><p>æ‰“å¼€ Githubï¼Œç‚¹å‡» Setting å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://blog-img-1304093596.cos.ap-shanghai.myqcloud.com/undefinedimage-20230531145549324.png" alt="Setting"></p><p>åœ¨ Setting é¡µé¢ä¸­æ‰¾åˆ° SSH and GPG keys é€‰é¡¹ï¼Œæ–°å»º SSH keyã€‚</p><p><img src="https://blog-img-1304093596.cos.ap-shanghai.myqcloud.com/undefinedimage-20230531145936726.png" alt="SSH and GPG keys"></p><p>Title å†…å®¹ä»»æ„ï¼ŒKey æ–‡æœ¬æ¡†å†…å¡«å…¥ <code>id_ed25519.pub</code> å†…çš„å†…å®¹ã€‚</p><p><img src="https://blog-img-1304093596.cos.ap-shanghai.myqcloud.com/undefinedimage-20230531150100824.png" alt="SSH keys"></p><p>é‡æ–°å°è¯•ä¸Šä¼ ã€‚</p><p>å¦‚æœä»ç„¶æœ‰ä¸Šè¿°é”™è¯¯æç¤ºå¯è¿›è¡Œä»¥ä¸‹æ“ä½œï¼š</p><pre class=" language-shell"><code class="language-shell">git initgit add .git commit -m "init"git branch -M maingit remote add origin git@github.com:xxx/xxx.gitgit push -f -u origin main</code></pre>]]></content>
      
      
      <categories>
          
          <category> Github </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Github Pages + Hexo + Vercel ä¸ªäººåšå®¢æ­å»ºï¼ˆä¸€ï¼‰åŸºç¡€éƒ¨ç½²</title>
      <link href="/2023/05/31/github-pages-ge-ren-bo-ke-da-jian-yi/"/>
      <url>/2023/05/31/github-pages-ge-ren-bo-ke-da-jian-yi/</url>
      
        <content type="html"><![CDATA[<h2 id="æœ¬åœ°åˆ›å»ºç¯å¢ƒ"><a href="#æœ¬åœ°åˆ›å»ºç¯å¢ƒ" class="headerlink" title="æœ¬åœ°åˆ›å»ºç¯å¢ƒ"></a>æœ¬åœ°åˆ›å»ºç¯å¢ƒ</h2><p>æœ¬äººç¯å¢ƒï¼š</p><p><code>windows 10</code></p><h3 id="å®‰è£…-node-js"><a href="#å®‰è£…-node-js" class="headerlink" title="å®‰è£… node.js"></a>å®‰è£… node.js</h3><p>å»ºè®®ä½¿ç”¨ nvm ï¼ˆnode version managerï¼ˆnodeç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼‰ï¼‰å®‰è£… node.jsï¼Œ</p><p><strong>ä¸‹è½½åœ°å€</strong>ï¼š<a href="https://github.com/coreybutler/nvm-windows/releases">https://github.com/coreybutler/nvm-windows/releases</a></p><p><strong>å®‰è£…</strong></p><p>ï¼ˆ1ï¼‰åŒå‡»è§£å‹åçš„æ–‡ä»¶<code>nvm-setup.exe</code>ï¼›<br>ï¼ˆ2ï¼‰é€‰æ‹© nvm å®‰è£…è·¯å¾„ï¼ˆå¡«å‘è­¦å‘Šï¼šè·¯å¾„ä¸èƒ½æœ‰ç©ºæ ¼ï¼ï¼ï¼ï¼‰<br>ï¼ˆ3ï¼‰é€‰æ‹© node.js è·¯å¾„ï¼›<br>ï¼ˆ4ï¼‰ç¡®è®¤å®‰è£…ï¼›<br>ï¼ˆ5ï¼‰æ£€æµ‹ï¼šæ‰“å¼€ cmdï¼Œè¾“å…¥<code>nvm</code>ï¼Œæ˜¾ç¤ºå½“å‰ nvm ç‰ˆæœ¬ä»¥åŠ nvm å‘½ä»¤ï¼ŒæˆåŠŸï¼</p><p><strong>ä½¿ç”¨ nvm</strong></p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 1.nvm list å‘½ä»¤ - æ˜¾ç¤ºç‰ˆæœ¬åˆ—è¡¨</span>nvm list // æ˜¾ç¤ºå·²å®‰è£…çš„ç‰ˆæœ¬ï¼ˆåŒ nvm list installedï¼‰nvm list installed // æ˜¾ç¤ºå·²å®‰è£…çš„ç‰ˆæœ¬nvm list available // æ˜¾ç¤ºæ‰€æœ‰å¯ä»¥ä¸‹è½½çš„ç‰ˆæœ¬<span class="token comment" spellcheck="true"># 2.nvm install å‘½ä»¤ - å®‰è£…æŒ‡å®šç‰ˆæœ¬nodejs</span>nvm <span class="token function">install</span> 16.15.1// å®‰è£…16.15.1ç‰ˆæœ¬nodenvm <span class="token function">install</span> latest // å®‰è£…æœ€æ–°ç‰ˆæœ¬node<span class="token comment" spellcheck="true"># 3.nvm use å‘½ä»¤ - ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬node</span>nvm use 16.15.1 // ä½¿ç”¨16.15.1ç‰ˆæœ¬node<span class="token comment" spellcheck="true"># 4.nvm uninstall å‘½ä»¤ - å¸è½½æŒ‡å®šç‰ˆæœ¬ node</span>nvm uninstall 16.15.1 // å¸è½½16.15.1ç‰ˆæœ¬node</code></pre><p>å¡«å‘è­¦å‘Šï¼šnvm install çš„æ—¶å€™ï¼Œå‡ºç°æ— æƒå®‰è£…ï¼Œéœ€ <code>ä»¥ç®¡ç†å‘˜èº«ä»½</code>è¿è¡Œ cmdã€‚ï¼ï¼ï¼</p><p>æœ¬äººç›®å‰å®‰è£… node.js ç‰ˆæœ¬ä¸º16.15.1.</p><p><strong>è®¾ç½®nodejs prefixï¼ˆå…¨å±€ï¼‰å’Œcacheï¼ˆç¼“å­˜ï¼‰è·¯å¾„ï¼ˆéå¿…é¡»æ“ä½œï¼‰</strong></p><p>åœ¨<code>nodejs</code> å®‰è£…ç›®å½•ä¸‹æ–°å»ºä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œç”¨äºå­˜æ”¾å…¨å±€åŒ…å’Œç¼“å­˜ï¼Œå¦‚ä¸‹ï¼š<br>æˆ‘çš„ node.js å®‰è£…ç›®å½•ï¼š<code>E:\Program\nvm</code></p><pre class=" language-bash"><code class="language-bash"><span class="token function">npm</span> config <span class="token keyword">set</span> prefix <span class="token string">"E:\Program\nvm\node_gobal"</span> <span class="token function">npm</span> config <span class="token keyword">set</span> cache <span class="token string">"E:\Program\nvm\node_cache"</span></code></pre><h3 id="å®‰è£…-Hexo"><a href="#å®‰è£…-Hexo" class="headerlink" title="å®‰è£… Hexo"></a>å®‰è£… Hexo</h3><p>å‘½ä»¤è¡Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤å®‰è£… Hexoï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> -g hexo-cli</code></pre><p>è¾“å…¥ä»¥ä¸‹å‘½ä»¤éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸï¼š</p><pre class=" language-bash"><code class="language-bash">hexo -v</code></pre><h2 id="æœ¬åœ°éƒ¨ç½²"><a href="#æœ¬åœ°éƒ¨ç½²" class="headerlink" title="æœ¬åœ°éƒ¨ç½²"></a>æœ¬åœ°éƒ¨ç½²</h2><p>é€‰æ‹©ä¸€ä¸ªå‡†å¤‡æ”¾ç½®åšå®¢ç½‘ç«™çš„ç›®å½•ï¼Œç„¶åä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥åˆå§‹åŒ–ä¸€ä¸ªé¡¹ç›®ï¼š</p><pre class=" language-bash"><code class="language-bash">hexo init LFD-byte.github.io<span class="token function">cd</span> LFD-byte.github.io<span class="token function">npm</span> <span class="token function">install</span></code></pre><p>è¯¥å‘½ä»¤å°†ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ï¼Œç”Ÿæˆä¸€ä¸ªåä¸º <code>LFD-byte.github.io</code> çš„æ–°ç›®å½•ï¼Œå½“ç„¶ï¼Œä½ å¯ä»¥æŠŠè¿™ä¸ªåå­—æ¢æˆä»»ä½•ä½ æƒ³è¦çš„åå­—ï¼Œå¹¶å°† <code>hexo</code> çš„åˆå§‹åŒ–æ–‡ä»¶å†™å…¥å…¶ä¸­ã€‚</p><p>æ–°å»ºå®Œæˆåï¼Œ<code>LFD-byte.github.io</code> æ–‡ä»¶å¤¹çš„ç›®å½•å¦‚ä¸‹ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token keyword">.</span>â”œâ”€â”€ _config.yml â”œâ”€â”€ package.json â”œâ”€â”€ node_modules â”œâ”€â”€ scaffolds â”œâ”€â”€ <span class="token function">source</span> <span class="token operator">|</span> â”œâ”€â”€ _drafts <span class="token operator">|</span> â””â”€â”€ _posts â””â”€â”€ themes</code></pre><p><code>_config.yml</code> æ˜¯é…ç½®æ–‡ä»¶ï¼Œé‡Œé¢æœ‰å¾ˆå¤šå¯ä»¥é…ç½®çš„æ•°æ®ï¼Œè¿™é‡Œæš‚æ—¶ä¸å¤šä»‹ç»ï¼Œåé¢çš„æ–‡ç« é‡Œä¼šè¿›è¡Œè¯¦ç»†è¯´æ˜ã€‚</p><p><code>package.json</code> æ˜¯åº”ç”¨ç¨‹åºä¿¡æ¯ï¼Œé€šå¸¸ä¸éœ€è¦å…³å¿ƒã€‚</p><p><code>node_modules</code> ç”¨æ¥å­˜æ”¾ <code>node</code> ç›¸å…³çš„æ¨¡å—ï¼Œé€šå¸¸ä¸éœ€è¦å…³å¿ƒã€‚</p><p><code>scaffolds</code> é‡Œé¢æ˜¯æ¨¡ç‰ˆæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡æ–°å»ºæ–‡ç« æ—¶ï¼Œéƒ½ä¼šæ ¹æ®æ¨¡ç‰ˆæ–‡ä»¶æ¥åˆ›å»ºå¯¹åº”çš„ <code>md</code> æ–‡ä»¶ï¼Œè¿™ä¸€ç‚¹ä¹Ÿä¼šåœ¨åç»­çš„æ–‡ç« é‡Œè¿›è¡Œè¯¦ç»†ä»‹ç»ã€‚</p><p><code>source</code> æ˜¯èµ„æºæ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜æ”¾ç”¨æˆ·èµ„æºçš„åœ°æ–¹ã€‚é™¤ <code>_posts</code> æ–‡ä»¶å¤¹ä¹‹å¤–ï¼Œå¼€å¤´å‘½åä¸º _ (ä¸‹åˆ’çº¿)çš„æ–‡ä»¶ / æ–‡ä»¶å¤¹å’Œéšè—çš„æ–‡ä»¶å°†ä¼šè¢«å¿½ç•¥ã€‚</p><p><code>theme</code> æ˜¯ä¸»é¢˜æ–‡ä»¶å¤¹ï¼Œæ¯ä¸ªä¸»é¢˜çš„é…ç½®éƒ½ä¼šæœ‰äº›ä¸ä¸€æ ·ï¼Œéœ€è¦æ ¹æ®å…·ä½“ä¸»é¢˜æƒ…å†µæ¥å®šï¼Œåç»­ä»‹ç»ä¸»é¢˜çš„æ–‡ç« é‡Œä¼šæœ‰è¯´æ˜ã€‚</p><p>åœ¨ <code>breeze-blog</code> ç›®å½•ä¸‹ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥è¿è¡Œæˆ‘ä»¬çš„åšå®¢ï¼š</p><pre class=" language-bash"><code class="language-bash">hexo server</code></pre><p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒæœåŠ¡ä¼šä½¿ç”¨ <code>4000</code> ç«¯å£ï¼Œå¦‚æœå·²ç»è¢«å ç”¨ï¼Œä¹Ÿå¯ä»¥æ·»åŠ  <code>-p</code> å‚æ•°æ¥æ¢ç”¨å…¶å®ƒç«¯å£ï¼š</p><pre class=" language-bash"><code class="language-bash">hexo server -p 8080</code></pre><p>æ‰“å¼€ <code>http://localhost:4000</code> å³å¯è®¿é—®æˆ‘ä»¬ç”Ÿæˆçš„ç½‘ç«™äº†ã€‚</p><p><img src="https://blog-img-1304093596.cos.ap-shanghai.myqcloud.com/undefinedntX31VrhMTjFozQ.jpg" alt="Hexo"></p><p>è¿™æ ·ï¼Œæˆ‘ä»¬çš„åšå®¢å°±æ­å»ºèµ·æ¥äº†ã€‚</p><h2 id="éƒ¨ç½²åˆ°-Github-Pages"><a href="#éƒ¨ç½²åˆ°-Github-Pages" class="headerlink" title="éƒ¨ç½²åˆ° Github Pages"></a>éƒ¨ç½²åˆ° Github Pages</h2><p>åœ¨ä½ çš„ Github è´¦å·åˆ›å»ºä¸€ä¸ªæ–°çš„ä»“åº“ï¼Œä»“åº“å‘½åè§„èŒƒä¸º <code>è´¦å·å.github.io</code>ï¼Œå…¬å¼€ä»“åº“ã€‚</p><p><img src="https://blog-img-1304093596.cos.ap-shanghai.myqcloud.com/undefinedimage-20230604151148301.png" alt="create repository"></p><p>åœ¨ Git bash æˆ– CMD ä¸­ <code>LFD-byte.github.io</code>åšå®¢ç›®å½•ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿æ¥åˆ° Githubï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token function">git</span> init<span class="token function">git</span> add <span class="token keyword">.</span><span class="token function">git</span> commit -m <span class="token string">"first commit"</span><span class="token function">git</span> branch -M main<span class="token function">git</span> remote add origin git@github.com:xxx/xxx.git<span class="token function">git</span> push -u origin main</code></pre><p>åœ¨ <code>LFD-byte.github.io</code> ä»“åº“ä¸‹ Settings ä¸­å¼€å¯ Github Pagesï¼š</p><p><img src="https://blog-img-1304093596.cos.ap-shanghai.myqcloud.com/undefinedimage-20230604152021402.png" alt="open github pages"></p><p>ç„¶åæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹æœ¬åœ°çš„ <code>hexo</code> çš„é…ç½®æ–‡ä»¶(<code>_config.yml</code>)ï¼Œæˆ‘çš„åœ¨ <code>LFD-byte.github.io</code> æ ¹ç›®å½•ä¸‹ï¼Œæ‰¾åˆ°å¯¹åº”çš„åœ°æ–¹è¿›è¡Œä¿®æ”¹ï¼ŒæŒ‡å®šæˆ‘ä»¬çš„ä»“åº“ä¿¡æ¯ï¼Œå¹¶ä¿®æ”¹  <code>deploy</code> ä¿¡æ¯ã€‚</p><pre class=" language-bash"><code class="language-bash">deploy:    type: <span class="token function">git</span>    repo: git@github.com:xxx/blogxxx    branch: main</code></pre><p>æŠŠè¿™é‡Œçš„ <code>repo</code> åœ°å€ä¿®æ”¹ä¸ºä½ çš„ä»“åº“åœ°å€å³å¯ã€‚</p><p>å®‰è£… <code>hexo-deployer-git</code>ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token function">cd</span> LFD-byte.github.io<span class="token function">npm</span> <span class="token function">install</span> hexo-deployer-git --save</code></pre><p>è¿›è¡Œéƒ¨ç½²</p><pre class=" language-bash"><code class="language-bash">hexo clean <span class="token operator">&amp;&amp;</span> hexo generatehexo deploy</code></pre><p>è¿è¡Œå®Œæˆåï¼Œæˆ‘ä»¬çš„åšå®¢æ–‡ä»¶å°±é¡ºåˆ©éƒ¨ç½²åˆ° <code>github pages</code> ä¸Šäº†ï¼Œç°åœ¨æˆ‘ä»¬æ‰“å¼€ä¸‹é¢ç½‘å€æ¥æŸ¥çœ‹æˆ‘ä»¬çš„åšå®¢æ•ˆæœï¼š</p><pre class=" language-bash"><code class="language-bash">https://ç”¨æˆ·å.github.io</code></pre><p>ä¹‹åæ¯æ¬¡æˆ‘ä»¬æ·»åŠ æˆ–ä¿®æ”¹å®Œæœ¬åœ°æ–‡ä»¶åï¼Œä½¿ç”¨ï¼š</p><pre class=" language-bash"><code class="language-bash">hexo clean <span class="token operator">&amp;&amp;</span> hexo g -d</code></pre><p>å³å¯é‡æ–°ç”Ÿæˆé¡¹ç›®æ–‡ä»¶ã€‚</p><h2 id="éƒ¨ç½²åˆ°-Vercel"><a href="#éƒ¨ç½²åˆ°-Vercel" class="headerlink" title="éƒ¨ç½²åˆ° Vercel"></a>éƒ¨ç½²åˆ° Vercel</h2><p>æ³¨å†Œ <a href="https://vercel.com/">Vercel</a> è´¦å·ï¼Œå»ºè®®è°·æ­Œé‚®ç®±æ³¨å†Œã€‚</p><p><img src="https://blog-img-1304093596.cos.ap-shanghai.myqcloud.com/undefinedvercel-logo-freelogovectors.net.jpg" alt="vercel"></p><p>ä½¿ç”¨ GitHub è´¦æˆ·ç™»å½• <a href="https://vercel.com/">Vercel</a>ï¼Œæˆäºˆ Vercel repo çš„ read æƒé™ã€‚</p><p>å¯¼å…¥ GitHub è´¦æˆ·ä¸­çš„ç½‘ç«™ repoï¼Œæ¯”å¦‚æ­¤å¤„çš„ LFD-byte.github.ioã€‚</p><p><img src="https://blog-img-1304093596.cos.ap-shanghai.myqcloud.com/undefinedimage-20230606205007431.png" alt="Project import"></p><p>åœ¨é¡¹ç›®æ„å»ºä¸­ï¼ŒFramework Preset é€‰æ‹© Otherï¼Œå…¶ä½™ä¸åšæ”¹åŠ¨ã€‚</p><p><img src="https://blog-img-1304093596.cos.ap-shanghai.myqcloud.com/undefinedimage-20230606205116417.png" alt="Build"></p><p>ç¨ç­‰ç‰‡åˆ»ï¼Œéƒ¨ç½²æˆåŠŸï¼Œæ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥é€šè¿‡éƒ¨ç½²å®Œæˆå Vercel æä¾›çš„åŸŸåè®¿é—®ä¸ªäººç½‘ç«™äº†ï¼Œç‚¹å‡» Visit è¿›è¡Œè®¿é—®ã€‚</p><p><img src="https://blog-img-1304093596.cos.ap-shanghai.myqcloud.com/undefinedimage-20230606205341204.png" alt="Production Deployment"></p><p><img src="https://blog-img-1304093596.cos.ap-shanghai.myqcloud.com/undefinedimage-20230606205507057.png" alt="Visit Blog"></p><p>ä¹‹åæ¯æ¬¡æˆ‘ä»¬æ·»åŠ æˆ–ä¿®æ”¹å®Œæœ¬åœ°æ–‡ä»¶åï¼Œä½¿ç”¨ï¼š</p><pre class=" language-bash"><code class="language-bash">hexo clean <span class="token operator">&amp;&amp;</span> hexo g -d</code></pre><p>å°±å¯ä»¥ç”Ÿæˆé™æ€æ–‡ä»¶åŒæ­¥éƒ¨ç½²åˆ° Vercel ä¸Šäº†ã€‚</p><h2 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h2><p>è‹¥ npm ä¸èƒ½ä¸‹è½½åŒ…ï¼Œå¯é€šè¿‡ nvm æ›´æ¢ node.js ç‰ˆæœ¬é‡æ–°å°è¯•ä¸‹è½½ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>[1] <a href="https://mfrank2016.github.io/breeze-blog/2020/05/02/hexo/hexo-start/">ã€Hexoã€‘ä½¿ç”¨Hexo+github pages+travis ciæ­å»ºå¥½çœ‹çš„ä¸ªäººåšå®¢ï¼ˆä¸€ï¼‰</a></p><p>[2] <a href="https://blog.csdn.net/liangpingguo/article/details/125324362">Windowsä¸‹ä½¿ç”¨nvmå®‰è£…nodejs</a></p><p>[3] <a href="https://blog.csdn.net/weixin_40026797/article/details/126919662">å»ºç«™è¿‡ç¨‹ä¸­çš„è¸©å‘è®°å½•ï¼šè‡ªå®šä¹‰åŸŸåã€ç™¾åº¦æ”¶å½•ä¸å¤‡æ¡ˆ</a></p>]]></content>
      
      
      <categories>
          
          <category> Blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Blog </tag>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›¾ç¥ç»ç½‘ç»œå­¦ä¹ æ—¥è®°ï¼ˆäº”ï¼‰å›¾ç¥ç»ç½‘ç»œï¼ˆGNNï¼‰</title>
      <link href="/2023/05/31/tu-shen-jing-wang-luo-xue-xi-ri-ji-wu/"/>
      <url>/2023/05/31/tu-shen-jing-wang-luo-xue-xi-ri-ji-wu/</url>
      
        <content type="html"><![CDATA[<p><strong>ç½®æ¢ä¸å˜æ€§å’Œç½®æ¢åŒå˜æ€§</strong></p><p>ä»»ä½•å°†é‚»æ¥çŸ©é˜µ$A$ä½œä¸ºè¾“å…¥çš„å‡½æ•°$f$åœ¨ç†æƒ³çŠ¶æ€ä¸‹ï¼Œéƒ½åº”æ»¡è¶³ä¸‹é¢ä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€ï¼š<br>$$<br>f(PAP^T)=f(A)\text{(ç½®æ¢ä¸å˜)} \\<br>f(PAP^T)=Pf(A)\text{(ç½®æ¢åŒå˜)}<br>$$</p><p>å…¶ä¸­$P$æ˜¯ç½®æ¢çŸ©é˜µã€‚ç½®æ¢ä¸å˜æ˜¯æŒ‡å‡½æ•°ä¸ä¾èµ–é‚»æ¥çŸ©é˜µä¸­è¡Œ/åˆ—çš„ä»»æ„é¡ºåºï¼Œç½®æ¢åŒå˜è¡¨ç¤ºå½“ç½®æ¢é‚»æ¥çŸ©é˜µæ—¶$f$çš„è¾“å‡ºä»¥ä¸€è‡´çš„æ–¹å¼ç½®æ¢ã€‚</p><h2 id="ç¥ç»æ¶ˆæ¯ä¼ é€’"><a href="#ç¥ç»æ¶ˆæ¯ä¼ é€’" class="headerlink" title="ç¥ç»æ¶ˆæ¯ä¼ é€’"></a>ç¥ç»æ¶ˆæ¯ä¼ é€’</h2><h3 id="GNN-æ¡†æ¶"><a href="#GNN-æ¡†æ¶" class="headerlink" title="GNN æ¡†æ¶"></a>GNN æ¡†æ¶</h3><p>åœ¨ GNN çš„æ¯ä¸ªæ¶ˆæ¯ä¼ é€’è¿­ä»£æœŸï¼Œé€šè¿‡èšåˆæ¯ä¸ªèŠ‚ç‚¹$u \in \mathcal{V}$çš„é‚»åŸŸ$\mathcal{N}(u)$çš„ä¿¡æ¯æ¥æ›´æ–°å…¶éšè—åµŒå…¥$h_u^{(k)}$ï¼Œè¿‡ç¨‹å¦‚ä¸‹å¼æ‰€ç¤ºï¼š<br>$$<br>\begin{align}<br>  h_u^{(k+1)} &amp; = UPDATE^{(k)}(h_u^{(k)}, AGGREGATE^{(k)}({h_v^{(k)}, \forall v \in \mathcal{V}(u)})) \\<br>  &amp; = UPDATE^{(k)}(h_u^{(k)}, m_{\mathcal{N}(u)}^{(k)})<br>\end{align}<br>$$</p><p>å…¶ä¸­ $UPDATA$ å’Œ $AGGREGATE$ æ˜¯ä»»æ„å¯å¾®å‡½æ•°ï¼Œ$m_{\mathcal{N}(u)}$ æ˜¯èšåˆèŠ‚ç‚¹ $u$ é‚»åŸŸæ¶ˆæ¯çš„ç»“æœï¼Œä¸Šæ ‡è¡¨ç¤ºæ¶ˆæ¯è¿­ä»£æœŸçš„ç´¢å¼•ã€‚</p><p>è¿­ä»£æœ€åä¸€å±‚çš„è¾“å‡ºå®šä¹‰ä¸ºæ¯ä¸ªèŠ‚ç‚¹çš„åµŒå…¥ï¼š<br>$$<br>z_u = h_u^{(K)}, \forall u \in \mathcal{V}<br>$$<br>ç”±äº $AGGREGATE$ å‡½æ•°å°†æ•´ä¸ªé›†åˆä½œä¸ºè¾“å…¥ï¼Œè¿™ç§æ–¹å¼å®šä¹‰çš„ GNN æ˜¯ç½®æ¢åŒå˜çš„ã€‚</p><p>èŠ‚ç‚¹åµŒå…¥ç¼–ç äº†ä¸¤ç§å½¢å¼çš„ä¿¡æ¯ã€‚</p><p><strong>å›¾çš„ç»“æ„ä¿¡æ¯</strong></p><p><strong>åŸºäºèŠ‚ç‚¹ç‰¹å¾çš„ä¿¡æ¯</strong></p><h3 id="GNN-å®ä¾‹"><a href="#GNN-å®ä¾‹" class="headerlink" title="GNN å®ä¾‹"></a>GNN å®ä¾‹</h3><p>åŸºæœ¬ GNN çš„æ¶ˆæ¯ä¼ é€’å®šä¹‰å¦‚ä¸‹å¼ï¼š<br>$$<br>h_u^{(k)} = \sigma(W_{self}^{(k)}h_u^{(k-1)} + W_{neigh}^{(k)}\sum_{v \in \mathcal{N}(u)} h_v^{(k-1)} + b^{(k)})<br>$$<br>å…¶ä¸­ï¼Œ$W_{self}^{(k)}$ å’Œ $W_{neigh}^{(k)} \in \mathbb{R}^{d^{(k)} \times d^{(k-1)}}$ æ˜¯å¯è®­ç»ƒå‚æ•°çŸ©é˜µï¼Œ$\sigma$ è¡¨ç¤ºé€å…ƒç´ çš„éçº¿æ€§å‡½æ•°ã€‚</p><p>é€šè¿‡å®šä¹‰æ›´æ–°å’Œèšåˆå‡½æ•°ç­‰æ•ˆåœ°å®šä¹‰åŸºæœ¬çš„ GNNï¼š<br>$$<br>m_{\mathcal{N}(u)} = \sum_{v \in \mathcal{N}(u)} h_v \\<br>UPDATE(h_u, m_{\mathcal{N}(u)}) = \sigma (W_{self} h_u + W_{neigh}m_{\mathcal{N}(u)})<br>$$<br>ä¸‹å¼å¯ä½œä¸ºä»èŠ‚ç‚¹ $u$ çš„å›¾ä¸Šé‚»åŸŸèšåˆæ¶ˆæ¯çš„ç®€å†™ï¼š<br>$$<br>m_{\mathcal{N}(u)} = AGGREGATE^{(k)}({h_v^{(k)}, \forall v \in \mathcal{N}(u)})<br>$$<br><strong>å›¾çº§åˆ« GNN å®šä¹‰</strong><br>$$<br>H^{(k)} = \sigma(AH^{(k-1)}W_{neigh}^{(k)} + H^{(k-1)}W_{self}^{(k)})<br>$$<br>å…¶ä¸­ï¼Œ$H^{(k)} \in \mathbb{R}^{|\mathcal{V}| \times d}$ è¡¨ç¤º GNN ä¸­ç¬¬ $k$ å±‚çš„èŠ‚ç‚¹è¡¨ç¤ºçŸ©é˜µï¼ˆæ¯ä¸ªèŠ‚ç‚¹å¯¹åº”çŸ©é˜µçš„ä¸€è¡Œï¼‰ï¼Œ$A$ æ˜¯é‚»æ¥çŸ©é˜µã€‚</p><p><strong>è‡ªç¯æ¶ˆæ¯ä¼ é€’</strong></p><p>æ·»åŠ è‡ªç¯å¹¶çœç•¥æ˜¾ç¤ºçš„æ›´æ–°æ­¥éª¤æ¶ˆæ¯ä¼ é€’å¯å®šä¹‰å¦‚ä¸‹ï¼š<br>$$<br>h_u^{(k)} = AGGREGATE({ h_v^{(k-1)}, \forall v \in \mathcal{N}(n) \bigcup {u} })<br>$$<br>å…¶ä¸­ï¼Œèšåˆåœ¨é›†åˆ $\mathcal{N}(u) \bigcup {u}$ ä¸Šè¿›è¡Œã€‚è¿™ç§æ¶ˆæ¯ä¼ é€’æ–¹å¼å¯ä»¥ç¼“è§£æ‹Ÿåˆé—®é¢˜ï¼Œä¹Ÿå› ä¸ºæ— æ³•åŒºåˆ†èŠ‚ç‚¹å’Œé‚»åŸŸçš„ä¿¡æ¯ä¸¥é‡é™åˆ¶äº† GNN çš„è¡¨è¾¾èƒ½åŠ›ã€‚</p><p>åœ¨åŸºæœ¬ GNN æ¨¡å‹ä¸­ï¼Œæ·»åŠ è‡ªç¯ç­‰æ•ˆäºåœ¨ $W_{self}$ å’Œ $W_{neigh}$ çŸ©é˜µä¹‹é—´å…±äº«å‚æ•°ï¼Œ<strong>å›¾çº§åˆ«æ›´æ–°æ–¹å¼</strong>å¦‚ä¸‹æ‰€ç¤ºï¼š<br>$$<br>H^{(t)} = \sigma ((A+I)H^{(t-1)}W^{(t)})<br>$$</p><h2 id="å¹¿ä¹‰é‚»åŸŸèšåˆ"><a href="#å¹¿ä¹‰é‚»åŸŸèšåˆ" class="headerlink" title="å¹¿ä¹‰é‚»åŸŸèšåˆ"></a>å¹¿ä¹‰é‚»åŸŸèšåˆ</h2><h3 id="é‚»åŸŸå½’ä¸€åŒ–"><a href="#é‚»åŸŸå½’ä¸€åŒ–" class="headerlink" title="é‚»åŸŸå½’ä¸€åŒ–"></a>é‚»åŸŸå½’ä¸€åŒ–</h3><p>æœ€åŸºæœ¬çš„é‚»åŸŸèšåˆå‡½æ•°ä»…å–é‚»å±…åµŒå…¥çš„æ€»å’Œï¼Œè¿™ç§æ–¹æ³•æœ‰å¯èƒ½ä¸ç¨³å®šå¹¶ä¸”å¯¹èŠ‚ç‚¹åº¦é«˜åº¦æ•æ„Ÿã€‚è§£å†³è¯¥é—®é¢˜æ–¹æ¡ˆä¹‹ä¸€æ˜¯åŸºäºæ‰€æ¶‰åŠèŠ‚ç‚¹çš„åº¦æ¥å½’ä¸€åŒ–èšåˆæ“ä½œã€‚</p><p>å‡å€¼ä»£æ›¿æ±‚å’Œï¼Œå¦‚ä¸‹å¼æ‰€ç¤ºï¼š<br>$$<br>m_{\mathcal{N}(u)} = \frac{\sum_{v \in \mathcal{N}(n)}h_v}{|\mathcal{N}(u)|}<br>$$<br>å¯¹ç§°å½’ä¸€åŒ–ï¼Œå¦‚ä¸‹å¼æ‰€ç¤ºï¼š<br>$$<br>m_{\mathcal{N}(u)} = \sum_{v \in \mathcal{N}(u)} \frac{h_v}{\sqrt{|\mathcal{N}(u)||\mathcal{N}(v)|}}<br>$$<br>å›¾å·ç§¯ç¥ç»ç½‘ç»œï¼ˆGCNï¼‰</p><p>é‡‡ç”¨å¯¹ç§°å½’ä¸€åŒ–èšåˆåŠè‡ªç¯æ›´æ–°æ–¹æ³•ï¼ŒGCN æ¶ˆæ¯ä¼ é€’å‡½æ•°å¦‚ä¸‹å¼å®šä¹‰ï¼š<br>$$<br>h_u^{(k)} = \sigma (W^{(k)} \sum_{v \in \mathcal{N}(u)} \bigcup {u} \frac{h_v}{|\mathcal{N}(u)||\mathcal{N}(v)|})<br>$$<br>æ˜¯å¦å½’ä¸€åŒ–ï¼Ÿ</p><p>å½’ä¸€åŒ–å¯èƒ½å¯¼è‡´ä¿¡æ¯ä¸¢å¤±ï¼Œåœ¨å½’ä¸€åŒ–åå¯èƒ½å¾ˆéš¾ä½¿ç”¨å­¦ä¹ åˆ°çš„åµŒå…¥æ¥åŒºåˆ†ä¸åŒåº¦çš„èŠ‚ç‚¹ï¼Œå¹¶ä¸”å½’ä¸€åŒ–ä¼šæ©ç›–å„ç§å…¶ä»–çš„å›¾ç»“æ„ç‰¹å¾ã€‚</p><p>åœ¨é€šå¸¸æƒ…å†µä¸‹ï¼Œåœ¨èŠ‚ç‚¹ç‰¹å¾ä¿¡æ¯è¿œæ¯”ç»“æ„ä¿¡æ¯æœ‰ç”¨æˆ–ç”±äºèŠ‚ç‚¹åº¦èŒƒå›´è¿‡äºå¹¿æ³›å¯¼è‡´ä¼˜åŒ–è¿‡ç¨‹å¯èƒ½ä¸ç¨³å®šçš„ä»»åŠ¡ä¸­ï¼Œå½’ä¸€åŒ–æœ€æœ‰ç”¨ã€‚</p><h3 id="é›†åˆèšåˆæ“ä½œ"><a href="#é›†åˆèšåˆæ“ä½œ" class="headerlink" title="é›†åˆèšåˆæ“ä½œ"></a>é›†åˆèšåˆæ“ä½œ</h3><p><strong>é›†åˆæ± åŒ–</strong></p><p>ä¸€ç§å®šä¹‰èšåˆå‡½æ•°çš„åŸåˆ™æ˜¯åŸºäºç½®æ¢ä¸å˜ç¥ç»ç½‘ç»œçš„ç†è®ºï¼Œå…·æœ‰ä¸‹å¼çš„èšåˆå‡½æ•°æ˜¯é€šç”¨çš„é›†åˆå‡½æ•°é€¼è¿‘å™¨ï¼š<br>$$<br>m_{\mathcal{N}(u)} = MLP_{\theta} (\sum_{v \in \mathcal{N}(u)} MLP_{\phi}(h_v))<br>$$<br>ä¾ç…§æƒ¯ä¾‹ç”¨ $MLP_{\theta}$ è¡¨ç¤ºå¯è®­ç»ƒå‚æ•°ä¸º $\theta$ çš„ä»»ä¸€æ·±åº¦å¤šå±‚æ„ŸçŸ¥å™¨ã€‚å°†ä¸€ç»„åµŒå…¥æ˜ å°„åˆ°ä¸€ä¸ªåµŒå…¥çš„ä»»ä½•ç½®æ¢ä¸å˜å‡½æ•°éƒ½å¯ä»¥åŸºäºä¸Šå¼çš„æ¨¡å‹é€¼è¿‘åˆ°ä»»æ„ç²¾åº¦ã€‚</p><p><strong>Janossy æ± åŒ–</strong></p><p>ä¸ä½¿ç”¨ç½®æ¢ä¸å˜çš„å‹ç¼©æ–¹æ³•ï¼ˆå¦‚æ±‚å’Œæˆ–å–å‡å€¼ï¼‰ï¼Œè€Œæ˜¯é‡‡ç”¨ç½®æ¢æ•æ„Ÿçš„å‡½æ•°å¹¶å¯¹å¤šç§å¯èƒ½çš„ç½®æ¢å–å‡å€¼ã€‚å…·ä½“æ“ä½œä¸ºï¼šä»¤ $\pi_i \in \Pi$ è¡¨ç¤ºå°†é›†åˆ ${h_v, \forall v \in \mathcal{N}(u)}$ æ˜ å°„åˆ°ç‰¹å®šåºåˆ— $((h_{v_1}, h_{v_2}, \cdots, h_{v_{| \mathcal{N}(u) |}})_{\pi_i})$ çš„ç½®æ¢å‡½æ•°ã€‚å³ $\pi_i$ å°†æ— åºçš„é‚»å±…åµŒå…¥é›†ç½®äºä»»æ„æ’åˆ—çš„åºåˆ—ä¸­ã€‚ç„¶åé€šè¿‡ Janossy æ± åŒ–å®ç°é‚»åŸŸèšåˆï¼Œå¦‚ä¸‹å¼æ‰€ç¤ºï¼š</p><p>$$<br>m_{\mathcal{N}(u)} = MLP_{\theta} (\frac{1}{|\Pi|} \sum_{\pi \in \Pi} \rho_{\phi} (h_{v_1}, h_{v_2}, \cdots, h_{v_{|\mathcal{N}(u)|}})_{\pi_i})<br>$$</p><p>å…¶ä¸­ï¼Œ$\Pi$ è¡¨ç¤ºä¸€ç»„ç½®æ¢å‡½æ•°ï¼Œ $\rho_{\phi}$ æ˜¯ç½®æ¢æ•æ„Ÿçš„å‡½æ•°ï¼ˆå¦‚åº”ç”¨äºåºåˆ—æ•°æ®é›†çš„ç¥ç»ç½‘ç»œï¼‰ã€‚åœ¨å®è·µä¸­ï¼Œé€šå¸¸å°† $\rho_{\phi}$ å®šä¹‰ä¸º LSTMã€‚</p><p>å¦‚æœä¸Šå¼ä¸­çš„ç½®æ¢å‡½æ•°é›†åˆ $\Pi$ åŒ…å«æ‰€æœ‰å¯èƒ½çš„ç½®æ¢å‡½æ•°ï¼Œåˆ™ä¸Šå¼ä¸­çš„èšåˆå‡½æ•°ä¹Ÿæ˜¯é€šç”¨é›†åˆå‡½æ•°é€¼è¿‘å™¨ã€‚ä½†æ˜¯å¯¹æ‰€æœ‰å¯èƒ½çš„ç½®æ¢æ±‚å’Œå¾ˆå›°éš¾ï¼Œåœ¨å®è·µä¸­é€šå¸¸é‡‡ç”¨å¦‚ä¸‹ä¸¤ç§æ–¹æ³•è¿›è¡Œ Janossy æ± åŒ–ï¼š</p><p>1 åœ¨æ¯æ¬¡åº”ç”¨èšåˆå‡½æ•°æ—¶ï¼Œå¯¹æ‰€æœ‰å¯èƒ½çš„ç½®æ¢é‡‡æ ·å‡ºä¸€ä¸ªéšæœºå­é›†ï¼Œå¹¶ä¸”å¯¹è¯¥éšæœºè‡ªå·±è¿›è¡Œæ±‚å’Œã€‚</p><p>2 å¯¹é‚»åŸŸä¸­çš„èŠ‚ç‚¹è¿›è¡Œè§„èŒƒåŒ–æ’åºï¼Œä¾‹å¦‚ï¼Œæ ¹æ®èŠ‚ç‚¹åº¦å¯¹èŠ‚ç‚¹è¿›è¡Œé™åºæ’åºï¼Œå¹¶éšæœºæ–­å¼€ä¸€äº›å…³è”å…³ç³»ã€‚</p><h3 id="é‚»åŸŸæ³¨æ„åŠ›æ¨¡å‹"><a href="#é‚»åŸŸæ³¨æ„åŠ›æ¨¡å‹" class="headerlink" title="é‚»åŸŸæ³¨æ„åŠ›æ¨¡å‹"></a>é‚»åŸŸæ³¨æ„åŠ›æ¨¡å‹</h3><p>åŸºæœ¬æ€æƒ³æ˜¯ä¸ºæ¯ä¸ªé‚»åŸŸä¸­çš„èŠ‚ç‚¹åˆ†é…æ³¨æ„åŠ›æƒé‡ï¼Œè¯¥æƒé‡ç”¨äºåœ¨èšåˆæ­¥éª¤ä¸­æƒè¡¡è¯¥èŠ‚ç‚¹çš„å½±å“åŠ›ã€‚ç¬¬ä¸€ä¸ªå¼•å…¥æ³¨æ„åŠ›æœºåˆ¶çš„GNNæ¨¡å‹æ˜¯å›¾æ³¨æ„åŠ›ç½‘ç»œ GATï¼Œè¯¥ç½‘ç»œä½¿ç”¨æ³¨æ„åŠ›æƒé‡æ¥å®šä¹‰é‚»åŸŸçš„åŠ æƒå’Œï¼Œå¦‚ä¸‹å¼æ‰€ç¤ºï¼š<br>$$<br>m_{\mathcal{N}(u)} = \sum_{v \in \mathcal{N}(u)} \alpha_{u,v}h_v<br>$$<br>å…¶ä¸­ï¼Œ$\alpha_{u,v}$ è¡¨ç¤ºåœ¨èŠ‚ç‚¹ $u$ å¤„èšåˆä¿¡æ¯æ—¶ï¼Œå…¶é‚»åŸŸä¸­çš„èŠ‚ç‚¹ $v \in \mathcal{N}(u)$ çš„æ³¨æ„åŠ›æƒé‡ã€‚GAT ä¸­æ³¨æ„åŠ›æƒé‡çš„å®šä¹‰å¦‚ä¸‹å¼æ‰€ç¤ºï¼š<br>$$<br>\alpha_{u,v} = \frac{exp([Wh_v \bigoplus Wh_v])}{\sum_{vâ€™ \in \mathcal{N}(u)} exp(a^T[Wh_v \bigoplus Wh_{vâ€™}])}<br>$$<br>å…¶ä¸­ï¼Œ$a$ æ˜¯å¯è®­ç»ƒçš„æ³¨æ„åŠ›å‘é‡ï¼Œ$W$ æ˜¯å¯è®­ç»ƒçš„çŸ©é˜µï¼Œ$\bigoplus$ è¡¨ç¤ºæ‹¼æ¥æ“ä½œã€‚</p><p>æ³¨æ„åŠ›æœºåˆ¶å˜ä½“ï¼š<br>$$<br>\alpha_{u,v} = \frac{exp(h_u^TWh_v)}{\sum_{vâ€™ \in \mathcal{N}(u)} exp(h_u^TWh_{vâ€™})}<br>$$<br>MLP æ³¨æ„åŠ›å±‚çš„å˜ä½“ï¼š<br>$$<br>\alpha_{u,v} = \frac{exp(MLP(h_u,h_v))}{\sum_{vâ€™ \in \mathcal{N}(u)} exp(MLP(h_u,h_{vâ€™}))}<br>$$<br>ä¸Šå¼é™å®š MLP è¾“å‡ºä¸ºæ ‡é‡ã€‚</p><p>æ·»åŠ å¤šæ³¨æ„åŠ›å¤´ï¼Œä½¿ç”¨å½¼æ­¤ç‹¬ç«‹çš„ $K$ ä¸ªæ³¨æ„åŠ›å±‚è®¡ç®— $K$ ä¸ªä¸åŒçš„æ³¨æ„åŠ›æƒé‡ $\alpha_{u,v,k}$ ï¼Œç„¶åä½¿ç”¨ä¸åŒçš„æ³¨æ„åŠ›æƒé‡èšåˆçš„æ¶ˆæ¯ä¼šåœ¨èšåˆæ­¥éª¤ä¸­è¿›è¡Œè½¬æ¢å’Œåˆå¹¶ï¼Œé€šå¸¸æ˜¯å…ˆè¿›æ€§çº¿æ€§æ˜ å°„ï¼Œå†è¿›è¡Œæ‹¼æ¥æ“ä½œï¼Œå¦‚ä¸‹å¼æ‰€ç¤ºï¼š<br>$$<br>\begin{aligned}<br>m_{\mathcal{N}(u)} &amp;= [a_1 \bigoplus a_2 \bigoplus \cdots \bigoplus a_K] \\<br>a_k &amp;= W_i \sum_{v \in \mathcal{N}(u)} \alpha_{u,v,k}h_v<br>\end{aligned}<br>$$<br>å…¶ä¸­ï¼Œ$K$ ä¸ªæ³¨æ„åŠ›å¤´ä¸­çš„æ¯ä¸€ä¸ªæ³¨æ„åŠ›æƒé‡ $\alpha_{u,v,k}$ å¯ä»¥ä½¿ç”¨ä¸Šè¿°ä»»ä½•ä¸€ç§æ³¨æ„åŠ›æœºåˆ¶è¿›è¡Œè®¡ç®—ã€‚</p><h2 id="å¹¿ä¹‰æ›´æ–°æ–¹æ³•"><a href="#å¹¿ä¹‰æ›´æ–°æ–¹æ³•" class="headerlink" title="å¹¿ä¹‰æ›´æ–°æ–¹æ³•"></a>å¹¿ä¹‰æ›´æ–°æ–¹æ³•</h2><p><strong>è¿‡åº¦å¹³æ»‘å’Œé‚»åŸŸå½±å“</strong></p><p>GNN çš„ä¸€ä¸ªå¸¸è§é—®é¢˜æ˜¯è¿‡åº¦å¹³æ»‘ã€‚è¿‡åº¦å¹³æ»‘çš„åŸºæœ¬åŸç†æ˜¯ï¼šç»è¿‡å¤šæ¬¡ GNN æ¶ˆæ¯ä¼ é€’åï¼Œå›¾ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„è¡¨ç¤ºå¯èƒ½å˜å¾—éå¸¸ç›¸ä¼¼ã€‚è¿‡åº¦å¹³æ»‘å¯¼è‡´æ— æ³•å»ºç«‹æ›´æ·±çš„ GNN æ¨¡å‹ä»¥åˆ©ç”¨å›¾ä¸Šçš„é•¿æœŸä¾èµ–å…³ç³»ï¼Œå› ä¸ºè¿™äº›æ·±å±‚çš„ GNN æ¨¡å‹å¾€å¾€ä¼šç”Ÿæˆè¿‡åº¦å¹³æ»‘çš„åµŒå…¥ã€‚</p><p>å¯ä»¥é€šè¿‡å®šä¹‰æ¯ä¸ªèŠ‚ç‚¹çš„è¾“å…¥ç‰¹å¾ $h_u^{(0)}=x_u$ å¯¹å›¾ä¸Šå…¶å®ƒèŠ‚ç‚¹çš„æœ€ç»ˆå±‚è¾“å‡ºçš„åµŒå…¥ï¼ˆ$h_v^{(K)},\forall v \in \mathcal{V}$ï¼‰çš„å½±å“æ¥å½¢å¼åŒ–å®šä¹‰ GNN ä¸­çš„è¿‡åº¦å¹³æ»‘é—®é¢˜ã€‚å¯¹äºä»»æ„ä¸€å¯¹èŠ‚ç‚¹ $u$ å’Œ $v$ ï¼Œå¯ä»¥é€šè¿‡æ£€æŸ¥ç›¸åº”çš„é›…å¯æ¯”çŸ©é˜µçš„å¤§å°æ¥é‡åŒ– GNN ä¸­èŠ‚ç‚¹ $u$ å¯¹èŠ‚ç‚¹ $v$ çš„å½±å“ï¼Œå¦‚ä¸‹å¼æ‰€ç¤ºï¼š<br>$$<br>I_{K(u,v)} = 1^T(\frac{\partial h_v^{(K)}}{\partial h_u^{(0)}})<br>$$<br>å…¶ä¸­ï¼Œ$1$ æ˜¯å…ƒç´ å…¨ä¸º 1 çš„å‘é‡ã€‚$I_{K(u,v)}$ æ˜¯é›…å¯æ¯”çŸ©é˜µ $\frac{\partial h_v^{(K)}}{\partial h_u^{(0)}}$ ä¸­çš„å…ƒç´ ä¹‹å’Œã€‚ç”¨æ¥è¡¡é‡ GNN ä¸­èŠ‚ç‚¹ $u$ çš„åˆå§‹åµŒå…¥å¯¹èŠ‚ç‚¹ $v$ çš„æœ€ç»ˆåµŒå…¥çš„å½±å“ç¨‹åº¦ã€‚</p><p>å®šç†ï¼šå¯¹äºä»»ä½•ä½¿ç”¨è‡ªç¯æ›´æ–°æ–¹æ³•å’Œç”¨ä¸‹å¼è¡¨ç¤ºèšåˆå‡½æ•°çš„ GNN æ¨¡å‹<br>$$<br>AGGRGATE({h_v, \forall v \in \mathcal{N}(u) \bigcup {u}}) = \frac{1}{f_n(|\mathcal{N}(u) \bigcup {u}|)} \sum_{v \in \mathcal{N}(u) \bigcup {u}} h_v<br>$$<br>å…¶ä¸­ï¼Œ$f:\mathbb{R}^+ \rightarrow \mathbb{R}^+$ æ˜¯ä»»æ„å¯å¾®çš„å½’ä¸€åŒ–å‡½æ•°ã€‚</p><p>å¯å¾—å‡ºä¸‹å¼ç»“è®ºï¼š<br>$$<br>I_K (u,v) \propto p_{\mathcal{G},K}(u|v)<br>$$<br>å…¶ä¸­ï¼Œ$p_{\mathcal{G},K}(u|v)$ è¡¨ç¤ºä»èŠ‚ç‚¹ $u$ å¼€å§‹çš„ $K$ æ­¥éšæœºæ¸¸èµ°è¿‡ç¨‹ä¸­è®¿é—®èŠ‚ç‚¹ $v$ çš„æ¦‚ç‡ã€‚</p><p>å½“ä½¿ç”¨ $K$ å±‚ GCN å‹é­”æ€§æ—¶ï¼ŒèŠ‚ç‚¹ $u$ å¯¹èŠ‚ç‚¹ $v$ çš„å½±å“ä»èŠ‚ç‚¹ $u$ å¼€å§‹ç»è¿‡ $K$ æ­¥éšæœºæ¸¸èµ°åˆ°è¾¾èŠ‚ç‚¹ $v$ çš„æ¦‚ç‡æˆæ­£æ¯”ã€‚ä½†æ˜¯ï¼Œéšç€ $K \rightarrow \infty$ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„å½±å“éƒ½æ¥è¿‘å›¾ä¸Šéšæœºæ¸¸èµ°çš„å¹³ç¨³åˆ†å¸ƒï¼Œè¿™æ„å‘³ç€æœ¬åœ°é‚»åŸŸä¿¡æ¯ä¼šä¸¢å¤±ã€‚</p><p>ä¸Šè¿°å®šç†ç›´æ¥é€‚ç”¨äºä½¿ç”¨è‡ªç¯æ›´æ–°æ–¹æ³•çš„æ¨¡å‹ï¼Œä½†æ˜¯åªè¦ä»»æ„å±‚ $k$ æ»¡è¶³ $| W_{self}^{(k)} | &lt; | W_{neigh}^{(k)} |$ï¼Œå…¶ç»“æœä¹Ÿå¯ä»¥æ¸è¿‘åœ°æ‰©å±•åŸºæœ¬ GNN çš„æ›´æ–°ã€‚å› æ­¤å½“ä½¿ç”¨ç®€å• GNN æ¨¡å‹æ—¶ï¼Œæ„å»ºæ›´æ·±çš„æ¨¡å‹å®é™…ä¸Šä¼šæŸå®³æ¨¡å‹æ€§èƒ½ã€‚éšç€æ›´å¤šå±‚çš„åŠ å…¥ï¼Œæ¨¡å‹å°†ä¸¢å¤±æ›´å¤šå…³äºæœ¬åœ°é‚»åŸŸç»“æ„çš„ä¿¡æ¯ï¼Œå¹¶ä¸”å­¦ä¹ çš„åµŒå…¥ä¼šå˜å¾—è¿‡äºå¹³æ»‘ï¼Œæ¥è¿‘å‡ ä¹å‡åŒ€çš„åˆ†å¸ƒã€‚</p><h3 id="æ‹¼æ¥å’Œè·³è·ƒè¿æ¥"><a href="#æ‹¼æ¥å’Œè·³è·ƒè¿æ¥" class="headerlink" title="æ‹¼æ¥å’Œè·³è·ƒè¿æ¥"></a>æ‹¼æ¥å’Œè·³è·ƒè¿æ¥</h3><p>æœ€ç®€å•æ›´æ–°è·³è·ƒè¿æ¥çš„æ–¹å¼ä¹‹ä¸€æ˜¯ä½¿ç”¨æ‹¼æ¥æ“ä½œå†æ¶ˆæ¯ä¼ é€’æœŸé—´ä¿ç•™æ›´å¤šèŠ‚ç‚¹çº§åˆ«ä¿¡æ¯ï¼Œå¦‚ä¸‹å¼æ‰€ç¤ºï¼š<br>$$<br>UPDATE_{concat}(h_u, m_{\mathcal{N}(u)}) = [UPDATE_{base}(h_u,m_{\mathcal{N}(u)}) \bigoplus h_u]<br>$$<br>å…¶ä¸­ï¼Œç›´æ¥å°†åŸºæœ¬æ›´æ–°å‡½æ•°çš„è¾“å‡ºä¸èŠ‚ç‚¹çš„ä¸Šä¸€å±‚è¡¨ç¤ºæ‹¼æ¥ï¼Œé¼“åŠ±æ¨¡å‹å†æ¶ˆæ¯ä¼ é€’è¿‡ç¨‹ä¸­è§£è€¦ä¿¡æ¯ï¼Œå°†æ¥è‡ªé‚»åŸŸçš„ä¿¡æ¯ï¼ˆ$m_{\mathcal{N}(u)}$ï¼‰ä¸æ¯ä¸ªèŠ‚ç‚¹å½“å‰çš„è¡¨ç¤ºï¼ˆ$h_u$ï¼‰åˆ†å¼€ã€‚</p><p>çº¿æ€§æ’å€¼æ³•è·³è·ƒè¿æ¥ï¼Œå¦‚ä¸‹å¼æ‰€ç¤ºï¼š<br>$$<br>UPDATE_{interpolate}(h_u,m_{\mathcal{N}(u)}) = \alpha_1 \circ UPDATE_{base}(h_u,m_{\mathcal{N}(u)}) + \alpha_2 \bigodot h_u<br>$$<br>å…¶ä¸­ï¼Œ$\alpha_1,\alpha_2 \in [0,1]^d$ æ˜¯æ»¡è¶³ $\alpha_2 = 1 - \alpha_1$ çš„é—¨æ§å‘é‡ï¼Œ$\circ$ è¡¨ç¤ºé€å…ƒç´ ç›¸ä¹˜ã€‚</p><p>æœ€ç»ˆæ›´æ–°çš„è¡¨ç¤ºæ˜¯å…ˆå‰è¡¨ç¤ºä¸åŸºäºé‚»åŸŸä¿¡æ¯è¿›è¡Œæ›´æ–°çš„è¡¨ç¤ºä¹‹é—´çš„çº¿æ€§æ’å€¼ã€‚</p><p>åœ¨é€šå¸¸æƒ…å†µä¸‹ï¼Œæ‹¼æ¥å’Œè·³è·ƒè¿æ¥æœ‰åŠ©äºç¼“è§£ GNN ä¸­è¿‡æ¸¡å¹³æ»‘é—®é¢˜ï¼ŒåŒæ—¶å¯ä»¥æé«˜ä¼˜åŒ–æ•°å€¼çš„ç¨³å®šæ€§ã€‚</p><h3 id="é—¨æ§æ›´æ–°å‡½æ•°"><a href="#é—¨æ§æ›´æ–°å‡½æ•°" class="headerlink" title="é—¨æ§æ›´æ–°å‡½æ•°"></a>é—¨æ§æ›´æ–°å‡½æ•°</h3><p>ä¸€ç§è§£è¯» GNN æ¶ˆæ¯ä¼ é€’ç®—æ³•çš„è§‚ç‚¹æ˜¯ï¼šèšåˆå‡½æ•°ä»é‚»åŸŸæ¥æ”¶è§‚å¯Ÿç»“æœï¼Œç„¶åå°†å…¶ç”¨äºæ›´æ–°æ¯ä¸ªèŠ‚ç‚¹çš„éšçŠ¶æ€ã€‚åŸºäºè¿™ä¸€è§‚ç‚¹å¯ä»¥æ ¹æ®è§‚å¯Ÿç»“æœç›´æ¥ä½¿ç”¨æ›´æ–° RNN æ¡†æ¶çš„éšçŠ¶æ€çš„æ–¹æ³•ï¼Œæœ€æ—©çš„ GNN æ¶æ„ä¹‹ä¸€å®šä¹‰æ›´æ–°å‡½æ•°å¦‚ä¸‹å¼æ‰€ç¤ºï¼š<br>$$<br>h_u^{(k)} = GRU(h_u^{(k-1)},m_{\mathcal{N}(u)}^{(k)})<br>$$<br>å…¶ä¸­ï¼ŒGRU è¡¨ç¤º GRU å•å…ƒçš„æ›´æ–°å‡½æ•°ã€‚</p><p>é—¨æ§æ›´æ–°æ–¹æ³•åœ¨æé«˜ GNN æ¡†æ¶çš„æ¨¡å‹æ·±åº¦ï¼ˆè¶…è¿‡10å±‚ï¼‰å’Œé˜²æ­¢è¿‡åº¦å¹³æ»‘é—®é¢˜æ–¹é¢éå¸¸æœ‰æ•ˆã€‚</p><h3 id="è·³è·ƒçŸ¥è¯†è¿æ¥"><a href="#è·³è·ƒçŸ¥è¯†è¿æ¥" class="headerlink" title="è·³è·ƒçŸ¥è¯†è¿æ¥"></a>è·³è·ƒçŸ¥è¯†è¿æ¥</h3><p>æé«˜æœ€ç»ˆçš„èŠ‚ç‚¹è¡¨ç¤ºè´¨é‡çš„ä¸€ç§è¡¥å……ç­–ç•¥æ˜¯åˆ©ç”¨æ¶ˆæ¯ä¼ é€’çš„æ¯ä¸€å±‚è¾“å‡ºçš„è¡¨ç¤ºï¼Œå«åšåŠ å…¥è·³è·ƒçŸ¥è¯†ï¼Œå¦‚ä¸‹å¼æ‰€ç¤ºï¼š<br>$$<br>z_u = f_{JK}(h_u^{(0)} \bigoplus h_u^{(1)} \bigoplus \cdots \bigoplus h_u^{(K)})<br>$$<br> å…¶ä¸­ï¼Œ$f_{JK}$ æ˜¯ä»»æ„å¾®åˆ†å‡½æ•°ã€‚</p><h2 id="è¾¹ç‰¹å¾å’Œå¤šå…ƒå…³ç³»-GNN"><a href="#è¾¹ç‰¹å¾å’Œå¤šå…ƒå…³ç³»-GNN" class="headerlink" title="è¾¹ç‰¹å¾å’Œå¤šå…ƒå…³ç³» GNN"></a>è¾¹ç‰¹å¾å’Œå¤šå…ƒå…³ç³» GNN</h2><p>ä¸‹é¢ä»‹ç» GNN åœ¨å¤šå…ƒå…³ç³»å›¾æˆ–å…¶å®ƒå¼‚æ„å›¾ä¸­çš„åº”ç”¨ã€‚</p><h3 id="å…³ç³»-GNN"><a href="#å…³ç³»-GNN" class="headerlink" title="å…³ç³» GNN"></a>å…³ç³» GNN</h3><p>å…³ç³»å›¾å·ç§¯ç½‘ç»œï¼ˆRGCNï¼‰ï¼Œé€šè¿‡ä¸ºæ¯ç§å…³ç³»ç±»å‹æŒ‡å®šä¸€ä¸ªå•ç‹¬çš„å˜åŒ–çŸ©é˜µæ¥å¢å¼ºèšåˆå‡½æ•°å¤„ç†å¤šç§å…³ç³»çš„èƒ½åŠ›ï¼Œå¦‚ä¸‹å¼æ‰€ç¤ºï¼š<br>$$<br>m_{\mathcal{N}(u)} = \sum_{\tau \in \mathcal{R}} \sum_{v \in \mathcal{N}<em>{\tau}(u)} \frac{W</em>{\tau}h_v}{f_n(\mathcal{N}(u), \mathcal{N}(v))}<br>$$<br>å…¶ä¸­ï¼Œ $f_n$ æ˜¯ä¸€ä¸ªå½’ä¸€åŒ–å‡½æ•°ï¼Œå®ƒçš„å€¼å–å†³äºèŠ‚ç‚¹ $u$ çš„é‚»åŸŸä»¥åŠè¢«èšåˆçš„èŠ‚ç‚¹ $v$ çš„é‚»åŸŸã€‚RGCN ä¸­çš„å¤šå…ƒå…³ç³»èšåˆç±»ä¼¼å…·æœ‰å½’ä¸€åŒ–å‡½æ•°çš„åŸºæœ¬ GNNï¼Œä½†æ ¹æ®è¾¹çš„ç±»å‹ä¸åŒåˆ†åˆ«èšåˆä¿¡æ¯ã€‚</p><p><strong>å‚æ•°å…±äº«</strong></p><p>æœ´ç´  RGCN æ–¹æ³•çš„ä¸€ä¸ªç¼ºç‚¹æ˜¯ç”±äºæ¯ä¸€ç§å…³ç³»ç±»å‹éƒ½éœ€è¦ä¸€ä¸ªå¯è®­ç»ƒçš„çŸ©é˜µå¯¼è‡´å‚æ•°é‡æ€¥å‰§å¢åŠ ï¼Œè¿™ç§å‚æ•°é‡çš„æ¿€å¢å¯èƒ½å¯¼è‡´è¿‡æ‹Ÿåˆå’Œè®­ç»ƒç¼“æ…¢çš„é—®é¢˜ã€‚</p><p>é€šè¿‡ä¸åŸºçŸ©é˜µå…±äº«å‚æ•°çš„æ–¹æ³•æ¥è§£å†³æ­¤é—®é¢˜ï¼Œå¦‚ä¸‹å¼ï¼š<br>$$<br>W_{\tau} = \sum_{i=1}^b \alpha_{i,\tau}B_i<br>$$<br>è¯¥æ–¹æ³•ä¸­ï¼Œæ‰€æœ‰å…³ç³»çŸ©é˜µéƒ½å®šä¹‰ä¸º $b$ ä¸ªåŸºçŸ©é˜µï¼ˆ$B1,\cdots,B_b$ï¼‰çš„çº¿æ€§ç»„åˆï¼›å”¯ä¸€çš„å…³äºå…³ç³»çš„å‚æ•°æ˜¯æ¯ç§å…³ç³» $\tau$ çš„ $b$ ä¸ªç»„åˆæƒé‡ $\alpha_{1,\tau}, \cdots, \alpha_{b,\tau}$ã€‚åœ¨è¿™ç§åŸºæœ¬å…±äº«æ–¹æ³•ä¸­ï¼Œçœ‹å¯ä»¥å°†å®Œæ•´èšåˆå‡½æ•°è¡¨ç¤ºä¸ºä¸‹å¼ï¼š<br>$$<br>m_{\mathcal{N}(u)} = \sum_{\tau \in \mathcal{R}} \sum_{v \in \mathcal{N}<em>{\tau}(u)} \frac{\alpha</em>{\tau} \times_{1} B \times_{2} h_v}{f_n(\mathcal{N}(u), \mathcal{N}(v))}<br>$$<br>å…¶ä¸­ï¼Œ$B = (B_1, \cdots, B_b)$ æ˜¯ä¸€ä¸ªç”±åŸºçŸ©é˜µå †å æ„æˆçš„å¼ é‡ï¼Œ $\alpha_{\tau} = \alpha_{1,\tau}, \cdots, \alpha_{b,\tau}$ æ˜¯ä¸€ä¸ªå…³äºå…³ç³» $\tau$ çš„åŒ…å«åŸºçŸ©é˜µç»„åˆæƒé‡çš„å‘é‡ï¼Œ$\times_{i}$ è¡¨ç¤ºæ²¿ç€æ¨¡ $i$ çš„å¼ é‡ç§¯ã€‚å¦ä¸€ç§ç†è§£å‚æ•°å…±äº« RGCN æ–¹æ³•çš„è¿‡ç¨‹æ˜¯ï¼šå­¦ä¹ æ¯ä¸ªå…³ç³»çš„åµŒå…¥åŠæ‰€æœ‰å…³ç³»ä¹‹é—´å…±äº«çš„å¼ é‡ã€‚</p><h3 id="æ³¨æ„åŠ›æœºåˆ¶å’Œç‰¹å¾æ‹¼æ¥"><a href="#æ³¨æ„åŠ›æœºåˆ¶å’Œç‰¹å¾æ‹¼æ¥" class="headerlink" title="æ³¨æ„åŠ›æœºåˆ¶å’Œç‰¹å¾æ‹¼æ¥"></a>æ³¨æ„åŠ›æœºåˆ¶å’Œç‰¹å¾æ‹¼æ¥</h3><p>ä¸ºé€‚åº”æ›´ä¸€èˆ¬å½¢å¼çš„è¾¹ç‰¹å¾çš„æƒ…å†µï¼Œå¯ä»¥åœ¨æ¶ˆæ¯ä¼ é€’è¿‡ç¨‹ä¸­åŸºäºæ³¨æ„åŠ›æœºåˆ¶æˆ–å°†è¿™äº›ä¿¡æ¯ä¸é‚»åŸŸåµŒå…¥æ‹¼æ¥æ¥å……åˆ†åˆ©ç”¨è¿™äº›ç‰¹å¾ã€‚åœ¨ç»™å®šä»»æ„åŸºæœ¬èšåˆæ–¹æ³• $AGGREGATE_{base}$ çš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨è¾¹ç‰¹å¾çš„ä¸€ç§ç®€å•ç­–ç•¥æ˜¯å¦‚ä¸‹å¼å®šä¹‰æ–°çš„èšåˆå‡½æ•°ï¼š<br>$$<br>m_{\mathcal{N}(u)} = AGGREGATE_{base}({h_v \bigoplus e_{(u,\tau,v)}, \forall v \in \mathcal{N}(u) })<br>$$<br>å…¶ä¸­ï¼Œ$e_{(u,\tau,v)}$ è¡¨ç¤ºè¾¹ $(u,\tau,v)$ çš„ç‰¹å¾ã€‚</p><h2 id="å›¾æ± åŒ–"><a href="#å›¾æ± åŒ–" class="headerlink" title="å›¾æ± åŒ–"></a>å›¾æ± åŒ–</h2><p><strong>é›†åˆæ± åŒ–æ–¹æ³•</strong></p><p>ä¸ AGGREGATE æ“ä½œç±»ä¼¼ï¼Œå›¾æ± åŒ–ä»»åŠ¡å¯ä»¥çœ‹ä½œæ˜¯è§£å†³é›†åˆä¸Šçš„é—®é¢˜ã€‚è¦è®¾è®¡ä¸€ä¸ªæ± åŒ–å‡½æ•° $f_p$ å°†ä¸€ç»„èŠ‚ç‚¹åµŒå…¥ ${ z_1, \cdots, z_{|V|} }$ æ˜ å°„ä¸ºè¡¨ç¤ºæ•´å¼ å›¾çš„åµŒå…¥ $z_{\mathcal{G}}$ã€‚</p><p>ç¬¬ä¸€ç§å¸¸ç”¨æ–¹æ³•æ˜¯å¯¹èŠ‚ç‚¹åµŒå…¥æ±‚å’Œï¼ˆæˆ–å–å‡å€¼ï¼‰ï¼Œå¦‚ä¸‹å¼æ‰€ç¤ºï¼š<br>$$<br>z_{\mathcal{G}} = \frac{\sum_{v \in \mathcal{V}} z_c}{f_n(|\mathcal{V}|)}<br>$$<br>å…¶ä¸­ï¼Œ$f_n$ æ˜¯å½’ä¸€åŒ–å‡½æ•°ï¼ˆå¦‚æ’ç­‰å‡½æ•°ï¼‰ã€‚é€‚ç”¨äºå°è§„æ¨¡å›¾ã€‚</p><p>ç¬¬äºŒç§å¸¸ç”¨æ–¹æ³•åŸºäºé›†åˆçš„æ–¹æ³•ï¼Œç»“åˆäº† LSTM å’Œæ³¨æ„åŠ›æœºåˆ¶æ¥æ± åŒ–èŠ‚ç‚¹åµŒå…¥ã€‚è¿™ç§æ± åŒ–æ–¹æ³•è¿­ä»£ $t=1,\cdots,T$ æ­¥åŸºäºæ³¨æ„åŠ›æœºåˆ¶çš„èšåˆæ“ä½œï¼Œå¦‚ä¸‹å¼æ‰€ç¤ºï¼š<br>$$<br>\begin{aligned}<br>q_i &amp;= LSTM(o_{t-1}, q_{t-1}) \\<br>e_{v,t} &amp;= f_a(z_v,q_t),\forall v \in \mathcal{V} \\<br>a_{v,t} &amp;= \frac{exp(e_{v,i})}{\sum_{u \in \mathcal{V}} e_{u,t}}, \forall v \in \mathcal{V} \\<br>o_t &amp;= \sum_{v \in \mathcal{V}} a_{v,t} z_v<br>\end{aligned}<br>$$</p><p>å…¶ä¸­ï¼Œ$q_t$ è¡¨ç¤ºæ¯æ¬¡è¿­ä»£ $t$ æ¬¡æ³¨æ„åŠ›æœºåˆ¶ä¸­çš„æŸ¥è¯¢å‘é‡ã€‚æŸ¥è¯¢å‘é‡ç”¨äºä½¿ç”¨æ³¨æ„åŠ›å‡½æ•° $f_a: \mathbb{R}^d \times \mathbb{R} \rightarrow \mathbb{R}$ ï¼ˆå¦‚ç‚¹ç§¯ï¼‰ä¸ºæ¯ä¸ªèŠ‚ç‚¹è®¡ç®—æ³¨æ„åŠ›åˆ†æ•°ï¼Œç„¶åå°†è¯¥æ³¨æ„åŠ›åˆ†æ•°è¿›è¡Œå½’ä¸€åŒ–ï¼Œæœ€åæ ¹æ®æ³¨æ„åŠ›æƒé‡è®¡ç®—èŠ‚ç‚¹åµŒå…¥çš„åŠ æƒå’Œï¼Œå¹¶åŸºäºè¯¥åŠ æƒå’Œé‡‡ç”¨ LSTM æ›´æ–°æ¥æ›´æ–°æŸ¥è¯¢å‘é‡ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œç”¨å…¨é›¶å‘é‡åˆå§‹åŒ– $q_0$ å’Œ $o_0$ ï¼Œè¿›è¡Œäº† $T$ æ¬¡è¿­ä»£åè®¡ç®—æ•´å¼ å›¾çš„åµŒå…¥å¦‚ä¸‹å¼æ‰€ç¤ºï¼š<br>$$<br>z_{\mathcal{G}} = o_1 \bigoplus o_2 \bigoplus \cdots \bigoplus o_T<br>$$<br><strong>å›¾ç²—ç³™åŒ–æ–¹æ³•</strong></p><p>é›†åˆæ± åŒ–æ–¹æ³•çš„å±€é™æ€§åœ¨äºä¸èƒ½åˆ©ç”¨å›¾çš„ç»“æ„ä¿¡æ¯ã€‚åœ¨æ± åŒ–é˜¶æ®µåˆ©ç”¨å›¾çš„æ‹“æ‰‘ä¿¡æ¯å¯ä»¥è¿›ä¸€æ­¥æä¾›å¢ç›Šï¼Œå®ç°æ¬¡ç›®çš„çš„ä¸€ç§æµå½¢ç­–ç•¥æ˜¯ç”¨å›¾èšç±»æˆ–ç²—ç³™åŒ–ä½œä¸ºæ± åŒ–èŠ‚ç‚¹è¡¨ç¤ºçš„ä¸€ç§æ–¹æ³•ã€‚</p><p>å‡è®¾æœ‰èšç±»å‡½æ•°å¦‚ä¸‹å¼æ‰€ç¤ºï¼š<br>$$<br>f_c \rightarrow \mathcal{G} \times \mathbb{R}^{|V| \times d} \rightarrow \mathbb{R}^{+|V| \times c}<br>$$<br>èšç±»å‡½æ•°å°†å›¾ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹åˆ†ä¸º $c$ ä¸ªç°‡ã€‚å‡å®šè¯¥å‡½æ•°è¾“å‡ºä¸€ä¸ªåˆ†é…çŸ©é˜µ $S = f_c(\mathcal{G}, Z)$ï¼Œå…¶ä¸­ï¼Œ$S[u,i] \in \mathbb{R}$ è¡¨ç¤ºèŠ‚ç‚¹ $u$ å’Œç°‡ $i$ ä¹‹é—´çš„å…³è”å¼ºåº¦ã€‚</p><p>å›¾ç²—ç³™åŒ–æ–¹æ³•çš„å…³é”®æ€æƒ³æ˜¯ä½¿ç”¨èšç±»åˆ†é…çŸ©é˜µæ¥ç²—ç³™åŒ–å›¾ã€‚è¿™é‡Œä½¿ç”¨åˆ†é…çŸ©é˜µ $S$ æ¥è®¡ç®—æ–°çš„ç²—ç³™åŒ–é‚»æ¥çŸ©é˜µå’Œä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ç‰¹å¾é›†åˆï¼Œå¦‚ä¸‹å¼æ‰€ç¤ºï¼š<br>$$<br>\begin{aligned}<br>A^{new} &amp;= S^TAS \in \mathbb{R}^{+c \times c} \\<br>X^{new} &amp;= S^TX \in \mathbb{R}^{c \times d}<br>\end{aligned}<br>$$<br>è¿™ä¸€æ–°çš„é‚»æ¥çŸ©é˜µè¡¨ç¤ºå›¾ä¸­çš„ç°‡ä¹‹é—´çš„å…³è”å¼ºåº¦ï¼ˆè¾¹ï¼‰ï¼Œè€Œæ–°çš„ç‰¹å¾çŸ©é˜µè¡¨ç¤ºèšåˆåˆ†é…ç»™æ¯ä¸ªç°‡çš„æ‰€æœ‰èŠ‚ç‚¹åµŒå…¥çš„ç»“æœã€‚åœ¨è¯¥ç²—ç³™åŒ–çš„å›¾ä¸Šè¿è¡Œ GNNï¼Œå¹¶åœ¨æ¯æ¬¡è¿­ä»£çš„è¿‡ç¨‹ä¸­é‡å¤ç²—ç³™åŒ–è¿‡ç¨‹ï¼Œå›¾åœ¨æ¯ä¸€æ­¥éƒ½ä¼šå‡å°ï¼Œæœ€ååœ¨è¶³å¤Ÿç²—ç³™åŒ–çš„å›¾ä¸Šå¯¹èŠ‚ç‚¹åµŒå…¥æ‰§è¡Œé›†åˆæ± åŒ–å¯ä»¥è·å¾—å›¾çš„æœ€ç»ˆè¡¨ç¤ºã€‚</p><h2 id="é€šç”¨æ¶ˆæ¯ä¼ é€’æ–¹æ³•"><a href="#é€šç”¨æ¶ˆæ¯ä¼ é€’æ–¹æ³•" class="headerlink" title="é€šç”¨æ¶ˆæ¯ä¼ é€’æ–¹æ³•"></a>é€šç”¨æ¶ˆæ¯ä¼ é€’æ–¹æ³•</h2><p>GNN æ¶ˆæ¯ä¼ é€’æ–¹æ³•å¯ä»¥æ³›åŒ–ä¸ºåœ¨æ¶ˆæ¯ä¼ é€’çš„æ¯ä¸ªé˜¶æ®µåˆ©ç”¨è¾¹å’Œå›¾çº§åˆ«çš„ä¿¡æ¯ã€‚</p><p>æ›´ä¸ºé€šç”¨çš„æ¶ˆæ¯ä¼ é€’æ–¹æ³•å¦‚ä¸‹å¼ï¼š<br>$$<br>\begin{aligned}<br>h_{(u,v)}^{(k)} &amp;= UPDATE_{edge}(h_{(u,v)}^{(k-1)}, h_u^{(k-1)}, h_v^{(k-1)}, h_{\mathcal{G}}^{(k-1)}) \\<br>m_{\mathcal{N}(u)} &amp;= AGGREGATE_{node}({ h_{(u,v)}^{(k-1)}, \forall v \in \mathcal{N}(u) }) \\<br>h_u^{(k)} &amp;= UPDATE_{node}(h_u^{(k-1)}, m_{\mathcal{N}(u)}, h_{\mathcal{G}}^{(k-1)}) \\<br>h_{\mathcal{G}}^{(k)} &amp;= UPDATE_{graph}(h_{\mathcal{G}}^{(k-1)}, { h_u^{(k-1)}, \forall u \in \mathcal{V}, { h_{(u,v)}^{(k)}, \forall (u,v) \in \varepsilon } })<br>\end{aligned}<br>$$<br>é€šç”¨æ¶ˆæ¯ä¼ é€’æ¡†æ¶ä¸­ï¼Œåœ¨æ¶ˆæ¯ä¼ é€’è¿‡ç¨‹ä¸­ä¸ºå›¾ä¸Šçš„æ¯æ¡è¾¹ç”ŸæˆåµŒå…¥ $h_(u,v)^{(k)}$ï¼Œå¹¶ä¸ºæ•´å¼ å›¾ç”Ÿæˆç›¸åº”çš„åµŒå…¥ $h_{\mathcal{G}}^{(k)}$ï¼Œè¿™ä½¿å¾—æ¶ˆæ¯ä¼ é€’æ¨¡å‹å¯ä»¥èšåˆè¾¹å’Œå›¾çº§åˆ«çš„ç‰¹å¾ã€‚</p><p>åœ¨é€šç”¨æ¶ˆæ¯ä¼ é€’æ¡†æ¶ä¸­è¿›è¡Œæ¶ˆæ¯ä¼ é€’æ—¶ï¼Œé¦–å…ˆæ ¹æ®ä¾¿å…³è”çš„èŠ‚ç‚¹çš„åµŒå…¥æ¥æ›´æ–°è¾¹çš„åµŒå…¥ã€‚æ¥ä¸‹æ¥ï¼Œé€šè¿‡èšåˆèŠ‚ç‚¹å…³è”æ‰€æœ‰è¾¹çš„åµŒå…¥æ¥æ›´æ–°èŠ‚ç‚¹åµŒå…¥ã€‚å›¾åµŒå…¥è¢«ç”¨äºèŠ‚ç‚¹å’Œè¾¹è¡¨ç¤ºçš„æ›´æ–°å‡½æ•°ä¸­ï¼Œå¹¶ä¸”å›¾çº§åˆ«çš„åµŒå…¥æœ¬èº«é€šè¿‡åœ¨æ¯æ¬¡è¿­ä»£ç»“æŸæ—¶å¯¹æ‰€æœ‰èŠ‚ç‚¹å’Œè¾¹çš„åµŒå…¥è¿›è¡Œèšåˆæ¥æ›´æ–°ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å›¾ç¥ç»ç½‘ç»œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å›¾ç¥ç»ç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pythonç¨‹åºè¿è¡Œæ—¶é—´æŸ¥çœ‹æ–¹æ³•</title>
      <link href="/2023/05/30/python-cheng-xu-yun-xing-shi-jian-cha-kan-fang-fa/"/>
      <url>/2023/05/30/python-cheng-xu-yun-xing-shi-jian-cha-kan-fang-fa/</url>
      
        <content type="html"><![CDATA[<p>timeåŒ…æŸ¥çœ‹ç¨‹åºè¿è¡Œæ—¶é—´</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> timestart_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># è®°å½•ç¨‹åºå¼€å§‹è¿è¡Œæ—¶é—´</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">10000000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span>end_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># è®°å½•ç¨‹åºç»“æŸè¿è¡Œæ—¶é—´</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'cost %f s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>end_time <span class="token operator">-</span> start_time<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>è¾“å‡º</p><pre class=" language-python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> cost <span class="token number">0.179781</span> s</code></pre>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›¾ç¥ç»ç½‘ç»œå­¦ä¹ æ—¥è®°ï¼ˆä¸‰ï¼‰èŠ‚ç‚¹åµŒå…¥</title>
      <link href="/2023/05/29/tu-shen-jing-wang-luo-xue-xi-ri-ji-san/"/>
      <url>/2023/05/29/tu-shen-jing-wang-luo-xue-xi-ri-ji-san/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å›¾ç¥ç»ç½‘ç»œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å›¾ç¥ç»ç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®‹è¯ï¼ˆäºŒï¼‰</title>
      <link href="/2023/05/28/song-ci-er/"/>
      <url>/2023/05/28/song-ci-er/</url>
      
        <content type="html"><![CDATA[<center>è¶æ‹èŠ±</center><center>å®‹ æŸ³æ°¸</center><center>ä¼«å€šå±æ¥¼é£ç»†ç»†ï¼Œæœ›ææ˜¥æ„ï¼Œé»¯é»¯ç”Ÿå¤©é™…ã€‚è‰è‰²çƒŸå…‰æ®‹ç…§é‡Œï¼Œæ— è¨€è°ä¼šå‡­æ æ„ï¼Ÿ</center><center>æ‹ŸæŠŠç–ç‹‚å›¾ä¸€é†‰ï¼Œå¯¹é…’å½“æ­Œï¼Œå¼ºä¹è¿˜æ— å‘³ã€‚è¡£å¸¦æ¸å®½ç»ˆä¸æ‚”ï¼Œä¸ºä¼Šæ¶ˆå¾—äººæ†”æ‚´ã€‚</center><br><center>æœ¨å…°èŠ±</center><center>é’±æƒŸæ¼”</center><center>åŸä¸Šé£å…‰èºè¯­ä¹±ï¼ŒåŸä¸‹çƒŸæ³¢æ˜¥æ‹å²¸ã€‚ç»¿æ¨èŠ³è‰å‡ æ—¶ä¼‘ï¼Œæ³ªçœ¼æ„è‚ å…ˆå·²æ–­ã€‚</center><center>æƒ…æ€€æ¸è§‰æˆè¡°æ™šï¼Œé¸¾é•œæœ±é¢œæƒŠæš—æ¢ã€‚æ˜”å¹´å¤šç—…åŒèŠ³å°Šï¼Œä»Šæ—¥èŠ³å°ŠæƒŸææµ…ã€‚</center><br><center>è¸èè¡Œ</center><center>å¯‡å‡†</center><center>æ˜¥è‰²å°†é˜‘ï¼Œèºå£°æ¸è€ï¼Œçº¢è‹±è½å°½é’æ¢…å°ã€‚ç”»å ‚äººé™é›¨è’™è’™ï¼Œå±å±±åŠæ©ä½™é¦™è¢…ã€‚</center><center>å¯†çº¦æ²‰æ²‰ï¼Œç¦»æƒ…æ³æ³ï¼Œè±èŠ±å°˜æ»¡æ…µå°†ç…§ã€‚å€šæ¥¼æ— è¯­æ¬²é”€é­‚ï¼Œé•¿ç©ºæš—æ·¡é€¢èŠ³è‰ã€‚</center><br><center>æ›²ç‰ç®¡</center><center>æŸ³æ°¸</center><center>é™‡é¦–äº‘é£ï¼Œæ±Ÿè¾¹æ—¥æ™šï¼ŒçƒŸæ³¢æ»¡ç›®å‡­æ ä¹…ã€‚ä¸€æœ›å…³æ²³è§ç´¢ï¼Œåƒé‡Œæ¸…ç§‹ï¼Œå¿å‡çœ¸ã€‚</center><center>æ³æ³ç¥äº¬ï¼Œç›ˆç›ˆä»™å­ï¼Œåˆ«æ¥é”¦å­—ç»ˆéš¾å¶ã€‚æ–­é›æ— å‡­ï¼Œå†‰å†‰é£ä¸‹æ±€å·ï¼Œæ€æ‚ æ‚ ã€‚</center><center>æš—æƒ³å½“åˆï¼Œæœ‰å¤šå°‘ï¼Œå¹½æ¬¢ä½³ä¼šï¼›å²‚çŸ¥èšæ•£éš¾æœŸï¼Œç¿»æˆé›¨æ¨äº‘æ„ã€‚</center><center>é˜»è¿½æ¸¸ï¼Œæ¯ç™»å±±ä¸´æ°´ï¼Œæƒ¹èµ·å¹³ç”Ÿå¿ƒäº‹ï¼Œä¸€åœºæ¶ˆé»¯ï¼Œæ°¸æ—¥æ— è¨€ï¼Œå´ä¸‹å±‚æ¥¼ã€‚</center>]]></content>
      
      
      <categories>
          
          <category> å®‹è¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‹è¯ </tag>
            
            <tag> æ–‡å­¦ </tag>
            
            <tag> è¯—è¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®‹è¯ï¼ˆä¸€ï¼‰</title>
      <link href="/2023/05/28/song-ci-yi/"/>
      <url>/2023/05/28/song-ci-yi/</url>
      
        <content type="html"><![CDATA[<center>æœ¨å…°èŠ± æ˜¥æ™¯</center><center>å®‹ç¥</center><center>ä¸œåŸæ¸è§‰é£å…‰å¥½ï¼Œç¸ çš±æ³¢çº¹è¿å®¢æ‰ã€‚ç»¿æ¨çƒŸå¤–æ™“äº‘è½»ï¼Œçº¢ææå¤´æ˜¥æ„é—¹ã€‚</center><center>æµ®ç”Ÿé•¿æ¨æ¬¢å¨±å°‘ï¼Œè‚¯çˆ±åƒé‡‘è½»ä¸€ç¬‘ï¼Ÿä¸ºå›æŒé…’åŠæ–œé˜³ï¼Œä¸”å‘èŠ±é—´ç•™æ™šç…§ã€‚</center>]]></content>
      
      
      <categories>
          
          <category> å®‹è¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‹è¯ </tag>
            
            <tag> æ–‡å­¦ </tag>
            
            <tag> è¯—è¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›¾ç¥ç»ç½‘ç»œå­¦ä¹ æ—¥è®°ï¼ˆäºŒï¼‰ä¼ ç»Ÿæœºå™¨å­¦ä¹ æ–¹æ³•</title>
      <link href="/2023/05/28/tu-shen-jing-wang-luo-xue-xi-ri-ji-er/"/>
      <url>/2023/05/28/tu-shen-jing-wang-luo-xue-xi-ri-ji-er/</url>
      
        <content type="html"><![CDATA[<p><strong>æ ‡å‡†æœºå™¨å­¦ä¹ èŒƒå¼</strong></p><p>é¦–å…ˆï¼ŒåŸºäºå¯å‘å¼å‡½æ•°æˆ–é¢†åŸŸçŸ¥è¯†æå–ä¸€äº›ç»Ÿè®¡ç‰¹å¾ï¼›ç„¶åå°†å…¶ä½œä¸ºæ ‡å‡†æœºå™¨å­¦ä¹ åˆ†ç±»å™¨ï¼ˆå¦‚é€»è¾‘å›å½’ï¼‰çš„è¾“å…¥ã€‚</p><h2 id="å›¾ç»Ÿè®¡ç‰¹å¾"><a href="#å›¾ç»Ÿè®¡ç‰¹å¾" class="headerlink" title="å›¾ç»Ÿè®¡ç‰¹å¾"></a>å›¾ç»Ÿè®¡ç‰¹å¾</h2><h3 id="èŠ‚ç‚¹å±‚é¢çš„ç»Ÿè®¡ç‰¹å¾"><a href="#èŠ‚ç‚¹å±‚é¢çš„ç»Ÿè®¡ç‰¹å¾" class="headerlink" title="èŠ‚ç‚¹å±‚é¢çš„ç»Ÿè®¡ç‰¹å¾"></a>èŠ‚ç‚¹å±‚é¢çš„ç»Ÿè®¡ç‰¹å¾</h3><p><strong>èŠ‚ç‚¹çš„åº¦</strong></p><p>èŠ‚ç‚¹$u$çš„åº¦åæ˜ ä¸è¿™ä¸ªèŠ‚ç‚¹ç›¸è¿æ¥çš„è¾¹çš„æ•°ç›®ï¼Œå¯ç”±ä¸‹å¼è¡¨ç¤º<br>$$<br>d_u = \sum_{v \in \mathcal{V}} A[u,v]<br>$$<br>å¯¹äºæœ‰å‘å›¾å’ŒåŠ æƒå›¾ï¼Œåº¦åˆ†ä¸ºå…¥åº¦å’Œå‡ºåº¦ã€‚å¯¹çŸ©é˜µ$A$ä¸­çš„èŠ‚ç‚¹$u$çš„è¡Œæ±‚å’Œå¯ä»¥å¾—åˆ°å‡ºåº¦ï¼Œå¯¹èŠ‚ç‚¹$u$çš„åˆ—æ±‚å’Œå¯ä»¥å¾—åˆ°å…¥åº¦ã€‚</p><p><strong>èŠ‚ç‚¹çš„ä¸­å¿ƒæ€§</strong></p><p>è§’åº¦ä¸€ï¼šç‰¹å¾å‘é‡ä¸­å¿ƒæ€§åº¦é‡ä¸ä»…è€ƒè™‘é‚»å±…èŠ‚ç‚¹ä¸ªæ•°çš„åº¦ï¼Œè¿˜è€ƒè™‘äº†é‚»å±…èŠ‚ç‚¹çš„é‡è¦æ€§ã€‚<br>$$<br>e_u = \frac{1}{\lambda}\sum_{v\in \mathcal{V}}A[u,v]e_v, \forall u \in \mathcal{V}<br>$$<br>å°†å‘é‡è¡¨ç¤º$e$ä»£å…¥ä¸Šè¿°ç­‰å¼å–ä»£èŠ‚ç‚¹ä¸­å¿ƒæ€§å‘é‡å¯å¾—åˆ°é‚»æ¥çŸ©é˜µçš„æ ‡å‡†ç‰¹å¾å‘é‡æ–¹ç¨‹ï¼š<br>$$<br>\lambda e = Ae<br>$$<br>è§’åº¦äºŒï¼šç‰¹å¾å‘é‡ä¸­å¿ƒæ€§è¡¡é‡äº†ä¸€ä¸ªèŠ‚ç‚¹åœ¨è·¯å¾„æ— é™é•¿çš„æƒ…å†µä¸‹åœ¨éšæœºæ¸¸èµ°æ—¶è¢«è®¿é—®çš„æ¦‚ç‡ã€‚è¿™ç§ç†è§£æ–¹å¼è¿æ¥äº†èŠ‚ç‚¹é‡è¦æ€§ã€éšæœºæ¸¸èµ°å’Œè°±ä¸‰ä¸ªé‡è¦æ¦‚å¿µã€‚$\lambda$æ˜¯$A$çš„ä¸»è¦ç‰¹å¾å‘é‡ï¼Œå¯é€šè¿‡å¹‚æ¬¡è¿­ä»£æ³•åˆ™è®¡ç®—$e$å¦‚ä¸‹æ‰€ç¤ºï¼š<br>$$<br>e^{(t+1)} = Ae^{(t)}<br>$$<br>ä»å‘é‡$e^{(0)}=(1,1,\cdots,1)^T$å¼€å§‹ï¼Œä¾æ®å¹‚æ¬¡è¿­ä»£æ³•åˆ™ï¼Œç¬¬ä¸€æ¬¡è¿­ä»£å¯ä»¥å¾—åˆ°æ¯ä¸ªèŠ‚ç‚¹çš„åº¦ï¼Œåœ¨ç¬¬$t$æ¬¡è¿­ä»£$(t \geq 1)$æ—¶ï¼Œ$e^{(t)}$åŒ…æ‹¬äº†å°è¯•åˆ°è¾¾æ¯ä¸ªèŠ‚ç‚¹ä¸”é•¿åº¦ä¸º$t$çš„è·¯çº¿çš„é•¿åº¦çš„æ•°é‡ï¼Œæ— é™é‡å¤ä¸‹å»å¯å¾—åˆ°è·¯å¾„æ— é™é•¿æ—¶æ¯ä¸ªèŠ‚ç‚¹è¢«è®¿é—®çš„æ¬¡æ•°ã€‚</p><p><strong>èšç±»ç³»æ•°</strong></p><p>èšç±»ç³»æ•°é€šè¿‡ä¸€ä¸ªèŠ‚ç‚¹çš„å±€éƒ¨é‚»åŸŸä¸­é—­åˆä¸‰è§’å½¢çš„æ¯”ä¾‹åº¦é‡èŠ‚ç‚¹çš„é‚»å±…èŠ‚ç‚¹èšç±»çš„ç´§å¯†ç¨‹åº¦ã€‚èšç±»ç³»æ•°è®¡ç®—æ–¹æ³• Local Variant æ–¹æ³•å¦‚ä¸‹å¼æ‰€ç¤ºï¼š<br>$$<br>c_u = \frac{|(v_1, v_2)\in \varepsilon: v_1, v_2 \in \mathcal{N}(u)|}{\binom{d_u}{2}}<br>$$<br>å…¶ä¸­$\mathcal{N}(u)={v\in \mathcal{V}: (u,v)\in \varepsilon}$è¡¨ç¤ºèŠ‚ç‚¹$u$çš„é‚»å±…èŠ‚ç‚¹ã€‚</p><p><strong>é—­åˆä¸‰è§’å½¢ã€è‡ªæˆ‘ä¸­å¿ƒå›¾ã€Motifs</strong></p><p><strong>é—­åˆä¸‰è§’å½¢</strong></p><h3 id="å›¾å±‚é¢çš„ç»Ÿè®¡ç‰¹å¾"><a href="#å›¾å±‚é¢çš„ç»Ÿè®¡ç‰¹å¾" class="headerlink" title="å›¾å±‚é¢çš„ç»Ÿè®¡ç‰¹å¾"></a>å›¾å±‚é¢çš„ç»Ÿè®¡ç‰¹å¾</h3><p>èŠ‚ç‚¹è¢‹</p><p>Weisfeiler-Lehman æ ¸</p><p>Graphlets å’ŒåŸºäºè·¯å¾„çš„æ–¹æ³•</p><h2 id="é‚»åŸŸé‡å æ£€æµ‹"><a href="#é‚»åŸŸé‡å æ£€æµ‹" class="headerlink" title="é‚»åŸŸé‡å æ£€æµ‹"></a>é‚»åŸŸé‡å æ£€æµ‹</h2><h2 id="å›¾çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µå’Œå›¾çš„è°±æ–¹æ³•"><a href="#å›¾çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µå’Œå›¾çš„è°±æ–¹æ³•" class="headerlink" title="å›¾çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µå’Œå›¾çš„è°±æ–¹æ³•"></a>å›¾çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µå’Œå›¾çš„è°±æ–¹æ³•</h2>]]></content>
      
      
      <categories>
          
          <category> å›¾ç¥ç»ç½‘ç»œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å›¾ç¥ç»ç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Latex å­—æ¯ç±»ç¬¦å·</title>
      <link href="/2023/05/24/latex-zi-mu-lei-fu-hao/"/>
      <url>/2023/05/24/latex-zi-mu-lei-fu-hao/</url>
      
        <content type="html"><![CDATA[<p>Caligraphic letters: <code>$\mathcal{A}$ </code> etc.: $\mathcal{A B C D E F G H I J K L M N O P Q I S T U V W X Y Z}$</p><p>Mathbb letters: <code>$\mathbb{A}$</code>etc.: $\mathbb{A B C D E F G H I J K L M N O P Q I S T U V W X Y Z}$</p><p>Mathfrak letters: <code>$\mathfrak{A}$</code>etc.: $\mathfrak{A B C D E F G H I J K L M N O P Q I S T U V W X Y Z}$</p><p>Math Sans serif letters: <code>$\mathsf{A}$</code>etc.: $\mathsf{A B C D E F G H I J K L M N O P Q I S T U V W X Y Z}$</p><p>Math bold letters: <code>$\mathbf{A}$</code>etc.: $\mathbf{A B C D E F G H I J K L M N O P Q I S T U V W X Y Z}$</p><p>Math bold italic letters: define <code>\def\mathbi#1{\textbf{\em #1}}</code> then use <code>$\mathbi{A}$</code></p>]]></content>
      
      
      <categories>
          
          <category> Latex </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Latex </tag>
            
            <tag> Markdown </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›¾ç¥ç»ç½‘ç»œå­¦ä¹ æ—¥è®°ï¼ˆä¸€ï¼‰å›¾åŸºç¡€çŸ¥è¯†</title>
      <link href="/2023/05/24/tu-shen-jing-wang-luo-xue-xi-ri-ji-yi/"/>
      <url>/2023/05/24/tu-shen-jing-wang-luo-xue-xi-ri-ji-yi/</url>
      
        <content type="html"><![CDATA[<h2 id="å›¾çš„å®šä¹‰"><a href="#å›¾çš„å®šä¹‰" class="headerlink" title="å›¾çš„å®šä¹‰"></a>å›¾çš„å®šä¹‰</h2><p>å›¾ç”±èŠ‚ç‚¹é›†åˆ$\mathcal{V}$å’Œè¾¹é›†åˆ$\varepsilon$ç»„æˆï¼Œè®°ä½œ$\mathcal{G}=(\mathcal{V},\varepsilon)$ï¼ŒèŠ‚ç‚¹$u\in \mathcal{V}$åˆ°èŠ‚ç‚¹$v\in \mathcal{V}$çš„è¾¹è¡¨ç¤ºä¸º$(u,v)\in\varepsilon$.</p><h2 id="å›¾çš„è¡¨ç¤º"><a href="#å›¾çš„è¡¨ç¤º" class="headerlink" title="å›¾çš„è¡¨ç¤º"></a>å›¾çš„è¡¨ç¤º</h2><p>å›¾å¯ä»¥ç”±é‚»æ¥çŸ©é˜µ$A\in \mathbb{R}^{|\mathcal{V}|\times|\mathcal{V}|}$è¡¨ç¤ºï¼ŒçŸ©é˜µçš„è¡Œå’Œåˆ—ä»£è¡¨èŠ‚ç‚¹ç´¢å¼•ï¼ŒçŸ©é˜µå…ƒç´ $A[u,v]$è¡¨ç¤ºèŠ‚ç‚¹$u$å’ŒèŠ‚ç‚¹$v$çš„è¿æ¥æƒ…å†µï¼Œå¦‚æœ$(u,v)\in \varepsilon$ï¼Œåˆ™$A[u,v]=1$ï¼Œå¦åˆ™$A[u,v]=0$ã€‚</p><h2 id="å¤šå…³ç³»å›¾çš„åˆ†ç±»"><a href="#å¤šå…³ç³»å›¾çš„åˆ†ç±»" class="headerlink" title="å¤šå…³ç³»å›¾çš„åˆ†ç±»"></a>å¤šå…³ç³»å›¾çš„åˆ†ç±»</h2><p><strong>å¼‚æ„å›¾</strong></p><p>å¼‚æ„å›¾å¯ä»¥é€šè¿‡èŠ‚ç‚¹ç±»å‹å°†èŠ‚ç‚¹åˆ’åˆ†ä¸ºä¸ç›¸äº¤çš„å­é›†ï¼Œå³$\mathcal{V} = \mathcal{V}_1 \bigcup \mathcal{V}_2 \bigcup \cdots  \bigcup \mathcal{V}_k$ï¼Œå…¶ä¸­$\mathcal{V}_i \bigcap \mathcal{V}_j = \emptyset, \forall \neq j$ã€‚</p><p><strong>å¤šé‡å›¾</strong></p><p>å¤šé‡å›¾ä¸­çš„è¾¹åªèƒ½è¿æ¥ä¸åŒç±»å‹çš„èŠ‚ç‚¹ï¼Œå³$(u,\tau_i,v)\in \varepsilon \rightarrow u \in \mathcal{V}_j,v \in \mathcal{V}_k \bigwedge j \neq k$ã€‚åœ¨å¤šé‡å›¾ä¸­ï¼Œé€šå¸¸å‡è®¾å›¾å¯ä»¥è¢«åˆ†è§£ä¸º$k$ä¸ªå±‚çº§ï¼Œæ¯ä¸ªèŠ‚ç‚¹å¯ä»¥å±äºä¸€å±‚æˆ–å¤šå±‚ï¼Œæ¯å±‚ä»£è¡¨å”¯ä¸€ç‰¹å®šå…³ç³»ï¼Œè¡¨ç¤ºæœ¬å±‚å†…è¾¹çš„ç±»å‹ã€‚</p><h2 id="å›¾æœºå™¨å­¦ä¹ ä»»åŠ¡"><a href="#å›¾æœºå™¨å­¦ä¹ ä»»åŠ¡" class="headerlink" title="å›¾æœºå™¨å­¦ä¹ ä»»åŠ¡"></a>å›¾æœºå™¨å­¦ä¹ ä»»åŠ¡</h2><h3 id="èŠ‚ç‚¹é¢„æµ‹"><a href="#èŠ‚ç‚¹é¢„æµ‹" class="headerlink" title="èŠ‚ç‚¹é¢„æµ‹"></a>èŠ‚ç‚¹é¢„æµ‹</h3><p>æä¾›è®­ç»ƒé›†çœŸå®çš„æ ‡ç­¾$\mathcal{V}_{train} \subset \mathcal{V}$æ—¶ï¼Œé€šè¿‡æ‰€æœ‰çš„èŠ‚ç‚¹$u \in \mathcal{V}$é¢„æµ‹æ ‡ç­¾$y_u$åº”è¯¥å±äºå“ªç§ç±»å‹ã€ç±»åˆ«æˆ–å±æ€§ã€‚</p><p>èŠ‚ç‚¹é¢„æµ‹å¯é€šè¿‡æ˜¾å¼åˆ©ç”¨èŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥è¿›è¡Œåˆ†ç±»ï¼Œå¦‚ä¸‹å‡ ç§èŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥æ€§è´¨ï¼š</p><p><strong>åŒè´¨æ€§</strong></p><p>å›¾ä¸­çš„èŠ‚ç‚¹ä¸å…¶é‚»å±…èŠ‚ç‚¹çš„å±æ€§ç›¸ä¼¼ï¼Œå³èŠ‚ç‚¹æœ‰ä¸é‚»å±…èŠ‚ç‚¹å…±äº«å±æ€§çš„è¶‹åŠ¿ã€‚</p><p><strong>å¼‚è´¨æ€§</strong></p><p>å‡å®šèŠ‚ç‚¹å°†ä¼˜å…ˆè¿æ¥åˆ°å…·æœ‰ä¸åŒæ ‡ç­¾çš„èŠ‚ç‚¹ã€‚</p><p><strong>ç»“æ„ç­‰ä»·æ€§</strong></p><p>å…·æœ‰ç›¸ä¼¼å±€éƒ¨ç»“æ„çš„èŠ‚ç‚¹å°†å…·æœ‰ç›¸ä¼¼çš„æ ‡ç­¾ã€‚</p><p><strong>èŠ‚ç‚¹é¢„æµ‹æ˜¯æœ‰ç›‘ç£è¿˜æ˜¯åŠç›‘ç£ä»»åŠ¡ï¼Ÿ</strong></p><p><strong>éæ ‡å‡†çš„åŠç›‘ç£ä»»åŠ¡ã€‚</strong></p><p>åœ¨åŠç›‘ç£å­¦ä¹ ä¸­ï¼Œæ¨¡å‹è®­ç»ƒè¿‡ç¨‹åŒæ—¶ä½¿ç”¨æœ‰æ ‡ç­¾æ•°æ®å’Œæ— æ ‡ç­¾æ•°æ®ï¼Œæ ‡å‡†çš„åŠç›‘ç£å­¦ä¹ ä»¥ç‹¬ç«‹åŒåˆ†å¸ƒå‡è®¾ä¸ºå‰æï¼Œæ ‡å‡†çš„ç›‘ç£å­¦ä¹ åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¸ä½¿ç”¨æ‰€æœ‰æ— æ ‡ç­¾çš„æµ‹è¯•æ•°æ®ã€‚èŠ‚ç‚¹åˆ†ç±»ä»»åŠ¡ä¸­ï¼Œå›¾ä¸­èŠ‚ç‚¹å…¨éƒ¨éƒ½è¢«ä½¿ç”¨ï¼ŒåŒ…æ‹¬æ— æ ‡ç­¾èŠ‚ç‚¹ï¼Œæ•…èŠ‚ç‚¹åˆ†ç±»ä»»åŠ¡æ˜¯åŠç›‘ç£å­¦ä¹ ï¼ŒåŒæ—¶èŠ‚ç‚¹åˆ†ç±»ä»»åŠ¡å¯¹ä¸€ç»„ç›¸äº’è¿æ¥çš„èŠ‚ç‚¹è¿›è¡Œå»ºæ¨¡ï¼Œæ‰“ç ´äº†ç‹¬ç«‹åŒåˆ†å¸ƒå‡è®¾ï¼Œæ•…èŠ‚ç‚¹åˆ†ç±»æ˜¯éæ ‡å‡†çš„åŠç›‘ç£ä»»åŠ¡ã€‚</p><h3 id="å…³ç³»é¢„æµ‹"><a href="#å…³ç³»é¢„æµ‹" class="headerlink" title="å…³ç³»é¢„æµ‹"></a>å…³ç³»é¢„æµ‹</h3><p>ç»™å®šä¸€ç»„èŠ‚ç‚¹$\mathcal{V}$å’Œéƒ¨åˆ†è¾¹çš„é›†åˆ$\varepsilon_{train}$ï¼ˆ$\varepsilon_{train} \subset \varepsilon, \varepsilon$è¡¨ç¤ºå…¨ä½“è¾¹çš„é›†åˆï¼‰ï¼Œåˆ©ç”¨è¿™äº›ç»™å®šä¿¡æ¯æ¨æ–­ç¼ºå¤±è¾¹çš„é›†åˆ$\varepsilon \ \varepsilon_{train}$ã€‚</p><h3 id="ç¤¾åŒºå‘ç°"><a href="#ç¤¾åŒºå‘ç°" class="headerlink" title="ç¤¾åŒºå‘ç°"></a>ç¤¾åŒºå‘ç°</h3><p>é€šè¿‡è¾“å…¥ä¸€å¼ å›¾$\mathcal{G}=(\mathcal{V},\varepsilon)$æ¨æ–­å‡ºæ½œåœ¨çš„ç¤¾åŒºç»“æ„ã€‚</p><p>ç¤¾åŒºå‘ç°å¸¸è¢«ç±»æ¯”ä¸ºå›¾é¢†åŸŸçš„æ— ç›‘ç£å­¦ä¹ ä¸­çš„èšç±»ä»»åŠ¡ã€‚</p><h3 id="å›¾é¢„æµ‹"><a href="#å›¾é¢„æµ‹" class="headerlink" title="å›¾é¢„æµ‹"></a>å›¾é¢„æµ‹</h3><p>å›¾é¢„æµ‹åŒ…æ‹¬å¯¹æ•´å¼ å›¾è¿›è¡Œåˆ†ç±»ã€å›å½’ä¸èšç±»ã€‚</p><p>å›¾åˆ†ç±»æˆ–å›¾å›å½’ä»»åŠ¡ä¸­ï¼Œæ•°æ®é›†ç”±å¤šå¼ ä¸åŒå›¾æ„æˆï¼Œå›¾æœºå™¨å­¦ä¹ ç®—æ³•é’ˆå¯¹æ¯å¼ å›¾è¿›è¡Œç‹¬ç«‹é¢„æµ‹ï¼Œè€Œä¸æ˜¯é¢„æµ‹å›¾çš„ç»„æˆéƒ¨åˆ†ã€‚åœ¨å›¾èšç±»ä»»åŠ¡ä¸­ï¼Œç›®æ ‡æ˜¯å­¦ä¹ ä¸€ä¸ªæ— ç›‘ç£çš„æµ‹é‡å›¾ä¸å›¾ä¹‹é—´ç›¸ä¼¼æ€§çš„ç­–ç•¥ã€‚</p><p>å›¾åˆ†ç±»ä¸å›¾å›å½’ä»»åŠ¡å±äºæ ‡å‡†ç›‘ç£å­¦ä¹ èŒƒç•´ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å›¾ç¥ç»ç½‘ç»œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å›¾ç¥ç»ç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
